<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0016)http://localhost -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="DC.Type" content="topic"/>
<meta name="DC.Title" content="Using the Custom Dynamically Linked Shared Library Builder"/>
<meta name="DC.Relation" scheme="URI" content="GUID-48717119-DEB8-4010-B3CC-EC5A0CD48269.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-7091CAB6-0506-443A-ABA0-CCE2245A1A1C.html#GUID-7091CAB6-0506-443A-ABA0-CCE2245A1A1C"/>
<meta name="DC.Relation" scheme="URI" content="http://www.intel.com/software/products/softwaredocs_feedback"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-5AED4A85-5343-48BC-B78B-7636D164B53A"/>
<meta name="DC.Language" content="en-US"/>
<link rel="stylesheet" type="text/css" href="intel_css_styles.css"/>
<title>Using the Custom Dynamically Linked Library/Shared Object Builder</title>

</head>
<body id="GUID-5AED4A85-5343-48BC-B78B-7636D164B53A">
 <!-- ==============(Start:NavScript)================= -->
 <script src="NavScript.js" language="JavaScript1.2" type="text/javascript"></script>
 <script language="JavaScript1.2" type="text/javascript">WriteNavLink(0);</script>
 <!-- ==============(End:NavScript)================= -->
<p id="header_text" style="margin-bottom : 20pt"><em> Math Kernel Library Developer Guide</em></p>


<h1 class="topictitle1">Using the Custom 
	 Dynamically Linked Shared Library Builder</h1>
<div id="GUID-FBA6BAE3-68A9-4652-8327-B647DF35E739"><p>To build a custom 
		<span>dynamically linked shared library</span>, use the following command: 
	 </p>
<p id="GUID-5FE67A77-FD04-40D2-A0CE-9A51A2D6A07F"><samp class="codeph"> 
		  make target [<var>&lt;options&gt;</var>]</samp></p>
<p>The following table lists possible values of 
		<samp class="codeph">target</samp> and explains what the command does for each value: 
	 </p>

<div class="tablenoborder"><table cellpadding="4" summary="" id="GUID-A6ABDF42-02CF-44E5-88DF-396EB00EF2C8" width="100%" frame="hsides" border="1" rules="all"><thead align="left"><tr><th class="cellrowborder" valign="top" width="20%" id="d15181e44"><p>Value 
				  </p>
</th>
<th class="row-nocellborder" valign="top" width="80%" id="d15181e47"><p>Comment 
				  </p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="20%" headers="d15181e44 "><samp class="codeph">libintel64</samp></td>
<td class="row-nocellborder" valign="top" width="80%" headers="d15181e47 "><p>The builder uses static Intel&reg; oneAPI Math Kernel Library interface, threading, and core libraries to build an Intel 64 dynamically linked shared library.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20%" headers="d15181e44 "><samp class="codeph">dylibuni</samp></td>
<td class="row-nocellborder" valign="top" width="80%" headers="d15181e47 "><p>The builder uses the single dynamic library 
					 <span class="filepath">libmkl_rt.dylib</span> to build an Intel 64 dynamically linked shared library. 
				  </p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20%" headers="d15181e44 "><samp class="codeph">help</samp></td>
<td class="row-nocellborder" valign="top" width="80%" headers="d15181e47 "><p>The command prints Help on the custom 
					 <span>dynamically linked shared library</span> builder 
				  </p>
</td>
</tr>
</tbody>
</table>
</div>
<p>The 
		<samp class="codeph"><var>&lt;options&gt;</var></samp> placeholder stands for the list of parameters that define macros to be used by the makefile. The following table describes these parameters: 
	 </p>

<div class="tablenoborder"><table cellpadding="4" summary="" id="GUID-103F7475-1657-47BA-9481-DAAB9578EE61" width="100%" frame="hsides" border="1" rules="all"><thead align="left"><tr><th class="cellrowborder" valign="top" width="20%" id="d15181e94"><p>Parameter [Values] 
				  </p>
</th>
<th class="row-nocellborder" valign="top" width="80%" id="d15181e97"><p>Description 
				  </p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="20%" headers="d15181e94 "><samp class="codeph">interface 
					 <span>= {lp64|ilp64}</span></samp></td>
<td class="row-nocellborder" valign="top" width="80%" headers="d15181e97 "><p>Defines 
					 <span>whether to use LP64 or ILP64</span> programming interface<span>for the Intel 64</span><span>architecture.</span><span>The default value is 
						<samp class="codeph">lp64</samp>. 
					 </span></p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20%" headers="d15181e94 "><samp class="codeph">threading = {parallel|sequential}</samp></td>
<td class="row-nocellborder" valign="top" width="80%" headers="d15181e97 "><p>Defines whether to use the Intel&reg; oneAPI Math Kernel Library in the threaded or sequential mode. The default value is<samp class="codeph">parallel</samp>. 
				  </p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20%" headers="d15181e94 "><samp class="codeph">cluster = {yes|no}</samp></td>
<td class="row-nocellborder" valign="top" width="80%" headers="d15181e97 "><p>(For 
					 <samp class="codeph">libintel64</samp>only) Specifies whether Intel&reg; oneAPI Math Kernel Library cluster components (BLACS, ScaLAPACK and/or CDFT) are needed to build the custom shared object. The default value is<samp class="codeph">no</samp>. 
				  </p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20%" headers="d15181e94 "><samp class="codeph">blacs_mpi = {intelmpi|mpich2|msmpi}</samp></td>
<td class="row-nocellborder" valign="top" width="80%" headers="d15181e97 "><p>Specifies the pre-compiled Intel&reg; oneAPI Math Kernel Library BLACS library to use. Ignored if<samp class="codeph">'cluster=no'</samp>. The default value is 
					 <samp class="codeph">intelmpi</samp>. 
				  </p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20%" headers="d15181e94 "><samp class="codeph">blacs_name = &lt;lib name&gt;</samp></td>
<td class="row-nocellborder" valign="top" width="80%" headers="d15181e97 "><p>Specifies the name (without extension) of a custom Intel&reg; oneAPI Math Kernel Library BLACS library to use. Ignored if<samp class="codeph">'cluster=no'</samp>. 
					 <samp class="codeph">'blacs_mpi'</samp> is ignored if 
					 <samp class="codeph">'blacs_name'</samp> was explicitly specified. The default value is 
					 <samp class="codeph">mkl_blacs_&lt;blacs_mpi&gt;_&lt;interface&gt;</samp>. 
				  </p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20%" headers="d15181e94 "><samp class="codeph">mpi = &lt;lib name&gt;</samp></td>
<td class="row-nocellborder" valign="top" width="80%" headers="d15181e97 "><p>Specifies the name (without extension) of the MPI library used to build the custom DLL. Ignored if 
					 <samp class="codeph">'cluster=no'</samp>. The default value is 
					 <samp class="codeph">impi</samp>. 
				  </p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20%" headers="d15181e94 "><samp class="codeph">export = 
					 <var>&lt;file name&gt;</var></samp></td>
<td class="row-nocellborder" valign="top" width="80%" headers="d15181e97 "><p>Specifies the full name of the file that contains the list of entry-point functions to be included in the 
					 <span>shared object.</span> The default name is 
					 <span class="filepath">user_example_list</span> (no extension). 
				  </p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20%" headers="d15181e94 "><samp class="codeph">name = 
					 <var>&lt;</var><var>so</var><var> name&gt;</var></samp></td>
<td class="row-nocellborder" valign="top" width="80%" headers="d15181e97 "><p>Specifies the name of the 
					  library to be created. By default, the names of the created librar<span>y 
					 </span><span>is 
					 </span><span class="filepath">mkl_custom.</span><span class="filepath">dylib</span><span>.</span></p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20%" headers="d15181e94 "><samp class="codeph">xerbla = 
					 <var>&lt;error handler&gt;</var></samp></td>
<td class="row-nocellborder" valign="top" width="80%" headers="d15181e97 "><p>Specifies the name of the object file 
					 <span class="filepath"><var>&lt;user_xerbla&gt;</var></span><span class="filepath">.o</span>that contains the error handler of the user. The makefile adds this error handler to the library for use instead of the default Intel&reg; oneAPI Math Kernel Library error handler<span class="parmname">xerbla</span>. If you omit this parameter, the native Intel&reg; oneAPI Math Kernel Library<span class="parmname">xerbla</span> is used. See the description of the 
					 <span class="parmname">xerbla</span>function in the Intel&reg; oneAPI Math Kernel Library Developer Reference to develop your own error handler. 
				  </p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20%" headers="d15181e94 "><samp class="codeph">MKLROOT = 
					 <var>&lt;mkl directory&gt;</var></samp></td>
<td class="row-nocellborder" valign="top" width="80%" headers="d15181e97 "><p>Specifies the location of Intel&reg; oneAPI Math Kernel Library libraries used to build the custom<span>dynamically linked shared library</span>. By default, the builder uses the Intel&reg; oneAPI Math Kernel Library installation directory.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p/>
<p>All of the above parameters are optional. However, you must make the system and c-runtime (crt) libraries and link.exe available by setting the<var> PATH</var> and 
		<var>LIB</var> environment variables appropriately. You can do this in the following ways: 
	 </p>
<ul id="GUID-71994E71-95B6-4BC8-AE85-0CCF7D336310"><li>Manually 
		</li>
<li>If you are using the Intel compiler, use the 
		  <samp class="codeph">compilervars.sh</samp> script with the appropriate 32-bit (x86) or 64-bit (x64 or amd-64) architecture flag. 
		</li>
</ul>
<p>In the simplest case, the command line is: 
	 </p>
<p><samp class="codeph">make ia32</samp></p>
<p>and the missing options have default values. This command creates the  
		<span class="filepath">mkl_custom.</span><span class="filepath">dylib</span> librar<span>y</span> . The command takes the list of functions from the 
		<span><samp class="codeph">user_list</samp></span>file and uses the native Intel&reg; oneAPI Math Kernel Library error handler<span><span class="parmname">xerbla</span></span>. 
	 </p>
<p>Here is an example of a more complex case: 
	 </p>
<p><samp class="codeph"><span>make intel64 export=my_func_list.txt name=mkl_small xerbla=my_xerbla.o</span></samp></p>
<p>In this case, the command creates the 
		<span class="filepath">mkl_small.</span><span class="filepath">dylib</span> librar<span>y</span>. The command takes the list of functions from 
		<span class="filepath">my_func_list.txt</span> file and uses the error handler of the user 
		<span class="filepath">my_xerbla.o</span>. 
	 </p>
<p id="P_CF_12857569597140">
<div class="tablenoborder"><table cellpadding="4" summary="" id="d25e46" frame="border" border="1" cellspacing="0" rules="all"><thead align="left"><tr><th class="cellrowborder" align="left" valign="top" width="100%" id="d15181e373"><p id="d25e52">Optimization Notice 
              </p>
</th>
</tr>
</thead>
<tbody><tr><td class="bgcolor(#f5f5f5)" bgcolor="#f5f5f5" valign="top" width="100%" headers="d15181e373 "><p>Intel's compilers may or may not optimize to the same degree for non-Intel microprocessors for optimizations that are not unique to Intel microprocessors. These optimizations include SSE2, SSE3, and SSSE3 instruction sets and other optimizations. Intel does not guarantee the availability, functionality, or effectiveness of any optimization on microprocessors not manufactured by Intel. Microprocessor-dependent optimizations in this product are intended for use with Intel microprocessors. Certain optimizations not specific to Intel microarchitecture are reserved for Intel microprocessors. Please refer to the applicable product User and Reference Guides for more information regarding the specific instruction sets covered by this notice. 
              </p>
<p> Notice revision #20110804 
              </p>
</td>
</tr>
</tbody>
</table>
</div>
 This notice covers the following instruction sets: SSE2, SSE4.2, AVX2, AVX-512. 
    </p>
</div>

<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-48717119-DEB8-4010-B3CC-EC5A0CD48269.html">Building Custom Dynamically Linked Shared Libraries</a></div>
</div>
<div class="See Also"><h2>See Also</h2>
<div class="linklist">
<div><a href="GUID-7091CAB6-0506-443A-ABA0-CCE2245A1A1C.html#GUID-7091CAB6-0506-443A-ABA0-CCE2245A1A1C">Using the Single Dynamic Library 
		  </a> </div></div></div>
</body>
</html>
