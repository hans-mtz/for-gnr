<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0016)http://localhost -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="DC.Type" content="FunctionRef"/>
<meta name="DC.Title" content="?_sph_p/?_sph_np"/>
<meta name="abstract" content="Computes the solution of the spherical Helmholtz problem specified by the parameters."/>
<meta name="description" content="Computes the solution of the spherical Helmholtz problem specified by the parameters."/>
<meta name="DC.subject" content="?_sph_p, ?_sph_np, Poisson Solver, routines"/>
<meta name="keywords" content="?_sph_p, ?_sph_np, Poisson Solver, routines"/>
<meta name="DC.Relation" scheme="URI" content="GUID-C352E7EF-7660-42A7-8A6D-18EF02359C93.html"/>
<meta name="DC.Relation" scheme="URI" content="http://www.intel.com/software/products/softwaredocs_feedback"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-EA5DC817-5607-40B6-B864-2859CFBF557E"/>
<meta name="DC.Language" content="en-US"/>
<link rel="stylesheet" type="text/css" href="intel_css_styles.css"/>
<title>?_sph_p/?_sph_np</title>

</head>
<body id="GUID-EA5DC817-5607-40B6-B864-2859CFBF557E">
 <!-- ==============(Start:NavScript)================= -->
 <script src="NavScript.js" language="JavaScript1.2" type="text/javascript"></script>
 <script language="JavaScript1.2" type="text/javascript">WriteNavLink(0);</script>
 <!-- ==============(End:NavScript)================= -->
<p id="header_text" style="margin-bottom : 20pt"><em>Intel&reg; oneAPI Math Kernel Library Developer Reference - Fortran</em></p>


<h1 class="topictitle1"><span class="option">?_sph_p/?_sph_np</span></h1>
<!--Computes the solution of the spherical Helmholtz problem specified by the parameters.--><div><p class="shortdesc">Computes the solution of the spherical Helmholtz problem specified by the parameters.</p>
<div class="section" id="GUID-A06AB873-63F8-4968-A3BF-47BBFD19B623"><h2 class="sectiontitle">Syntax</h2><div class="dlsyntaxpara"><p class="dlsyntaxpara"><span class="kwd">void d_sph_p</span><span class="delim">(</span><span class="kwd">double* </span><span class="var">f, </span><span class="kwd">DFTI_DESCRIPTOR_HANDLE* </span><span class="var">handle_s, </span><span class="kwd">DFTI_DESCRIPTOR_HANDLE* </span><span class="var">handle_c, </span><span class="kwd">MKL_INT* </span><span class="var">ipar, </span><span class="kwd">double* </span><span class="var">dpar, </span><span class="kwd">MKL_INT* </span><span class="var">stat</span><span class="delim">)</span><span class="kwd">;</span></p></div><div class="dlsyntaxpara"><p class="dlsyntaxpara"><span class="kwd">void s_sph_p</span><span class="delim">(</span><span class="kwd">float* </span><span class="var">f, </span><span class="kwd">DFTI_DESCRIPTOR_HANDLE* </span><span class="var">handle_s, </span><span class="kwd">DFTI_DESCRIPTOR_HANDLE* </span><span class="var">handle_c, </span><span class="kwd">MKL_INT* </span><span class="var">ipar, </span><span class="kwd">float* </span><span class="var">spar, </span><span class="kwd">MKL_INT* </span><span class="var">stat</span><span class="delim">)</span><span class="kwd">;</span></p></div><div class="dlsyntaxpara"><p class="dlsyntaxpara"><span class="kwd">void d_sph_np</span><span class="delim">(</span><span class="kwd">double* </span><span class="var">f, </span><span class="kwd">DFTI_DESCRIPTOR_HANDLE* </span><span class="var">handle, </span><span class="kwd">MKL_INT* </span><span class="var">ipar, </span><span class="kwd">double* </span><span class="var">dpar, </span><span class="kwd">MKL_INT* </span><span class="var">stat</span><span class="delim">)</span><span class="kwd">;</span></p></div><div class="dlsyntaxpara"><p class="dlsyntaxpara"><span class="kwd">void s_sph_np</span><span class="delim">(</span><span class="kwd">float* </span><span class="var">f, </span><span class="kwd">DFTI_DESCRIPTOR_HANDLE* </span><span class="var">handle, </span><span class="kwd">MKL_INT* </span><span class="var">ipar, </span><span class="kwd">float* </span><span class="var">spar, </span><span class="kwd">MKL_INT* </span><span class="var">stat</span><span class="delim">)</span><span class="kwd">;</span></p></div></div>
<div class="section" id="GUID-563E1341-C89B-43CD-B74D-22E138CA3EEC"><h2 class="sectiontitle">Include Files</h2><ul id="d163e249"><li id="d163e250"><span class="filepath">mkl_poisson.f90</span></li>
</ul>
</div>
<div class="section" id="GUID-57D3C74C-6E20-4B35-9B9C-23B56A25C6A2"><h2 class="sectiontitle">Input Parameters</h2><table cellspacing="0" cellpadding="4" border="0" width="90%" style="border-spacing:0; border-collapse:collapse"><tr><td valign="top" width="30%" class="noborder"><p><span class="parmname">f</span></p></td>

<td valign="top" class="noborder"><p><span class="keyword">double*</span> for <span class="option">d_sph_p/d_sph_np</span>,</p>
<p><span class="keyword">float*</span> for <span class="option">s_sph_p/s_sph_np</span>. </p>
<p>Contains the right-hand side of the problem packed in a single vector and modified by the appropriate <a class="allformats" href="GUID-C79A67EC-E804-440B-8075-B7E86509A247.html#GUID-C79A67EC-E804-440B-8075-B7E86509A247"><span class="option">?_commit_sph_p/?_commit_sph_np</span></a> routine. Note that an attempt to substitute the original right-hand side vector, which was passed to the <span class="option">?_commit_sph_p/?_commit_sph_np</span> routine, at this point results in an incorrect solution. </p>
<p>The size of the vector is (<span class="parmname">np</span>+1)*(<span class="parmname">nt</span>+1) and the value of the modified right-hand side in the mesh point (<var>i, j</var>) is stored in <span class="parmname">f</span>[<var>i+j</var>*(<span class="parmname">np</span>+1)] . </p>
</td>
</tr><tr><td valign="top" width="30%" class="noborder"><p><span class="parmname">handle_s, handle_c, handle</span></p></td>

<td valign="top" class="noborder"><p><span class="keyword">DFTI_DESCRIPTOR_HANDLE*</span>. Data structures used by Intel&reg; oneAPI Math Kernel Library FFT interface (for details, refer to<a class="allformats" href="GUID-CD8C749B-7CC1-466C-9815-06A7A1D77D30.html#GUID-CD8C749B-7CC1-466C-9815-06A7A1D77D30">FFT Functions</a>). <span class="parmname">handle_s</span> and <span class="parmname">handle_c</span> are used only in <span class="option">?_sph_p</span> and<span class="parmname"> handle</span> is used only in <span class="option">?_sph_np</span>. </p>
</td>
</tr><tr><td valign="top" width="30%" class="noborder"><p><span class="parmname">ipar</span></p></td>

<td valign="top" class="noborder"><p><span class="keyword">MKL_INT</span> array of size 128. Contains integer data to be used by the Fast Helmholtz Solver on a sphere (for details, refer to <a href="GUID-0E6B858A-D5DC-47A9-BD48-E86DFDF58487.html"><span class="keyword">ipar</span></a>). </p>
</td>
</tr><tr><td valign="top" width="30%" class="noborder"><p><span class="parmname">dpar</span></p></td>

<td valign="top" class="noborder"><p><span class="keyword">double</span> array of size 5*<span class="parmname">np</span>/2+<span class="parmname">nt</span>+10. Contains double-precision data to be used by the Fast Helmholtz Solver on a sphere (for details, refer to <a href="GUID-42929E64-A695-4D2B-A2BE-85DAD3F9E6FC.html"><span class="keyword">dpar</span> and <span class="keyword">spar</span></a>). </p>
</td>
</tr><tr><td valign="top" width="30%" class="noborder"><p><span class="parmname">spar</span></p></td>

<td valign="top" class="noborder"><p>float array of size 5*<span class="parmname">np</span>/2+<span class="parmname">nt</span>+10. Contains single-precision data to be used by the Fast Helmholtz Solver on a sphere (for details, refer to <a href="GUID-42929E64-A695-4D2B-A2BE-85DAD3F9E6FC.html"><span class="keyword">dpar</span> and <span class="keyword">spar</span></a>). </p>
</td>
</tr></table></div>
<div class="section" id="GUID-87672AC8-1FF1-41EF-833D-FC201A9278EA"><h2 class="sectiontitle">Output Parameters</h2><table cellspacing="0" cellpadding="4" border="0" width="90%" style="border-spacing:0; border-collapse:collapse"><tr><td valign="top" width="30%" class="noborder"><p><span class="parmname">f</span></p></td>

<td valign="top" class="noborder"><p>On output, contains the approximate solution to the problem packed the same way as the right-hand side of the problem was packed on input. </p>
</td>
</tr><tr><td valign="top" width="30%" class="noborder"><p><span class="parmname">handle_s, handle_c, handle</span></p></td>

<td valign="top" class="noborder"><p>Data structures used by the Intel&reg; oneAPI Math Kernel Library FFT interface.</p>
</td>
</tr><tr><td valign="top" width="30%" class="noborder"><p><span class="parmname">ipar</span></p></td>

<td valign="top" class="noborder"><p>Contains integer data to be used by the Fast Helmholtz Solver 
on a sphere. Modified on output as explained in <a href="GUID-0E6B858A-D5DC-47A9-BD48-E86DFDF58487.html"><span class="keyword">ipar</span></a>. </p>
</td>
</tr><tr><td valign="top" width="30%" class="noborder"><p><span class="parmname">dpar</span></p></td>

<td valign="top" class="noborder"><p>Contains double-precision data to be used by the Fast Helmholtz Solver on a sphere. Modified on output as explained in <a href="GUID-42929E64-A695-4D2B-A2BE-85DAD3F9E6FC.html"><span class="keyword">dpar</span> and <span class="keyword">spar</span></a>. </p>
</td>
</tr><tr><td valign="top" width="30%" class="noborder"><p><span class="parmname">spar</span></p></td>

<td valign="top" class="noborder"><p>Contains single-precision data to be used by the Fast Helmholtz Solver on a sphere. Modified on output as explained in <a href="GUID-42929E64-A695-4D2B-A2BE-85DAD3F9E6FC.html"><span class="keyword">dpar</span> and <span class="keyword">spar</span></a>. </p>
</td>
</tr><tr><td valign="top" width="30%" class="noborder"><p><span class="parmname">stat</span></p></td>

<td valign="top" class="noborder"><p><span class="keyword">MKL_INT*</span>. Routine completion status, which is also written to <span class="parmname">ipar[0]</span>. Continue to call other Poisson Solver routines only if the status is 0. </p>
</td>
</tr></table></div>
<div class="section" id="GUID-49A17371-9F4A-469B-A857-73C1CC0F5950"><h2 class="sectiontitle">Description</h2><p><span/>The <span class="option">sph_p/sph_np</span> routines compute the approximate solution on a sphere of the Helmholtz problem defined in the previous calls to the corresponding initialization and commit routines. The solution is computed according to the formulas given in <a href="GUID-3E012BD6-539C-4A78-AD42-8E19EDDE3A62.html#GUID-3E012BD6-539C-4A78-AD42-8E19EDDE3A62">Poisson Solver Implementation</a>. The <span class="parmname">f</span> parameter, which initially holds the packed vector of the right-hand side of the problem, is replaced by the computed solution packed in the same way. Values of <span class="parmname">np</span> and <span class="parmname">nt</span> are passed to each of the routines with the <span class="parmname">ipar</span> array. </p>
</div>
<div class="section" id="RETURNVALUES_8A8764061FA548BAB83B2155CE8F2A1E"><h2 class="sectiontitle">Return Values</h2><table cellspacing="0" cellpadding="4" border="0" width="90%" style="border-spacing:0; border-collapse:collapse"><tr><td valign="top" width="30%" class="noborder"><p><span class="parmname">stat</span>= 1</p></td>

<td valign="top" class="noborder"><p>The routine completed without errors but with warnings. </p>
</td>
</tr><tr><td valign="top" width="30%" class="noborder"><p><span class="parmname">stat</span>= 0</p></td>

<td valign="top" class="noborder"><p>The routine successfully completed the task. </p>
</td>
</tr><tr><td valign="top" width="30%" class="noborder"><p><span class="parmname">stat</span>= -2</p></td>

<td valign="top" class="noborder"><p>The routine stopped because division by zero occurred. It usually happens if the data in the <span class="parmname">dpar</span> or <span class="parmname">spar</span> array was altered by mistake. </p>
</td>
</tr><tr><td valign="top" width="30%" class="noborder"><p><span class="parmname">stat</span>= -3</p></td>

<td valign="top" class="noborder"><p>The routine stopped because the memory was insufficient to complete the computations. </p>
</td>
</tr><tr><td valign="top" width="30%" class="noborder"><p><span class="parmname">stat</span>= -100</p></td>

<td valign="top" class="noborder"><p>The routine stopped because an error in the input data was found or the data in the <span class="parmname">dpar</span>, <span class="parmname">spar</span>, or <span class="parmname">ipar</span> array was altered by mistake. </p>
</td>
</tr><tr><td valign="top" width="30%" class="noborder"><p><span class="parmname">stat</span>= -1000</p></td>

<td valign="top" class="noborder"><p>The routine stopped because of an Intel&reg; oneAPI Math Kernel Library FFT or TT interface error.</p>
</td>
</tr><tr><td valign="top" width="30%" class="noborder"><p><span class="parmname">stat</span>= -10000</p></td>

<td valign="top" class="noborder"><p>The routine stopped because the initialization failed to complete or the parameter <span class="parmname">ipar</span>[0] was altered by mistake. </p>
</td>
</tr><tr><td valign="top" width="30%" class="noborder"><p><span class="parmname">stat</span>= -99999</p></td>

<td valign="top" class="noborder"><p>The routine failed to complete the task because of a fatal error. </p>
</td>
</tr></table></div>
</div>

<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-C352E7EF-7660-42A7-8A6D-18EF02359C93.html">Routines for the Spherical Solver</a></div>
</div>
<div/>
</body>
</html>
