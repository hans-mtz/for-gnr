<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0016)http://localhost -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="DC.Type" content="FunctionRef"/>
<meta name="DC.Title" content="p?heev"/>
<meta name="abstract" content="Computes all eigenvalues and, optionally, eigenvectors of a complex Hermitian matrix."/>
<meta name="description" content="Computes all eigenvalues and, optionally, eigenvectors of a complex Hermitian matrix."/>
<meta name="DC.subject" content="p?heev, ScaLAPACK routines, driver routines, Hermitian matrix, eigenvalues and eigenvectors"/>
<meta name="keywords" content="p?heev, ScaLAPACK routines, driver routines, Hermitian matrix, eigenvalues and eigenvectors"/>
<meta name="DC.Relation" scheme="URI" content="GUID-CF5CF672-F6FD-41A7-A0BC-CAAEFBD035EE.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-97273960-E4A4-4016-8667-BE6A36156792.html#GUID-97273960-E4A4-4016-8667-BE6A36156792"/>
<meta name="DC.Relation" scheme="URI" content="http://www.intel.com/software/products/softwaredocs_feedback"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-54916998-5A17-4583-8DBC-CA7AE79B72CF"/>
<meta name="DC.Language" content="en-US"/>
<link rel="stylesheet" type="text/css" href="intel_css_styles.css"/>
<title>p?heev</title>

</head>
<body id="GUID-54916998-5A17-4583-8DBC-CA7AE79B72CF">
 <!-- ==============(Start:NavScript)================= -->
 <script src="NavScript.js" language="JavaScript1.2" type="text/javascript"></script>
 <script language="JavaScript1.2" type="text/javascript">WriteNavLink(0);</script>
 <!-- ==============(End:NavScript)================= -->
<p id="header_text" style="margin-bottom : 20pt"><em>Intel&reg; oneAPI Math Kernel Library Developer Reference - Fortran</em></p>


<h1 class="topictitle1"><span class="option">p?heev</span></h1>
<!--Computes all eigenvalues and, optionally, eigenvectors of a complex Hermitian matrix.--><div><p class="shortdesc">Computes all eigenvalues and, optionally, eigenvectors of a complex Hermitian matrix.</p>
<div class="section" id="GUID-1B670B22-2741-4E96-A9E1-0C2431F6CE20"><h2 class="sectiontitle">Syntax</h2><dl class="dlsyntax"><p class="dlsyntaxpara"><span class="kwd">call pcheev</span><span class="delim">(</span><span class="var">jobz</span><span class="sep">, </span><span class="var">uplo</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">ia</span><span class="sep">, </span><span class="var">ja</span><span class="sep">, </span><span class="var">desca</span><span class="sep">, </span><span class="var">w</span><span class="sep">, </span><span class="var">z</span><span class="sep">, </span><span class="var">iz</span><span class="sep">, </span><span class="var">jz</span><span class="sep">, </span><span class="var">descz</span><span class="sep">, </span><span class="var">work</span><span class="sep">, </span><span class="var">lwork</span><span class="sep">, </span><span class="var">rwork</span><span class="sep">, </span><span class="var">lrwork</span><span class="sep">, </span><span class="var">info</span><span class="delim">)</span></p><p class="dlsyntaxpara"><span class="kwd">call pzheev</span><span class="delim">(</span><span class="var">jobz</span><span class="sep">, </span><span class="var">uplo</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">ia</span><span class="sep">, </span><span class="var">ja</span><span class="sep">, </span><span class="var">desca</span><span class="sep">, </span><span class="var">w</span><span class="sep">, </span><span class="var">z</span><span class="sep">, </span><span class="var">iz</span><span class="sep">, </span><span class="var">jz</span><span class="sep">, </span><span class="var">descz</span><span class="sep">, </span><span class="var">work</span><span class="sep">, </span><span class="var">lwork</span><span class="sep">, </span><span class="var">rwork</span><span class="sep">, </span><span class="var">lrwork</span><span class="sep">, </span><span class="var">info</span><span class="delim">)</span></p></dl></div>
<div class="section" id="GUID-6988D346-6DB3-4E85-821C-98B64D90F2F5"><h2 class="sectiontitle">Include Files</h2><p/>
</div>
<div class="section" id="GUID-B3963A6D-0F5E-4828-8641-AA3631BEB6B1"><h2 class="sectiontitle">Description</h2><p><span/>The <span class="option">p?heev</span><span> routine </span>computes all eigenvalues and, optionally, eigenvectors of a complex Hermitian matrix <var>A</var> by calling the recommended sequence of ScaLAPACK <span>routines</span>. The<span> routine </span>assumes a homogeneous system and makes spot checks of the consistency of the eigenvalues across the different processes. A heterogeneous system may return incorrect results without any error messages.</p>
</div>
<div class="section" id="GUID-2645331F-B3B8-4692-90B1-C116ACC051C0"><h2 class="sectiontitle">Input Parameters</h2><p><var>np</var> = the number of rows local to a given process. </p>
<p><var>nq</var> = the number of columns local to a given process. </p>
<dl id="GUID-5D01462C-61A3-4D33-A006-5D26CE568CE6"><dt class="dlterm"><span class="parmname">jobz</span></dt>

<dd><p>(global) <span><span class="keyword">CHARACTER*1</span>. </span>Must be <span class="keyword">'N'</span> or <span class="keyword">'V'</span>. </p>
<p>Specifies if it is necessary to compute the eigenvectors: </p>
<p>If <samp class="codeph"><span class="parmname">jobz</span> = <span class="keyword">'N'</span></samp>, then only eigenvalues are computed. </p>
<p>If <samp class="codeph"><span class="parmname">jobz</span> = <span class="keyword">'V'</span></samp>, then eigenvalues and eigenvectors are computed.</p>
</dd>
<dt class="dlterm"><span class="parmname">uplo</span></dt>

<dd><p>(global) <span><span class="keyword">CHARACTER*1</span>. </span>Must be <span class="keyword">'U'</span> or <span class="keyword">'L'</span>.</p>
<p>Specifies whether the upper or lower triangular part of the Hermitian matrix <var>A</var> is stored: </p>
<p>If <samp class="codeph"><span class="parmname">uplo</span> = <span class="keyword">'U'</span></samp>, <span class="parmname">a</span> stores the upper triangular part of <var>A</var>. </p>
<p>If <samp class="codeph"><span class="parmname">uplo</span> = <span class="keyword">'L'</span></samp>, <span class="parmname">a</span> stores the lower triangular part of <var>A</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">n</span></dt>

<dd><p>(global) <span><span class="keyword">INTEGER</span>. </span>The number of rows and columns of the matrix <var>A</var><samp class="codeph">(<var>n</var><span class="eqsymbol">≥</span> 0)</samp>. </p>
</dd>
<dt class="dlterm"><span class="parmname">a</span></dt>

<dd><p>(local).</p>
<p><span class="keyword">COMPLEX</span> for <span class="option">pcheev</span></p>
<p><span class="keyword">DOUBLE COMPLEX</span> for <span class="option">pzheev</span>. </p>
<p>Block cyclic array of global size <span>(<var>n</var>, <var>n</var>)</span> and local size <samp class="codeph">(<var>lld_a</var>, <var>LOC</var><var>c</var>(<var>ja</var>+<var>n</var>-1))</samp>. On entry, the Hermitian matrix <var>A</var>.</p>
<p>If <samp class="codeph"><span class="parmname">uplo</span> = <span class="keyword">'U'</span></samp>, only the upper triangular part of <var>A</var> is used to define the elements of the Hermitian matrix. </p>
<p>If <samp class="codeph"><span class="parmname">uplo</span> = <span class="keyword">'L'</span></samp>, only the lower triangular part of <var>A</var> is used to define the elements of the Hermitian matrix. </p>
</dd>
<dt class="dlterm"><span class="parmname">ia</span>, <span class="parmname">ja</span></dt>

<dd><p>(global) <span><span class="keyword">INTEGER</span>. </span>The row and column indices in the global matrix <var>A</var> indicating the first row and the first column of the submatrix <var>A</var>, respectively.</p>
</dd>
<dt class="dlterm"><span class="parmname">desca</span></dt>

<dd><p>(global and local) <span><span class="keyword">INTEGER</span></span> array of size <var>dlen_</var>.  The array descriptor for the distributed matrix <var>A</var>. If <samp class="codeph"><span class="parmname">desca</span><samp class="codeph">(<var>ctxt_</var>)</samp></samp> is incorrect, <span class="option">p?heev</span> cannot guarantee correct error reporting.</p>
</dd>
<dt class="dlterm"><span class="parmname">iz</span>, <span class="parmname">jz</span></dt>

<dd><p>(global) <span><span class="keyword">INTEGER</span>. </span>The row and column indices in the global matrix <var>Z</var> indicating the first row and the first column of the submatrix <var>Z</var>, respectively.</p>
</dd>
<dt class="dlterm"><span class="parmname">descz</span></dt>

<dd><p>(global and local) <span><span class="keyword">INTEGER</span></span> array of size <var>dlen_</var>.  The array descriptor for the distributed matrix <var>Z</var>.
 <samp class="codeph"><span class="parmname">descz</span><samp class="codeph">(<var>ctxt_</var>)</samp></samp> must equal <var>desca</var><samp class="codeph">(<var>ctxt_</var>)</samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">work</span></dt>

<dd><p>(local).</p>
<p><span class="keyword">COMPLEX</span> for <span class="option">pcheev</span></p>
<p><span class="keyword">DOUBLE COMPLEX</span> for <span class="option">pzheev</span>.</p>
<p>Array of size <var>lwork</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">lwork</span></dt>

<dd><p>(local) <span><span class="keyword">INTEGER</span>. </span>The size of the array <var>work</var>.</p>
<p>If only eigenvalues are requested (<samp class="codeph"><span class="parmname">jobz</span> = <span class="keyword">'N'</span></samp>):</p>
<p><samp class="codeph"><span class="parmname">lwork</span><span class="eqsymbol">≥</span><span class="keyword">max</span>(<var>nb</var>*(<var>np</var>0 + 1), 3) + 3*<var>n</var></samp></p>
<p>If eigenvectors are requested (<samp class="codeph"><span class="parmname">jobz</span>  = <span class="keyword">'V'</span></samp>), then the amount of workspace required:</p>
<p><samp class="codeph"><span class="parmname">lwork</span><span class="eqsymbol">≥</span> (<var>np</var>0+<var>nq</var>0+<var>nb</var>)*<var>nb</var> + 3*<var>n</var> + <var>n</var><sup class="power">2</sup></samp></p>
<p>with <samp class="codeph"><var>nb</var> = <span class="parmname">desca</span>( <var>mb</var>_ ) =  <span class="parmname">desca</span>( <var>nb</var>_ ) = <var>nb</var> = <span class="parmname">descz</span>( <var>mb</var>_ ) =  <span class="parmname">descz</span>( <var>nb</var>_ )</samp></p>
<p><samp class="codeph"><var>np</var>0 = <span class="keyword">numroc</span>(<var>nn</var>, <var>nb</var>, 0, 0, <span class="keyword">NPROW</span>)</samp>.</p>
<p><samp class="codeph"><var>nq</var>0 = <span class="keyword">numroc</span>( max( <var>n</var>, <var>nb</var>, 2 ), <var>nb</var>, 0, 0, <span class="keyword">NPCOL</span>)</samp>.</p>
<p>If <samp class="codeph"><span class="parmname">lwork</span> = -1</samp>, then <var>lwork</var> is global input and a workspace query is assumed; the<span> routine </span>only calculates the size required for optimal performance for all work arrays. The required workspace is returned as the first element of the corresponding work arrays, and no error message is issued by <span class="option">pxerbla</span>.</p>
</dd>
<dt class="dlterm"><span class="parmname">rwork</span></dt>

<dd><p>(local).</p>
<p><span class="keyword">REAL</span> for <span class="option">pcheev</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">pzheev</span>. </p>
<p>Workspace array of size <var>lrwork</var>. </p>
</dd>
<dt class="dlterm"><span class="parmname">lrwork</span></dt>

<dd><p>(local) <span><span class="keyword">INTEGER</span>. </span>The size of the array <span class="parmname">rwork</span>.</p>
<p>See below for definitions of variables used to define <span class="parmname">lrwork</span>. </p>
<p>If no eigenvectors are requested (<samp class="codeph"><span class="parmname">jobz</span> = <span class="keyword">'N'</span></samp>),  then <samp class="codeph"><span class="parmname">lrwork</span><span class="eqsymbol">≥</span> 2*<var>n</var></samp>.</p>
<p>If eigenvectors are requested (<samp class="codeph"><span class="parmname">jobz</span> = <span class="keyword">'V'</span></samp>),  then <samp class="codeph"><span class="parmname">lrwork</span><span class="eqsymbol">≥</span> 2*<var>n</var> + 2*<var>n</var>-2</samp>.</p>
<p>If <samp class="codeph"><span class="parmname">lrwork</span> = -1</samp>, then <span class="parmname">lrwork</span> is global input and a workspace query is assumed; the<span> routine </span>only calculates the minimum size required for the  <span class="parmname">rwork</span> array. The required workspace is returned as the first element of <span class="parmname">rwork</span>, and no error message is issued by <span class="option">pxerbla</span>. </p>
</dd>
</dl>
</div>
<div class="section" id="GUID-5E2202ED-13C0-42D9-B723-5ED3BC97EEAA"><h2 class="sectiontitle">Output Parameters</h2><dl id="GUID-FCC43CDD-69E0-4E00-983B-E77DCFD15DC0"><dt class="dlterm"><span class="parmname">a</span></dt>

<dd><p>On exit, the lower triangle (if <samp class="codeph"><span class="parmname">uplo</span> = <span class="keyword">'L'</span></samp>), or the upper triangle (if <samp class="codeph"><span class="parmname">uplo</span> = <span class="keyword">'U'</span></samp>) of <var>A</var>, including the diagonal, is overwritten.</p>
</dd>
<dt class="dlterm"><span class="parmname">w</span></dt>

<dd><p>(global). </p>
<p><span class="keyword">REAL</span> for <span class="option">pcheev</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">pzheev</span>.</p>
<p>Array of size <var>n</var>. The first <var>m</var> elements contain the selected eigenvalues in ascending order.</p>
</dd>
<dt class="dlterm"><span class="parmname">z</span></dt>

<dd><p>(local).</p>
<p><span class="keyword">COMPLEX</span> for <span class="option">pcheev</span></p>
<p><span class="keyword">DOUBLE COMPLEX</span> for <span class="option">pzheev</span>.</p>
<p>Array, global size <span>(<var>n</var>, <var>n</var>)</span>, local size <samp class="codeph">(<var>lld_z</var>, <var>LOCc</var>(<var>jz</var>+<var>n</var>-1))</samp>.</p>
<p>If <samp class="codeph"><span class="parmname">jobz</span> =<span class="keyword">'V'</span></samp>, then on normal exit the first <var>m</var> columns of <span class="parmname">z</span> contain the orthonormal eigenvectors of the matrix corresponding to the selected eigenvalues. If an eigenvector fails to converge, then that column of <var>z</var> contains the latest approximation to the eigenvector, and the index of the eigenvector is returned in <var>ifail</var>. </p>
<p>If <samp class="codeph"><span class="parmname">jobz</span> = <span class="keyword">'N'</span></samp>, then <span class="parmname">z</span> is not referenced. </p>
</dd>
<dt class="dlterm"><span class="parmname">work</span><samp class="codeph">(1)</samp></dt>

<dd><p>On exit, returns adequate workspace to allow optimal performance.</p>
<p>If <samp class="codeph"><span class="parmname">jobz</span> =<span class="keyword">'N'</span></samp>, then <span class="parmname">work</span><samp class="codeph">(1)</samp>
= minimal workspace only for eigenvalues.</p>
<p>If <samp class="codeph"><span class="parmname">jobz</span> =<span class="keyword">'V'</span></samp>, then <span class="parmname">work</span><samp class="codeph">(1)</samp> = minimal workspace required to generate all the eigenvectors.</p>
</dd>
<dt class="dlterm"><span class="parmname">rwork</span><samp class="codeph">(1)</samp></dt>

<dd><p>(local)</p>
<p><span class="keyword">COMPLEX</span> for <span class="option">pcheev</span></p>
<p><span class="keyword">DOUBLE COMPLEX</span> for <span class="option">pzheev</span>.</p>
<p>On output, <span class="parmname">rwork</span><samp class="codeph">(1)</samp> returns workspace required to guarantee completion.</p>
</dd>
<dt class="dlterm"><span class="parmname">info</span></dt>

<dd><p>(global) <span><span class="keyword">INTEGER</span>. </span></p>
<p>If <samp class="codeph"><span class="parmname">info</span> = 0</samp>, the execution is successful.</p>
<p>If <samp class="codeph"><span class="parmname">info</span> &lt; 0</samp>: </p>
<p>If the <var>i</var>-th argument is an array and the <var>j</var>-entry had an illegal value, then <samp class="codeph"><span class="parmname">info</span> = -(<var>i</var>*100+<var>j</var>)</samp>. If the <var>i</var>-th argument is a scalar and had an illegal value, then <samp class="codeph"><span class="parmname">info</span> = -<var>i</var></samp>. </p>
<p>If <samp class="codeph"><span class="parmname">info</span><span class="eqsymbol">&gt;</span> 0</samp>:</p>
<p>If <span class="parmname">info</span>
= 1 through <var>n</var>, the  <var>i</var>-th
eigenvalue did not converge in <a href="GUID-43194A76-1612-4587-B31C-E5B16041A46D.html#GUID-43194A76-1612-4587-B31C-E5B16041A46D"><span class="option">?steqr2</span></a> after a total of 30*<var>n</var>
iterations.</p>
<p>If <span class="parmname">info</span>
= <var>n</var>+1, then  <span class="option">p?heev</span> detected heterogeneity, and the accuracy of the results cannot be guaranteed.</p>
</dd>
</dl>
</div>
</div>

<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-CF5CF672-F6FD-41A7-A0BC-CAAEFBD035EE.html">ScaLAPACK Driver Routines</a></div>
</div>
<div class="See Also"><h2>See Also</h2>
<div class="linklist">
<div><a href="GUID-97273960-E4A4-4016-8667-BE6A36156792.html#GUID-97273960-E4A4-4016-8667-BE6A36156792">Overview</a> for details of ScaLAPACK  array descriptor structures and related notations.</div></div></div>
</body>
</html>
