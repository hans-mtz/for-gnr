<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0016)http://localhost -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="DC.Type" content="FunctionRef"/>
<meta name="DC.Title" content="gemm_*"/>
<meta name="abstract" content="Computes a matrix-matrix product with general integer matrices."/>
<meta name="description" content="Computes a matrix-matrix product with general integer matrices."/>
<meta name="DC.subject" content="gemm_s8u8s32"/>
<meta name="keywords" content="gemm_s8u8s32"/>
<meta name="DC.Relation" scheme="URI" content="GUID-723C9818-01C2-4825-912B-343F445DDB96.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-F026EAA4-1AD8-4226-B4D2-0DD2A617C73C"/>
<meta name="DC.Language" content="en-US"/>
<link rel="stylesheet" type="text/css" href="intel_css_styles.css"/>
<title>gemm_*</title>

</head>
<body id="GUID-F026EAA4-1AD8-4226-B4D2-0DD2A617C73C">
 <!-- ==============(Start:NavScript)================= -->
 <script src="NavScript.js" language="JavaScript1.2" type="text/javascript"></script>
 <script language="JavaScript1.2" type="text/javascript">WriteNavLink(0);</script>
 <!-- ==============(End:NavScript)================= -->
<p id="header_text" style="margin-bottom : 20pt"><em>Intel&reg; oneAPI Math Kernel Library Developer Reference - Fortran</em></p>


<h1 class="topictitle1"><span class="option">gemm_*</span></h1>
<!--Computes a matrix-matrix product with general integer matrices.--><div><p class="shortdesc">Computes a matrix-matrix product with general integer matrices.</p>
<div class="section" id="SYNTAX_B8865DFD46564EF7944F4371D107BF9B"><h2 class="sectiontitle">Syntax</h2><dl class="dlsyntax"><p class="dlsyntaxpara"><span class="kwd">call gemm_s8u8s32</span><span class="delim">(</span><span class="var">transa</span><span class="sep">, </span><span class="var">transb</span><span class="sep">, </span><span class="var">offsetc</span><span class="sep">, </span><span class="var">m</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">k</span><span class="sep">, </span><span class="var">alpha</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">lda</span><span class="sep">, </span><span class="var">oa</span><span class="sep">, </span><span class="var">b</span><span class="sep">, </span><span class="var">ldb</span><span class="sep">, </span><span class="var">ob</span><span class="sep">, </span><span class="var">beta</span><span class="sep">, </span><span class="var">c</span><span class="sep">, </span><span class="var">ldc</span><span class="sep">, </span><span class="var">oc</span><span class="delim">)</span></p><p class="dlsyntaxpara"><span class="kwd">call gemm_s16s16s32</span><span class="delim">(</span><span class="var">transa</span><span class="sep">, </span><span class="var">transb</span><span class="sep">, </span><span class="var">offsetc</span><span class="sep">, </span><span class="var">m</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">k</span><span class="sep">, </span><span class="var">alpha</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">lda</span><span class="sep">, </span><span class="var">oa</span><span class="sep">, </span><span class="var">b</span><span class="sep">, </span><span class="var">ldb</span><span class="sep">, </span><span class="var">ob</span><span class="sep">, </span><span class="var">beta</span><span class="sep">, </span><span class="var">c</span><span class="sep">, </span><span class="var">ldc</span><span class="sep">, </span><span class="var">oc</span><span class="delim">)</span></p></dl></div>
<div class="section" id="DESCRIPTION_CA7C0BD2F07546C29ACCD0F8AED774BB"><h2 class="sectiontitle">Include Files</h2><ul id="UL_F658A17FB58342B78FF8DD5C32999F1E"><li id="LI_F50C24E26BB944FC873AD98A0AFC012A"><span class="filepath">mkl.fi</span></li>
</ul>
</div>
<div class="section" id="DESCRIPTION_362260212B4145B4A3C745A34F38020A"><h2 class="sectiontitle">Description</h2><p> The <span class="option">gemm_*</span> routines compute a scalar-matrix-matrix product and adds the result to a scalar-matrix product. To get the final result, a vector is added to each row or column of the output matrix. The operation is defined as:</p>
<pre><var>C</var> := <var>alpha</var>*(op(<var>A</var>) + A_offset)*(op(<var>B</var>) + B_offset) + <var>beta</var><var>*C + C_offset</var></pre><p>where :<ul class="simple"><li><samp class="codeph">op(<var>X</var>)</samp> is either <samp class="codeph">op(<var>X</var>) = <var>X</var></samp>  or <samp class="codeph">op(<var>X</var>) = <var>X</var><sup><var>T</var></sup></samp>,</li>
<li><var>A_offset</var> is an <span class="parmname">m</span>-by-<span class="parmname">k</span> matrix with every element equal to the value <span class="parmname">oa</span>,</li>
<li><var>B_offset</var> is a <span class="parmname">k</span>-by-<span class="parmname">n</span> matrix with every element equal to the value <span class="parmname">ob</span>,</li>
<li><var>C_offset</var> is an <span class="parmname">m</span>-by-<span class="parmname">n</span> matrix defined by the <span class="parmname">oc</span> array as described in the description of the <span class="parmname">offsetc</span> parameter,</li>
<li><var>alpha</var> and <var>beta</var> are scalars,</li>
<li><var>A</var> is a matrix such that <samp class="codeph">op(<var>A</var>)</samp> is <span class="parmname">m</span>-by-<span class="parmname">k</span>,</li>
<li><var>B</var> is a matrix such that <samp class="codeph">op(<var>B</var>)</samp> is <span class="parmname">k</span>-by-<span class="parmname">n</span>,</li>
<li> and <var>C</var> is an <span class="parmname">m</span>-by-<span class="parmname">n</span> matrix.</li>
</ul>
</p>
</div>
<div class="section" id="ARGUMENTS_5B9DD5E00625406B94E4C965CD4A4384"><h2 class="sectiontitle">Input Parameters</h2><dl id="GUID-8CB89152-96DD-439B-B3B4-D70B65B08F8C"><dt class="dlterm"><span class="parmname">transa</span></dt>

<dd><p><span>CHARACTER*1. </span>Specifies the form of op(<var>A</var>) used in the matrix multiplication:</p>
<p>if <span><samp class="codeph"><span class="parmname">transa</span> = 'N'</samp> or <samp class="codeph">'n'</samp></span>, then <samp class="codeph">op(<var>A</var>) = <var>A</var></samp>;</p>
<p>if <span><samp class="codeph"><span class="parmname">transa</span> = 'T'</samp> or <samp class="codeph">'t'</samp></span>, then <samp class="codeph">op(<var>A</var>) = <var>A</var><sup>T</sup></samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">transb</span></dt>

<dd><p><span>CHARACTER*1. </span>Specifies the form of op(<var>B</var>) used in the matrix multiplication:</p>
<p>if <span><samp class="codeph"><span class="parmname">transb</span> = 'N'</samp> or <samp class="codeph">'n'</samp></span>, then <samp class="codeph">op(<var>B</var>) = <var>B</var></samp>;</p>
<p>if <span><samp class="codeph"><span class="parmname">transb</span> = 'T'</samp> or <samp class="codeph">'t'</samp></span>, then <samp class="codeph">op(<var>B</var>) = <var>B</var><sup>T</sup></samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">offsetc</span></dt>

<dd><p><span>CHARACTER*1. </span>Specifies the form of <var>C_offset</var> used in the matrix multiplication.<ul class="simple"><li><samp class="codeph"><span class="parmname">offsetc</span> = </samp><span><samp class="codeph">'F'</samp> or <samp class="codeph">'f'</samp></span>: <span class="parmname">oc</span> has a single element and every element of <var>C_offset</var> is equal to this element.</li>
<li><samp class="codeph"><span class="parmname">offsetc</span> = </samp><span><samp class="codeph">'C'</samp> or <samp class="codeph">'c'</samp></span>: <span class="parmname">oc</span> has a size of <span class="parmname">m</span> and every column of <var>C_offset</var> is equal to <span class="parmname">oc</span>.</li>
<li><samp class="codeph"><span class="parmname">offsetc</span> = </samp><span><samp class="codeph">'R'</samp> or <samp class="codeph">'r'</samp></span>: <span class="parmname">oc</span> has a size of <span class="parmname">n</span> and every row of <var>C_offset</var> is equal to <span class="parmname">oc</span>.</li>
</ul>
</p>
</dd>
<dt class="dlterm"><span class="parmname">m</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>Specifies the number of rows of the matrix <samp class="codeph">op(<var>A</var>)</samp> and of the matrix <var>C</var>. The value of <span class="parmname">m</span> must be at least zero. </p>
</dd>
<dt class="dlterm"><span class="parmname">n</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>Specifies the number of columns of the matrix <samp class="codeph">op(<var>B</var>)</samp> and the number of columns of the matrix <var>C</var>. The value of <span class="parmname">n</span> must be at least zero.</p>
</dd>
<dt class="dlterm"><span class="parmname">k</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>Specifies the number of columns of the matrix <samp class="codeph">op(<var>A</var>)</samp> and the number of rows of the matrix <samp class="codeph">op(<var>B</var>)</samp>. The value of <span class="parmname">k</span> must be at least zero.</p>
</dd>
<dt class="dlterm"><span class="parmname">alpha</span></dt>

<dd><p><span><span class="keyword">SINGLE PRECISION</span>. </span> Specifies the scalar <var>alpha</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">a</span></dt>

<dd><p><span class="keyword">INTEGER*1</span> for gemm_s8u8s32. </p>
<p><span class="keyword">INTEGER*2</span> for gemm_s16s16s32. </p>
<p>Array, size <span class="parmname">lda</span> by <span class="parmname">ka</span>, where <span class="parmname">ka</span> is <span class="parmname">k</span> when <samp class="codeph"><span class="parmname">transa</span> = 'N'</samp> or <samp class="codeph">'n'</samp>, and is <span class="parmname">m</span> otherwise. Before entry with <samp class="codeph"><span class="parmname">transa</span> = 'N'</samp> or <samp class="codeph">'n'</samp>, the leading <span class="parmname">m</span>-by-<span class="parmname">k</span> part of the array <span class="parmname">a</span> must contain the matrix <var>A</var>, otherwise the leading <span class="parmname">k</span>-by-<span class="parmname">m</span> part of the array <span class="parmname">a</span> must contain the matrix <var>A</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">lda</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>Specifies the leading dimension of <var>a</var> as declared in the calling (sub)program. </p>
<p>When <samp class="codeph"><span class="parmname">transa</span> = 'N'</samp> or <samp class="codeph">'n'</samp>, then <span class="parmname">lda</span> must be at least <samp class="codeph">max(1, <span class="parmname">m</span>)</samp>, otherwise <span class="parmname">lda</span> must be at least <samp class="codeph">max(1, <span class="parmname">k</span>)</samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">oa</span></dt>

<dd><p><span class="keyword">INTEGER*1</span> for gemm_s8u8s32. </p>
<p><span class="keyword">INTEGER*2</span> for gemm_s16s16s32. </p>
<p>Specifies the scalar offset value for matrix <var>A</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">b</span></dt>

<dd><p><span class="keyword">INTEGER*1</span> for gemm_s8u8s32. <span class="keyword">INTEGER*2</span> for gemm_s16s16s32.  Array, size <span class="parmname">ldb</span> by <span class="parmname">kb</span>, where <span class="parmname">kb</span> is <span class="parmname">n</span> when <samp class="codeph"><span class="parmname">transa</span> = 'N'</samp> or <samp class="codeph">'n'</samp>, and is <span class="parmname">k</span> otherwise. Before entry with <samp class="codeph"><span class="parmname">transa</span> = 'N'</samp> or <samp class="codeph">'n'</samp>, the leading <span class="parmname">k</span>-by-<span class="parmname">n</span> part of the array <span class="parmname">b</span> must contain the matrix <var>B</var>, otherwise the leading <span class="parmname">n</span>-by-<span class="parmname">k</span> part of the array <span class="parmname">b</span> must contain the matrix <var>B</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">ldb</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>Specifies the leading dimension of <span class="parmname">b</span> as declared in the calling (sub)program. </p>
<p>When <samp class="codeph"><span class="parmname">transb</span> = 'N'</samp> or <samp class="codeph">'n'</samp>, then <span class="parmname">ldb</span> must be at least <samp class="codeph">max(1, <span class="parmname">k</span>)</samp>, otherwise <span class="parmname">ldb</span> must be at least <samp class="codeph">max(1, <span class="parmname">n</span>)</samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">ob</span></dt>

<dd><p><span><span class="keyword">INTEGER*1</span> for gemm_s8u8s32. <span class="keyword">INTEGER*2</span> for gemm_s16s16s32. </span>Specifies the scalar offset value for matrix <var>B</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">beta</span></dt>

<dd><p><span><span class="keyword">SINGLE PRECISION</span>. </span>Specifies the scalar <var>beta</var>.  When <span class="parmname">beta</span> is equal to zero, then <span class="parmname">c</span> need not be set on input.</p>
</dd>
<dt class="dlterm"><span class="parmname">c</span></dt>

<dd><p><span class="keyword">INTEGER*4</span></p>
<p>Array, size <span class="parmname">ldc</span> by <span class="parmname">n</span>. Before entry, the leading <span class="parmname">m</span>-by-<span class="parmname">n</span> part of the array <span class="parmname">c</span> must contain the matrix <var>C</var>, except when <span class="parmname">beta</span> is equal to zero, in which case <span class="parmname">c</span> need not be set on entry.</p>
</dd>
<dt class="dlterm"><span class="parmname">ldc</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>Specifies the leading dimension of <span class="parmname">c</span> as declared in the calling (sub)program. </p>
<p>The value of <span class="parmname">ldc</span> must be at least <samp class="codeph">max(1, <span class="parmname">m</span>)</samp>. </p>
</dd>
<dt class="dlterm"><span class="parmname">oc</span></dt>

<dd><p>Array, size <var>len</var>.  Specifies the offset values for matrix <var>C</var>. </p>
<ul class="simple"><li>If <samp class="codeph"><span class="parmname">offsetc</span> = </samp><span><samp class="codeph">'F'</samp> or <samp class="codeph">'f'</samp></span>: <var>len</var> must be at least 1.</li>
<li>If <samp class="codeph"><span class="parmname">offsetc</span> = </samp><span><samp class="codeph">'C'</samp> or <samp class="codeph">'c'</samp></span>: <var>len</var> must be at least max(1, <span class="parmname">m</span>).</li>
<li>If <samp class="codeph"><span class="parmname">offsetc</span> = </samp><span><samp class="codeph">'R'</samp> or <samp class="codeph">'r'</samp></span>: <span class="parmname">oc</span> must be at least max(1, <span class="parmname">n</span>).</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="ARGUMENTS_17E7827FF80E4393B31A77A6DA1AE0F2"><h2 class="sectiontitle">Output Parameters</h2><table cellspacing="0" cellpadding="4" border="0" width="90%" style="border-spacing:0; border-collapse:collapse"><tr><td valign="top" width="30%" class="noborder"><p><span class="parmname">c</span></p></td>

<td valign="top" class="noborder"><p>Overwritten by <samp class="codeph"><var>alpha</var>*(op(<var>A</var>) + <var>A_offset</var>)*(op(<var>B</var>) + <var>B_offset</var>) + <var>beta</var>*<var>C</var>+ <var>C_offset</var></samp>.</p>
</td>
</tr></table></div>
<div class="section" id="APPLICATIONNOTES_DB3E9F0C2945490DB2B9D06836E51D40"><h2 class="sectiontitle">Application Notes</h2><p> The matrix-matrix product can be expanded:</p>
<p><samp class="codeph"> (op(<var>A</var>) + <var>A_offset</var>)*(op(<var>B</var>) + <var>B_offset</var>)</samp></p>
<p><samp class="codeph"> = op(<var>A</var>)*op(<var>B</var>) + op(<var>A</var>)*<var>B_offset</var> + <var>A_offset</var>*op(<var>B</var>) + <var>A_offset</var>*<var>B_offset</var></samp></p>
<p>After computing these four multiplication terms separately, they are summed from left to right.  The
results from the matrix-matrix product and the <var>C</var> matrix are scaled
with <var>alpha</var> and <var>beta</var> floating-point values respectively using
double-precision arithmetic. Before storing the results to the
output <span class="parmname">c</span> array, the floating-point values are rounded to the
nearest integers. In the event of overflow or underflow,  the results depend on the architecture . The results are either unsaturated (wrapped) or saturated to maximum or minimum representable integer values for the data type of the output matrix.</p>
<p> When using <samp class="codeph">cblas_gemm_s8u8s32</samp> with row-major layout, the data types of <var>A</var> and <var>B</var> must be swapped. That is, you must provide an 8-bit unsigned integer array for matrix <var>A</var> and an 8-bit signed integer array for matrix <var>B</var>.</p>
<p>Intermediate integer computations in <span><span class="option">gemm_s8u8s32</span></span>  on 64-bit Intel&reg; Advanced Vector Extensions 2 (Intel&reg; AVX2) and Intel&reg; Advanced Vector Extensions 512 (Intel&reg; AVX-512) architectures without Vector Neural Network Instructions (VNNI) extensions can saturate. This is because only 16-bits are available for the accumulation of intermediate results. You can avoid integer saturation by maintaining all integer elements of A or B matrices under 8 bits.</p>
</div>
</div>

<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-723C9818-01C2-4825-912B-343F445DDB96.html">BLAS-like Extensions</a></div>
</div>
<div/>
</body>
</html>
