<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0016)http://localhost -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="DC.Type" content="FunctionRef"/>
<meta name="DC.Title" content="?laed7"/>
<meta name="abstract" content="Used by ?stedc. Computes the updated eigensystem of a diagonal matrix after modification by a rank-one symmetric matrix. Used when the original matrix is dense."/>
<meta name="description" content="Used by ?stedc. Computes the updated eigensystem of a diagonal matrix after modification by a rank-one symmetric matrix. Used when the original matrix is dense."/>
<meta name="DC.subject" content="?laed7, LAPACK routines, auxiliary routines, symmetric eigenvalue problems, auxiliary"/>
<meta name="keywords" content="?laed7, LAPACK routines, auxiliary routines, symmetric eigenvalue problems, auxiliary"/>
<meta name="DC.Relation" scheme="URI" content="GUID-118DC64D-62BB-4B91-9E76-562387E86B79.html"/>
<meta name="DC.Relation" scheme="URI" content="http://www.intel.com/software/products/softwaredocs_feedback"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-8249A456-24C1-4E6A-B30E-A1F4EFD3B8F1"/>
<meta name="DC.Language" content="en-US"/>
<link rel="stylesheet" type="text/css" href="intel_css_styles.css"/>
<title>?laed7</title>

</head>
<body id="GUID-8249A456-24C1-4E6A-B30E-A1F4EFD3B8F1">
 <!-- ==============(Start:NavScript)================= -->
 <script src="NavScript.js" language="JavaScript1.2" type="text/javascript"></script>
 <script language="JavaScript1.2" type="text/javascript">WriteNavLink(0);</script>
 <!-- ==============(End:NavScript)================= -->
<p id="header_text" style="margin-bottom : 20pt"><em>Intel&reg; oneAPI Math Kernel Library Developer Reference - Fortran</em></p>


<h1 class="topictitle1"><span class="option">?laed7</span></h1>
<!--Used by  ?stedc . Computes the updated eigensystem of a diagonal matrix after modification by a rank-one symmetric matrix. Used when the original matrix is dense.--><div><p class="shortdesc">Used by <span class="option">?stedc</span>. Computes the updated eigensystem of a diagonal matrix after modification by a rank-one symmetric matrix. Used when the original matrix is dense.</p>
<div class="section" id="GUID-6A3139C2-9BE1-4D7A-AAA7-431B9E713EBA"><h2 class="sectiontitle">Syntax</h2><div class="dlsyntaxpara"><p class="dlsyntaxpara"><span class="kwd">call slaed7</span><span class="delim">( </span><span class="var">icompq</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">qsiz</span><span class="sep">, </span><span class="var">tlvls</span><span class="sep">, </span><span class="var">curlvl</span><span class="sep">, </span><span class="var">curpbm</span><span class="sep">, </span><span class="var">d</span><span class="sep">, </span><span class="var">q</span><span class="sep">, </span><span class="var">ldq</span><span class="sep">, </span><span class="var">indxq</span><span class="sep">, </span><span class="var">rho</span><span class="sep">, </span><span class="var">cutpnt</span><span class="sep">, </span><span class="var">qstore</span><span class="sep">, </span><span class="var">qptr</span><span class="sep">, </span><span class="var">prmptr</span><span class="sep">, </span><span class="var">perm</span><span class="sep">, </span><span class="var">givptr</span><span class="sep">, </span><span class="var">givcol</span><span class="sep">, </span><span class="var">givnum</span><span class="sep">, </span><span class="var">work</span><span class="sep">, </span><span class="var">iwork</span><span class="sep">, </span><span class="var">info</span><span class="delim"> )</span></p><p class="dlsyntaxpara"><span class="kwd">call dlaed7</span><span class="delim">( </span><span class="var">icompq</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">qsiz</span><span class="sep">, </span><span class="var">tlvls</span><span class="sep">, </span><span class="var">curlvl</span><span class="sep">, </span><span class="var">curpbm</span><span class="sep">, </span><span class="var">d</span><span class="sep">, </span><span class="var">q</span><span class="sep">, </span><span class="var">ldq</span><span class="sep">, </span><span class="var">indxq</span><span class="sep">, </span><span class="var">rho</span><span class="sep">, </span><span class="var">cutpnt</span><span class="sep">, </span><span class="var">qstore</span><span class="sep">, </span><span class="var">qptr</span><span class="sep">, </span><span class="var">prmptr</span><span class="sep">, </span><span class="var">perm</span><span class="sep">, </span><span class="var">givptr</span><span class="sep">, </span><span class="var">givcol</span><span class="sep">, </span><span class="var">givnum</span><span class="sep">, </span><span class="var">work</span><span class="sep">, </span><span class="var">iwork</span><span class="sep">, </span><span class="var">info</span><span class="delim"> )</span></p><p class="dlsyntaxpara"><span class="kwd">call claed7</span><span class="delim">( </span><span class="var">n</span><span class="sep">, </span><span class="var">cutpnt</span><span class="sep">, </span><span class="var">qsiz</span><span class="sep">, </span><span class="var">tlvls</span><span class="sep">, </span><span class="var">curlvl</span><span class="sep">, </span><span class="var">curpbm</span><span class="sep">, </span><span class="var">d</span><span class="sep">, </span><span class="var">q</span><span class="sep">, </span><span class="var">ldq</span><span class="sep">, </span><span class="var">rho</span><span class="sep">, </span><span class="var">indxq</span><span class="sep">, </span><span class="var">qstore</span><span class="sep">, </span><span class="var">qptr</span><span class="sep">, </span><span class="var">prmptr</span><span class="sep">, </span><span class="var">perm</span><span class="sep">, </span><span class="var">givptr</span><span class="sep">, </span><span class="var">givcol</span><span class="sep">, </span><span class="var">givnum</span><span class="sep">, </span><span class="var">work</span><span class="sep">, </span><span class="var">rwork</span><span class="sep">, </span><span class="var">iwork</span><span class="sep">, </span><span class="var">info</span><span class="delim"> )</span></p><p class="dlsyntaxpara"><span class="kwd">call zlaed7</span><span class="delim">( </span><span class="var">n</span><span class="sep">, </span><span class="var">cutpnt</span><span class="sep">, </span><span class="var">qsiz</span><span class="sep">, </span><span class="var">tlvls</span><span class="sep">, </span><span class="var">curlvl</span><span class="sep">, </span><span class="var">curpbm</span><span class="sep">, </span><span class="var">d</span><span class="sep">, </span><span class="var">q</span><span class="sep">, </span><span class="var">ldq</span><span class="sep">, </span><span class="var">rho</span><span class="sep">, </span><span class="var">indxq</span><span class="sep">, </span><span class="var">qstore</span><span class="sep">, </span><span class="var">qptr</span><span class="sep">, </span><span class="var">prmptr</span><span class="sep">, </span><span class="var">perm</span><span class="sep">, </span><span class="var">givptr</span><span class="sep">, </span><span class="var">givcol</span><span class="sep">, </span><span class="var">givnum</span><span class="sep">, </span><span class="var">work</span><span class="sep">, </span><span class="var">rwork</span><span class="sep">, </span><span class="var">iwork</span><span class="sep">, </span><span class="var">info</span><span class="delim"> )</span></p></div></div>
<div class="section" id="GUID-FEA57FB1-2047-491C-BF30-14E56B4A318E"><h2 class="sectiontitle">Include Files</h2><ul id="d163e82"><li id="d163e83"><span class="filepath">mkl.fi</span></li>
</ul>
</div>
<div class="section" id="GUID-D62E7E5A-A186-4D92-8D7D-9D5A7DAE493B"><h2 class="sectiontitle">Description</h2><p><span/></p>
<p>The routine <span class="option">?laed7</span> computes the updated eigensystem of a diagonal matrix after modification by a rank-one symmetric matrix. This routine is used only for the eigenproblem which requires all eigenvalues and optionally eigenvectors of a dense symmetric/Hermitian matrix that has been reduced to tridiagonal form. For real 
flavors, <span class="option">slaed1</span>/<span class="option">dlaed1</span> handles the case in which all eigenvalues and eigenvectors of a symmetric tridiagonal matrix are desired.</p>
<p><samp class="codeph"><var>T</var> = <var>Q</var>(in)*(<var>D</var>(in)+<var>rho</var>*<var>Z</var>*<var>Z</var><sup><var>T</var></sup>)*<var>Q</var><sup><var>T</var></sup>(in) = <var>Q</var>(out)*<var>D</var>(out)*<var>Q</var><sup><var>T</var></sup>(out)</samp> for real flavors, or</p>
<p><samp class="codeph"><var>T</var> = <var>Q</var>(in)*(<var>D</var>(in)+<var>rho</var>*<var>Z</var>*<var>Z</var><sup><var>H</var></sup>)*<var>Q</var><sup><var>H</var></sup>(in) = <var>Q</var>(out)*<var>D</var>(out)*<var>Q</var><sup><var>H</var></sup>(out)</samp> for complex flavors</p>
<p>where <samp class="codeph"><var>Z</var> = <var>Q</var><sup><var>T</var></sup>*<var>u</var></samp> for real flavors and <samp class="codeph"><var>Z</var> = <var>Q</var><sup><var>H</var></sup>*<var>u</var></samp> for complex flavors, <var>u</var> is a vector of length <var>n</var> with ones in the <var>cutpnt</var> and (<samp class="codeph"><var>cutpnt</var> + 1</samp>) -th elements and zeros elsewhere. The eigenvectors of the original matrix are stored in <var>Q</var>, and the eigenvalues are in <var>D</var>. The algorithm consists of three stages:</p>
<p>The first stage consists of deflating the size of the problem when there are multiple eigenvalues or if there is a zero in the <var>z</var> vector. For each such occurrence the dimension of the secular equation problem is reduced by one. This stage is performed by the routine <span class="option">slaed8</span>/<span class="option">dlaed8</span> (for real flavors) or by the routine <span class="option">slaed2</span>/<span class="option">dlaed2</span> (for complex flavors).</p>
<p>The second stage consists of calculating the updated eigenvalues. This is done by finding the roots of the secular equation via the routine <span class="option">?laed4</span> (as called by <span class="option">?laed9</span> or <span class="option">?laed3</span>). This routine also calculates the eigenvectors of the current problem.</p>
<p>The final stage consists of computing the updated eigenvectors directly using the updated eigenvalues. The eigenvectors for the current problem are multiplied with the eigenvectors from the overall problem.</p>
</div>
<div class="section" id="GUID-AC1C5E4C-E890-463A-B62C-B24C5812912E"><h2 class="sectiontitle">Input Parameters</h2><dl id="GUID-120EED3B-2DF4-4153-8D3D-EEC9E471DE93"><dt class="dlterm"><span class="parmname">icompq</span></dt>

<dd><p><span class="keyword">INTEGER</span>. Used with real flavors only.</p>
<p>If <samp class="codeph"><var>icompq</var> = 0</samp>, compute eigenvalues only. </p>
<p>If <samp class="codeph"><var>icompq</var> = 1</samp>, compute eigenvectors of original dense symmetric matrix also. On entry, the array <var>q</var> must contain the orthogonal matrix used to reduce the original matrix to tridiagonal form.</p>
</dd>
<dt class="dlterm"><span class="parmname">n</span></dt>

<dd><p><span class="keyword">INTEGER</span>. The dimension of the symmetric tridiagonal matrix (<samp class="codeph"><var>n</var><span class="eqsymbol">≥</span> 0</samp>). </p>
</dd>
<dt class="dlterm"><span class="parmname">cutpnt</span></dt>

<dd><p><span class="keyword">INTEGER</span>. The location of the last eigenvalue in the leading sub-matrix. <samp class="codeph">min(1,<var>n</var>) ≤ <var>cutpnt</var> ≤ <var>n</var></samp> .</p>
</dd>
<dt class="dlterm"><span class="parmname">qsiz</span></dt>

<dd><p><span class="keyword">INTEGER</span>. </p>
<p>The dimension of the orthogonal/unitary matrix used to reduce the full matrix to tridiagonal form; <samp class="codeph"><var>qsiz</var><span class="eqsymbol">≥</span><var>n</var></samp>  (for real flavors, <samp class="codeph"><var>qsiz</var><span class="eqsymbol">≥</span><var>n</var></samp> if <samp class="codeph"><var>icompq</var> = 1</samp>).</p>
</dd>
<dt class="dlterm"><span class="parmname">tlvls</span></dt>

<dd><p><span class="keyword">INTEGER</span>. The total number of merging levels in the overall divide and conquer tree.</p>
</dd>
<dt class="dlterm"><span class="parmname">curlvl</span></dt>

<dd><p><span class="keyword">INTEGER</span>. The current level in the overall merge routine, <samp class="codeph">0 ≤ <var>curlvl</var> ≤ <var>tlvls</var></samp> .</p>
</dd>
<dt class="dlterm"><span class="parmname">curpbm</span></dt>

<dd><p><span class="keyword">INTEGER</span>. The current problem in the current level in the overall merge routine (counting from upper left to lower right).</p>
</dd>
<dt class="dlterm"><span class="parmname">d</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">slaed7</span>/<span class="option">claed7</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dlaed7</span>/<span class="option">zlaed7</span>. </p>
<p>Array, dimension at least <samp class="codeph">max(1, <var>n</var>)</samp>. </p>
<p>Array <var>d</var>(*) contains the eigenvalues of the rank-1-perturbed matrix. </p>
</dd>
<dt class="dlterm"><span class="parmname">q</span>, <span class="parmname">work</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">slaed7</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dlaed7</span></p>
<p><span class="keyword">COMPLEX</span> for <span class="option">claed7</span></p>
<p><span class="keyword">DOUBLE COMPLEX</span> for <span class="option">zlaed7</span>.</p>
<p>Arrays: </p>
<p><samp class="codeph"><var>q</var>(<var>ldq</var>, *)</samp> contains the eigenvectors of the rank-1-perturbed matrix. The second dimension of <var>q</var> must be at least <samp class="codeph">max(1, <var>n</var>)</samp>.</p>
<p><var>work</var>(<var>*</var>) is a workspace array, dimension at least (<samp class="codeph">3<var>n</var>+2*<var>qsiz</var>*<var>n</var></samp>) for real flavors and at least (<samp class="codeph"><var>qsiz</var>*<var>n</var></samp>) for complex flavors.</p>
</dd>
<dt class="dlterm"><span class="parmname">ldq</span></dt>

<dd><p><span class="keyword">INTEGER</span>. The leading dimension of the array <var>q</var>; <samp class="codeph"><var>ldq</var><span class="eqsymbol">≥</span> max(1, <var>n</var>)</samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">indxq</span></dt>

<dd><p><span class="keyword">INTEGER</span>. Array, dimension (<var>n</var>).</p>
<p>Contains the permutation that separately sorts the two sub-problems in <var>d</var> into ascending order.</p>
</dd>
<dt class="dlterm"><span class="parmname">rho</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">slaed7</span> /<span class="option">claed7</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dlaed7</span>/<span class="option">zlaed7</span>. </p>
<p>The subdiagonal element used to create the rank-1 modification.</p>
</dd>
<dt class="dlterm"><span class="parmname">qstore</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">slaed7</span>/<span class="option">claed7</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dlaed7</span>/<span class="option">zlaed7</span>.</p>
<p>Array, dimension (<samp class="codeph"><var>n</var><sup class="power">2</sup>+1</samp>). Serves also as output parameter. </p>
<p>Stores eigenvectors of submatrices encountered during divide and conquer, packed together. <var>qptr</var> points to beginning of the submatrices.</p>
</dd>
<dt class="dlterm"><span class="parmname">qptr</span></dt>

<dd><p><span class="keyword">INTEGER</span>. Array, dimension (<var>n</var>+2). Serves also as output parameter. List of indices pointing to beginning of submatrices stored in <var>qstore</var>. The submatrices are numbered starting at the bottom left of the divide and conquer tree, from left to right and bottom to top.</p>
</dd>
<dt class="dlterm"><span class="parmname">prmptr</span>, <span class="parmname">perm</span>, <span class="parmname">givptr</span></dt>

<dd><p><span class="keyword">INTEGER</span>. Arrays, dimension (<var>n</var> log<sub>2</sub><var>n</var>) each.</p>
<p>The array <var>prmptr</var>(*) contains a list of pointers which indicate where in <var>perm</var> a level's permutation is stored. <samp class="codeph"><var>prmptr</var>(i+1) - <var>prmptr</var>(i)</samp> indicates the size of the permutation and also the size of the full, non-deflated problem.</p>
<p>The array <var>perm</var>(*) contains the permutations (from deflation and sorting) to be applied to each eigenblock. This parameter can be modified by <span class="option">?laed8</span>, where it is output.</p>
<p>The array <var>givptr</var>(*) contains a list of pointers which indicate where in <var>givcol</var> a level's Givens rotations are stored. <samp class="codeph"><var>givptr</var>(i+1) - <var>givptr</var>(i)</samp> indicates the number of Givens rotations.</p>
</dd>
<dt class="dlterm"><span class="parmname">givcol</span></dt>

<dd><p><span class="keyword">INTEGER</span>. Array, dimension (2, <var>n</var> log<sub>2</sub><var>n</var>).</p>
<p>Each pair of numbers indicates a pair of columns to take place in a Givens rotation.</p>
</dd>
<dt class="dlterm"><span class="parmname">givnum</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">slaed7</span>/<span class="option">claed7</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dlaed7</span>/<span class="option">zlaed7</span>.</p>
<p>Array, dimension (2, <var>n</var> log<sub>2</sub><var>n</var>). </p>
<p>Each number indicates the <var>S</var> value to be used in the corresponding Givens rotation.</p>
</dd>
<dt class="dlterm"><span class="parmname">iwork</span></dt>

<dd><p><span class="keyword">INTEGER</span>. </p>
<p>Workspace array, dimension (4<var>n</var> ).</p>
</dd>
<dt class="dlterm"><span class="parmname">rwork</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">claed7</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">zlaed7</span>. </p>
<p>Workspace array, dimension (<samp class="codeph">3<var>n</var>+2<var>qsiz</var>*<var>n</var></samp>). Used in complex flavors only.</p>
</dd>
</dl>
</div>
<div class="section" id="GUID-D317A8B0-027E-46E9-AEBB-03103BCE9DAC"><h2 class="sectiontitle">Output Parameters</h2><dl id="GUID-7D042ED3-E856-4A60-9E2D-DC50542ED0DB"><dt class="dlterm"><span class="parmname">d</span></dt>

<dd><p>On exit, contains the eigenvalues of the repaired matrix.</p>
</dd>
<dt class="dlterm"><span class="parmname">q</span></dt>

<dd><p>On exit, <var>q</var> contains the eigenvectors of the repaired tridiagonal matrix.</p>
</dd>
<dt class="dlterm"><span class="parmname">indxq</span></dt>

<dd><p><span class="keyword">INTEGER</span>. Array, dimension (<var>n</var>).</p>
<p>Contains the permutation that reintegrates the subproblems back into a sorted order, that is, </p>
<p><samp class="codeph"><var>d</var>(<var>indxq</var>(i = 1, <var>n</var>))</samp> will be in the ascending order.</p>
</dd>
<dt class="dlterm"><span class="parmname">rho</span></dt>

<dd><p> This parameter can be 
modified by <span class="option">?laed8</span>, where it is input/output.
</p>
</dd>
<dt class="dlterm"><span class="parmname">prmptr</span>, <span class="parmname">perm</span>,
 <span class="parmname">givptr</span></dt>

<dd><p><span class="keyword">INTEGER</span>. Arrays, dimension (<var>n</var> log<sub>2</sub><var>n</var>) each.</p>
<p>The array <var>prmptr</var> contains an updated list of pointers.</p>
<p>The array <var>perm</var> contains an updated permutation.</p>
<p>The array <var>givptr</var> contains an updated list of pointers.</p>
</dd>
<dt class="dlterm"><span class="parmname">givcol</span></dt>

<dd><p>This parameter can be modified by <span class="option">?laed8</span>, where it is output.</p>
</dd>
<dt class="dlterm"><span class="parmname">givnum</span></dt>

<dd><p>This parameter can be modified by <span class="option">?laed8</span>, where it is output.</p>
</dd>
<dt class="dlterm"><span class="parmname">info</span></dt>

<dd><p><span class="keyword">INTEGER</span>. </p>
<p>If <samp class="codeph"><var>info</var> = 0</samp>, the execution is successful. </p>
<p>If <samp class="codeph"><var>info</var> = <var>-i</var></samp>, the <var>i</var>-th parameter had an illegal value. </p>
<p>If <samp class="codeph"><var>info</var> = 1</samp>, an eigenvalue did not converge.</p>
</dd>
</dl>
</div>
</div>

<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-118DC64D-62BB-4B91-9E76-562387E86B79.html">LAPACK Auxiliary Routines</a></div>
</div>
<div/>
</body>
</html>
