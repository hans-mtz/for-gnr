<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0016)http://localhost -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="DC.Type" content="FunctionRef"/>
<meta name="DC.Title" content="?gsvj1"/>
<meta name="abstract" content="Pre-processor for the routine ?gesvj, applies Jacobi rotations targeting only particular pivots."/>
<meta name="description" content="Pre-processor for the routine ?gesvj, applies Jacobi rotations targeting only particular pivots."/>
<meta name="DC.subject" content="?gsvj1, LAPACK routines"/>
<meta name="keywords" content="?gsvj1, LAPACK routines"/>
<meta name="DC.Relation" scheme="URI" content="GUID-118DC64D-62BB-4B91-9E76-562387E86B79.html"/>
<meta name="DC.Relation" scheme="URI" content="http://www.intel.com/software/products/softwaredocs_feedback"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-6D86E777-A72C-4BED-A8B5-FB7822E23497"/>
<meta name="DC.Language" content="en-US"/>
<link rel="stylesheet" type="text/css" href="intel_css_styles.css"/>
<title>?gsvj1</title>

</head>
<body id="GUID-6D86E777-A72C-4BED-A8B5-FB7822E23497">
 <!-- ==============(Start:NavScript)================= -->
 <script src="NavScript.js" language="JavaScript1.2" type="text/javascript"></script>
 <script language="JavaScript1.2" type="text/javascript">WriteNavLink(0);</script>
 <!-- ==============(End:NavScript)================= -->
<p id="header_text" style="margin-bottom : 20pt"><em>Intel&reg; oneAPI Math Kernel Library Developer Reference - Fortran</em></p>


<h1 class="topictitle1"><span class="option">?gsvj1</span></h1>
<!--Pre-processor for the routine  ?gesvj , applies Jacobi rotations targeting only particular pivots.--><div><p class="shortdesc">Pre-processor for the routine <span class="option">?gesvj</span>, applies Jacobi rotations targeting only particular pivots.</p>
<div class="section" id="GUID-0DAEA86E-D3C4-4751-972B-7F7D37222018"><h2 class="sectiontitle">Syntax</h2><dl class="dlsyntax"><p class="dlsyntaxpara"><span class="kwd">call sgsvj1</span><span class="delim">(</span><span class="var">jobv</span><span class="sep">, </span><span class="var">m</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">n1</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">lda</span><span class="sep">, </span><span class="var">d</span><span class="sep">, </span><span class="var">sva</span><span class="sep">, </span><span class="var">mv</span><span class="sep">, </span><span class="var">v</span><span class="sep">, </span><span class="var">ldv</span><span class="sep">, </span><span class="var">eps</span><span class="sep">, </span><span class="var">sfmin</span><span class="sep">, </span><span class="var">tol</span><span class="sep">, </span><span class="var">nsweep</span><span class="sep">, </span><span class="var">work</span><span class="sep">, </span><span class="var">lwork</span><span class="sep">, </span><span class="var">info</span><span class="delim">)</span></p><p class="dlsyntaxpara"><span class="kwd">call dgsvj1</span><span class="delim">(</span><span class="var">jobv</span><span class="sep">, </span><span class="var">m</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">n1</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">lda</span><span class="sep">, </span><span class="var">d</span><span class="sep">, </span><span class="var">sva</span><span class="sep">, </span><span class="var">mv</span><span class="sep">, </span><span class="var">v</span><span class="sep">, </span><span class="var">ldv</span><span class="sep">, </span><span class="var">eps</span><span class="sep">, </span><span class="var">sfmin</span><span class="sep">, </span><span class="var">tol</span><span class="sep">, </span><span class="var">nsweep</span><span class="sep">, </span><span class="var">work</span><span class="sep">, </span><span class="var">lwork</span><span class="sep">, </span><span class="var">info</span><span class="delim">)</span></p><p class="dlsyntaxpara"><span class="kwd">call cgsvj1</span><span class="delim">(</span><span class="var">jobv</span><span class="sep">, </span><span class="var">m</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">n1</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">lda</span><span class="sep">, </span><span class="var">d</span><span class="sep">, </span><span class="var">sva</span><span class="sep">, </span><span class="var">mv</span><span class="sep">, </span><span class="var">v</span><span class="sep">, </span><span class="var">ldv</span><span class="sep">, </span><span class="var">eps</span><span class="sep">, </span><span class="var">sfmin</span><span class="sep">, </span><span class="var">tol</span><span class="sep">, </span><span class="var">nsweep</span><span class="sep">, </span><span class="var">work</span><span class="sep">, </span><span class="var">lwork</span><span class="sep">, </span><span class="var">info</span><span class="delim">)</span></p><p class="dlsyntaxpara"><span class="kwd">call zgsvj1</span><span class="delim">(</span><span class="var">jobv</span><span class="sep">, </span><span class="var">m</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">n1</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">lda</span><span class="sep">, </span><span class="var">d</span><span class="sep">, </span><span class="var">sva</span><span class="sep">, </span><span class="var">mv</span><span class="sep">, </span><span class="var">v</span><span class="sep">, </span><span class="var">ldv</span><span class="sep">, </span><span class="var">eps</span><span class="sep">, </span><span class="var">sfmin</span><span class="sep">, </span><span class="var">tol</span><span class="sep">, </span><span class="var">nsweep</span><span class="sep">, </span><span class="var">work</span><span class="sep">, </span><span class="var">lwork</span><span class="sep">, </span><span class="var">info</span><span class="delim">)</span></p></dl></div>
<div class="section" id="GUID-940D5AC9-83CD-494B-9782-5B001EB93235"><h2 class="sectiontitle">Include Files</h2><ul id="d163e82"><li id="d163e83"><span class="filepath">mkl.fi</span></li>
</ul>
</div>
<div class="section" id="GUID-E31303C0-4014-4F79-9C84-940D7E42C41E"><h2 class="sectiontitle">Description</h2><p><span/></p>
<p>This routine is  called from <a href="GUID-9469788C-1DF5-46A8-999B-F71B17245938.html#GUID-9469788C-1DF5-46A8-999B-F71B17245938"><span class="option">?gesvj</span></a>
 as a pre-processor and that is its main purpose. It applies Jacobi rotations in the same way as <span class="option">?gesvj</span> does, but it targets only particular pivots and
it does not check convergence (stopping criterion). </p>
<p>The routine <span class="option">?gsvj1</span> applies few sweeps of Jacobi rotations in the column space of the input <span class="parmname">m</span>-by-<span class="parmname">n</span> matrix <var>A</var>. The pivot pairs are taken from the (1,2) off-diagonal block in the corresponding <span class="parmname">n</span>-by-<span class="parmname">n</span>
 Gram matrix <samp class="codeph"><var>A</var>'*<var>A</var></samp>. The block-entries (<em>tiles</em>) of the (1,2) off-diagonal block are marked by the <samp class="codeph">[x]</samp>'s in the following scheme:</p>
<p><span><img class="img-middle" src="equations/GUID-6D86E777-A72C-4BED-A8B5-FB7822E23ee1.png"/></span></p>
<p> row-cycling in the <span class="parmname">nblr</span>-by-<span class="parmname">nblc</span><samp class="codeph">[x]</samp> blocks, row-cyclic pivoting inside each <samp class="codeph">[x]</samp> block</p>
<p>In terms of the columns of the matrix <var>A</var>, the first <span class="parmname">n1</span> columns are rotated 'against' the remaining <span class="parmname">n</span>-<span class="parmname">n1</span> columns, trying to increase the angle between the corresponding subspaces. The off-diagonal block is <span class="parmname">n1</span>-by-(<span class="parmname">n</span>-<span class="parmname">n1</span>) and it is tiled using quadratic tiles. The number of sweeps is specified by <span class="parmname">nsweep</span>, and the orthogonality threshold is set by <span class="parmname">tol.</span></p>
</div>
<div class="section" id="GUID-5C8F9442-45DE-481E-98A2-4D3BD842C939"><h2 class="sectiontitle">Input Parameters</h2><dl id="GUID-1BA97297-5EA5-4E41-91F7-D57E4CFDD7CF"><dt class="dlterm"><span class="parmname">jobv</span></dt>

<dd><p><span class="keyword">CHARACTER*1</span>. Must be <span class="keyword">'V'</span>, <span class="keyword">'A'</span>, or <span class="keyword">'N'</span>. </p>
<p>Specifies whether the output from this routine is used to compute the matrix <var>V</var>.</p>
<p>If <samp class="codeph"><var>jobv</var> = <span class="keyword">'V'</span></samp>, the product of the Jacobi rotations is accumulated by post-multiplying the <span class="parmname">n</span>-by-<span class="parmname">n</span> array <span class="parmname">v</span>.</p>
<p>If <samp class="codeph"><var>jobv</var> = <span class="keyword">'A'</span></samp>, the product of the Jacobi rotations is accumulated by post-multiplying the <span class="parmname">mv</span>-by-<span class="parmname">n</span> array <span class="parmname">v</span>.
</p>
<p>If <samp class="codeph"><var>jobv</var> = <span class="keyword">'N'</span></samp>, the Jacobi rotations are not accumulated.</p>
</dd>
<dt class="dlterm"><span class="parmname">m</span></dt>

<dd><p><span class="keyword">INTEGER</span>. The number of rows of the input matrix <var>A</var> (<var>m</var><span class="eqsymbol">≥</span> 0).</p>
</dd>
<dt class="dlterm"><span class="parmname">n</span></dt>

<dd><p><span class="keyword">INTEGER</span>. The number of columns of the input matrix <var>B</var> (<var>m</var><span class="eqsymbol">≥</span><var>n</var><span class="eqsymbol">≥</span> 0).</p>
</dd>
<dt class="dlterm"><span class="parmname">n1</span></dt>

<dd><p><span class="keyword">INTEGER</span>. Specifies the 2-by-2 block partition. The first <span class="parmname">n1</span> columns are rotated 'against' the remaining <samp class="codeph"><span class="parmname">n</span>-<span class="parmname">n1</span></samp> columns of the matrix <var>A</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">a</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">sgsvj1</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dgsvj1</span>. </p>
<p><span class="keyword">COMPLEX</span> for <span class="option">cgsvj1</span></p>
<p><span class="keyword">DOUBLE COMPLEX</span> for <span class="option">zgsvj1</span>. </p>
<p>Array, <span class="keyword">DIMENSION</span> (<span class="parmname">lda</span>, <span class="parmname">n</span>). Contains the <span class="parmname">m</span>-by-<span class="parmname">n</span> matrix <var>A</var>, such that 

<samp class="codeph"><var>A</var>*diag(<var>D</var>)</samp> represents the input matrix. </p>
</dd>
<dt class="dlterm"><span class="parmname">lda</span></dt>

<dd><p><span class="keyword">INTEGER</span>. The leading dimension of <var>a</var>; at least <samp class="codeph">max(1, <var>m</var>)</samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">d</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">sgsvj1</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dgsvj1</span>. </p>
<p><span class="keyword">COMPLEX</span> for <span class="option">cgsvj1</span></p>
<p><span class="keyword">DOUBLE COMPLEX</span> for <span class="option">zgsvj1</span>. </p>
<p>Arrays, <span class="keyword">DIMENSION</span> (<span class="parmname">n</span>). Contains the diagonal matrix <var>D</var> that accumulates the scaling factors from the fast scaled          Jacobi rotations.
On entry <samp class="codeph"><var>A</var>*diag(<var>D</var>)</samp> represents the input matrix.</p>
</dd>
<dt class="dlterm"><span class="parmname">sva</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">sgsvj1</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dgsvj1</span>. </p>
<p><span class="keyword">REAL</span> for <span class="option">cgsvj1</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">zgsvj1</span>. </p>
<p>Arrays, <span class="keyword">DIMENSION</span> (<span class="parmname">n</span>). Contains the Euclidean norms of the columns of the matrix <samp class="codeph"><var>A</var>*diag(<var>D</var>)</samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">mv</span></dt>

<dd><p><span class="keyword">INTEGER</span>. The leading dimension of <var>b</var>; at least max(1, <var>p</var>).</p>
<p>If <samp class="codeph"><var>jobv</var> = <span class="keyword">'A'</span></samp>, then <span class="parmname">mv</span> rows of <span class="parmname">v</span> are post-multiplied by a sequence of Jacobi rotations.</p>
<p>If <samp class="codeph"><var>jobv</var> = <span class="keyword">'N'</span></samp>, then <span class="parmname">mv</span> is not referenced
.</p>
</dd>
<dt class="dlterm"><span class="parmname">v</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">sgsvj1</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dgsvj1</span>. </p>
<p><span class="keyword">COMPLEX</span> for <span class="option">cgsvj1</span></p>
<p><span class="keyword">DOUBLE COMPLEX</span> for <span class="option">zgsvj1</span>. </p>
<p>Array, <span class="keyword">DIMENSION</span> (<span class="parmname">ldv</span>, <span class="parmname">n</span>).  </p>
<p>If <samp class="codeph"><var>jobv</var> = <span class="keyword">'V'</span></samp>, then <span class="parmname">n</span> rows of <span class="parmname">v</span> are post-multiplied by a sequence of Jacobi rotations.</p>
<p>If <samp class="codeph"><var>jobv</var> = <span class="keyword">'A'</span></samp>, then <span class="parmname">mv</span> rows of <span class="parmname">v</span> are post-multiplied by a sequence of Jacobi rotations.</p>
<p>If <samp class="codeph"><var>jobv</var> = <span class="keyword">'N'</span></samp>, then <span class="parmname">v</span> is not referenced.</p>
</dd>
<dt class="dlterm"><span class="parmname">ldv</span></dt>

<dd><p><span class="keyword">INTEGER</span>. The leading dimension of the array <var>v</var>; <var>ldv</var><span class="eqsymbol">≥</span> 1
 </p>
<p><samp class="codeph"><var>ldv</var><span class="eqsymbol">≥</span><var> n</var></samp> if <samp class="codeph"><var>jobv</var> = <span class="keyword">'V'</span></samp>; </p>
<p><samp class="codeph"><var>ldv</var><span class="eqsymbol">≥</span><var> mv</var></samp> if <samp class="codeph"><var>jobv</var> = <span class="keyword">'A'</span></samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">eps</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">sgsvj1</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dgsvj1</span>. </p>
<p><span class="keyword">REAL</span> for <span class="option">cgsvj1</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">zgsvj1</span>. </p>
<p>The relative machine precision (epsilon) returned by the routine <a href="GUID-7D137664-6F3E-4832-BEDD-39EAF5AE9F52.html#GUID-7D137664-6F3E-4832-BEDD-39EAF5AE9F52"><span class="option">?lamch</span></a>.</p>
</dd>
<dt class="dlterm"><span class="parmname">sfmin</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">sgsvj1</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dgsvj1</span>. </p>
<p><span class="keyword">REAL</span> for <span class="option">cgsvj1</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">zgsvj1</span>. </p>
<p>Value of safe minimum returned by the routine <a href="GUID-7D137664-6F3E-4832-BEDD-39EAF5AE9F52.html#GUID-7D137664-6F3E-4832-BEDD-39EAF5AE9F52"><span class="option">?lamch</span></a>.</p>
</dd>
<dt class="dlterm"><span class="parmname">tol</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">sgsvj1</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dgsvj1</span>. </p>
<p><span class="keyword">REAL</span> for <span class="option">cgsvj1</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">zgsvj1</span>. </p>
<p>The threshold for Jacobi rotations. For a pair <samp class="codeph"><var>A</var>(:,p)</samp>, <samp class="codeph"><var>A</var>(:,q)</samp> of pivot columns, the Jacobi rotation is applied only if <samp class="codeph">abs(cos(angle(<var>A</var>(:,p),<var>A</var>(:,q))))&gt; <span class="parmname">tol</span></samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">nsweep</span></dt>

<dd><p><span class="keyword">INTEGER</span>.</p>
<p>The number of sweeps of Jacobi rotations to be performed.</p>
</dd>
<dt class="dlterm"><span class="parmname">work</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">sgsvj1</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dgsvj1</span>. </p>
<p><span class="keyword">COMPLEX</span> for <span class="option">cgsvj1</span></p>
<p><span class="keyword">DOUBLE COMPLEX</span> for <span class="option">zgsvj1</span>. </p>
<p>Workspace array, <span class="keyword">DIMENSION</span> (<span class="parmname">lwork</span>).  
</p>
</dd>
<dt class="dlterm"><span class="parmname">lwork</span></dt>

<dd><p><span class="keyword">INTEGER</span>. The size of the array <var>work</var>;  at least <samp class="codeph">max(1, <var>m</var>)</samp>.</p>
</dd>
</dl>
</div>
<div class="section" id="GUID-02D033E7-588A-4D57-84DE-CA55FA599A75"><h2 class="sectiontitle">Output Parameters</h2><dl id="GUID-C5105EE2-495F-4E3D-A628-EBD4017CFA5D"><dt class="dlterm"><span class="parmname">a</span></dt>

<dd><p>On exit, <samp class="codeph"><var>A</var>*diag(<var>D</var>)</samp> represents the input matrix  post-multiplied by a sequence of Jacobi rotations, where the rotation threshold and the total number of sweeps are given in <span class="parmname">tol</span> and <span class="parmname">nsweep</span>, respectively
</p>
</dd>
<dt class="dlterm"><span class="parmname">d</span></dt>

<dd><p>On exit, <samp class="codeph"><var>A</var>*diag(<var>D</var>)</samp> represents the input matrix
post-multiplied by a sequence of Jacobi rotations, where the rotation threshold and the total number of sweeps are given in <span class="parmname">tol</span> and <span class="parmname">nsweep</span>, respectively.</p>
</dd>
<dt class="dlterm"><span class="parmname">sva</span></dt>

<dd><p>On exit, contains the Euclidean norms of the columns of the output matrix <samp class="codeph"><var>A</var>*diag(<var>D</var>)</samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">v</span></dt>

<dd><p>If <samp class="codeph"><var>jobv</var> = <span class="keyword">'V'</span></samp>, then <span class="parmname">n</span> rows of <span class="parmname">v</span> are post-multiplied by a sequence of Jacobi rotations.</p>
<p>If <samp class="codeph"><var>jobv</var> = <span class="keyword">'A'</span></samp>, then <span class="parmname">mv</span> rows of <span class="parmname">v</span> are post-multiplied by a sequence of Jacobi rotations.</p>
<p>If <samp class="codeph"><var>jobv</var> = <span class="keyword">'N'</span></samp>, then <span class="parmname">v</span> is not referenced.</p>
</dd>
<dt class="dlterm"><span class="parmname">info</span></dt>

<dd><p><span class="keyword">INTEGER</span>. </p>
<p>If <samp class="codeph"><var>info</var> = 0</samp>, the execution is successful. </p>
<p>If <samp class="codeph"><var>info</var> = <var>-i</var></samp>, the <var>i</var>-th parameter had an illegal value. </p>
</dd>
</dl>
</div>
</div>

<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-118DC64D-62BB-4B91-9E76-562387E86B79.html">LAPACK Auxiliary Routines</a></div>
</div>
<div/>
</body>
</html>
