<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0016)http://localhost -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="DC.Type" content="FunctionRef"/>
<meta name="DC.Title" content="p?geequ"/>
<meta name="abstract" content="Computes row and column scaling factors intended to equilibrate a general rectangular distributed matrix and reduce its condition number."/>
<meta name="description" content="Computes row and column scaling factors intended to equilibrate a general rectangular distributed matrix and reduce its condition number."/>
<meta name="DC.subject" content="p?geequ, ScaLAPACK routines, matrix equilibration, scaling factors, general rectangular distributed matrix, equilibration, computing scaling factors"/>
<meta name="keywords" content="p?geequ, ScaLAPACK routines, matrix equilibration, scaling factors, general rectangular distributed matrix, equilibration, computing scaling factors"/>
<meta name="DC.Relation" scheme="URI" content="GUID-D9C8E93A-B463-4E4D-90FD-C215D80A5421.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-97273960-E4A4-4016-8667-BE6A36156792.html#GUID-97273960-E4A4-4016-8667-BE6A36156792"/>
<meta name="DC.Relation" scheme="URI" content="http://www.intel.com/software/products/softwaredocs_feedback"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-D01B5C19-5F75-442C-B58D-0D0E7B121AE8"/>
<meta name="DC.Language" content="en-US"/>
<link rel="stylesheet" type="text/css" href="intel_css_styles.css"/>
<title>p?geequ</title>

</head>
<body id="GUID-D01B5C19-5F75-442C-B58D-0D0E7B121AE8">
 <!-- ==============(Start:NavScript)================= -->
 <script src="NavScript.js" language="JavaScript1.2" type="text/javascript"></script>
 <script language="JavaScript1.2" type="text/javascript">WriteNavLink(0);</script>
 <!-- ==============(End:NavScript)================= -->
<p id="header_text" style="margin-bottom : 20pt"><em>Intel&reg; oneAPI Math Kernel Library Developer Reference - Fortran</em></p>


<h1 class="topictitle1"><span class="option">p?geequ</span></h1>
<!--Computes row and column scaling factors intended to equilibrate a general rectangular distributed matrix and reduce its condition number.--><div><p class="shortdesc">Computes row and column scaling factors intended to equilibrate a general rectangular distributed matrix and reduce its condition number.</p>
<div class="section" id="GUID-FD3F841C-8092-4553-8C49-3C8DD6BBFC87"><h2 class="sectiontitle">Syntax</h2><dl class="dlsyntax"><p class="dlsyntaxpara"><span class="kwd">call psgeequ</span><span class="delim">(</span><span class="var">m</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">ia</span><span class="sep">, </span><span class="var">ja</span><span class="sep">, </span><span class="var">desca</span><span class="sep">, </span><span class="var">r</span><span class="sep">, </span><span class="var">c</span><span class="sep">, </span><span class="var">rowcnd</span><span class="sep">, </span><span class="var">colcnd</span><span class="sep">, </span><span class="var">amax</span><span class="sep">, </span><span class="var">info</span><span class="delim">)</span></p><p class="dlsyntaxpara"><span class="kwd">call pdgeequ</span><span class="delim">(</span><span class="var">m</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">ia</span><span class="sep">, </span><span class="var">ja</span><span class="sep">, </span><span class="var">desca</span><span class="sep">, </span><span class="var">r</span><span class="sep">, </span><span class="var">c</span><span class="sep">, </span><span class="var">rowcnd</span><span class="sep">, </span><span class="var">colcnd</span><span class="sep">, </span><span class="var">amax</span><span class="sep">, </span><span class="var">info</span><span class="delim">)</span></p><p class="dlsyntaxpara"><span class="kwd">call pcgeequ</span><span class="delim">(</span><span class="var">m</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">ia</span><span class="sep">, </span><span class="var">ja</span><span class="sep">, </span><span class="var">desca</span><span class="sep">, </span><span class="var">r</span><span class="sep">, </span><span class="var">c</span><span class="sep">, </span><span class="var">rowcnd</span><span class="sep">, </span><span class="var">colcnd</span><span class="sep">, </span><span class="var">amax</span><span class="sep">, </span><span class="var">info</span><span class="delim">)</span></p><p class="dlsyntaxpara"><span class="kwd">call pzgeequ</span><span class="delim">(</span><span class="var">m</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">ia</span><span class="sep">, </span><span class="var">ja</span><span class="sep">, </span><span class="var">desca</span><span class="sep">, </span><span class="var">r</span><span class="sep">, </span><span class="var">c</span><span class="sep">, </span><span class="var">rowcnd</span><span class="sep">, </span><span class="var">colcnd</span><span class="sep">, </span><span class="var">amax</span><span class="sep">, </span><span class="var">info</span><span class="delim">)</span></p></dl></div>
<div class="section" id="GUID-6F9BC756-3A6C-47BC-B586-6263EC517AD7"><h2 class="sectiontitle">Include Files</h2><p/>
</div>
<div class="section" id="GUID-AF389C75-DB17-4990-949C-6D6526B4D6DD"><h2 class="sectiontitle">Description</h2><p><span/>The <span class="option">p?geequ</span><span>routine </span>computes row and column scalings intended to equilibrate an  <var>m</var>-by-<var>n</var> distributed matrix sub(<var>A</var>) = <var>A</var>(<span class="parmname">ia</span>:<span class="parmname">ia</span>+<span class="parmname">m</span>-1, <span class="parmname">ja</span>:<span class="parmname">ja</span>+<span class="parmname">n</span>-1) and reduce its condition number. The output array <span class="parmname">r</span> returns the row scale factors <var>r</var><sub><var>i</var></sub> , and the array <span class="parmname">c</span> returns the column scale factors <var>c</var><sub><var>j</var></sub>   . These factors are chosen to try to make the largest element in each row and column of the matrix <var>B</var> with elements <var>b</var><sub class="subb"><var>i</var><var>j</var></sub>=<var>r</var><sub><var>i</var></sub>*<var>a</var><sub class="subb"><var>i</var><var>j</var></sub>*<var>c</var><sub><var>j</var></sub> have absolute value 1.</p>
<p><var>r</var><sub><var>i</var></sub> and <var>c</var><sub><var>j</var></sub>   are restricted to be between <var>SMLNUM</var> = smallest safe number and <var>BIGNUM</var> = largest safe number.  Use of these scaling factors is not guaranteed to reduce the condition number of sub(<var>A</var>) but works well in practice.</p>
<p><var>SMLNUM</var> and 
      <var>BIGNUM</var> are parameters representing machine precision. You can use the 
      <a href="GUID-7D137664-6F3E-4832-BEDD-39EAF5AE9F52.html#GUID-7D137664-6F3E-4832-BEDD-39EAF5AE9F52"><span class="option">?lamch</span></a> routines to compute them. For example, compute single precision values of 
      <var>SMLNUM</var> and 
      <var>BIGNUM</var> as follows: 
      <pre>SMLNUM = slamch ('s')
BIGNUM = 1 / SMLNUM</pre></p>
<p>The auxiliary function p?laqge uses scaling factors computed by <span class="option">p?geequ</span> to scale a general rectangular matrix. </p>
</div>
<div class="section" id="GUID-344995EF-32B8-4904-8B49-D7765F0F4000"><h2 class="sectiontitle">Input Parameters</h2><dl id="GUID-D5EAA444-88E8-4D8D-B859-ACE6B6180126"><dt class="dlterm"><span class="parmname">m</span></dt>

<dd><p>(global) <span><span class="keyword">INTEGER</span>. </span>The number of rows  to be operated on, that is, the number of rows of the distributed matrix sub(<var>A</var>) <samp class="codeph"> (<var>m</var><span class="eqsymbol">≥</span> 0)</samp>. </p>
</dd>
<dt class="dlterm"><span class="parmname">n</span></dt>

<dd><p>(global) <span><span class="keyword">INTEGER</span>. </span>The number of columns  to be operated on, that is, the number of columns of the distributed matrix sub(<var>A</var>) <samp class="codeph">(<var>n</var><span class="eqsymbol">≥</span> 0)</samp>. </p>
</dd>
<dt class="dlterm"><span class="parmname">a</span></dt>

<dd><p>(local)</p>
<p><span class="keyword">REAL</span> for <span class="option">psgeequ</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">pdgeequ</span></p>
<p><span class="keyword">COMPLEX</span> for <span class="option">pcgeequ</span></p>
<p><span class="keyword">DOUBLE COMPLEX</span> for <span class="option">pzgeequ</span> . </p>
<p>Pointer into the local memory to an array of local size <samp class="codeph">(<var>lld_a</var>,<var>LOCc</var>(<var>ja</var>+<var>n</var>-1))</samp>.</p>
<p>The array <var>a</var> contains the local pieces of the <span class="parmname">m</span>-by-<span class="parmname">n</span> distributed matrix whose equilibration factors are to be computed.</p>
</dd>
<dt class="dlterm"><span class="parmname">ia</span>, <span class="parmname">ja</span></dt>

<dd><p>(global) <span><span class="keyword">INTEGER</span>. </span>The row and column indices in the global matrix <var>A</var> indicating the first row and the first column of the matrix sub(<var>A</var>), respectively.</p>
</dd>
<dt class="dlterm"><span class="parmname">desca</span></dt>

<dd><p>(global and local) <span><span class="keyword">INTEGER</span></span> array of size <var>dlen_</var>.  The array descriptor for the distributed matrix <var>A</var>.</p>
</dd>
</dl>
</div>
<div class="section" id="GUID-631BD823-05E4-4BA3-B609-549B8B444312"><h2 class="sectiontitle">Output Parameters</h2><dl id="GUID-C91ECA69-1583-476D-AA4A-6C6CCAB2112C"><dt class="dlterm"><span class="parmname">r</span>, <span class="parmname">c</span></dt>

<dd><p>(local) <span><span class="keyword">REAL</span> for single precision flavors;</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for double precision flavors. </p>
<p>Arrays of sizes <samp class="codeph"><var>LOCr</var>(<var>m_a)</var></samp> and <samp class="codeph"><var>LOCc</var>(<var>n_a)</var></samp>, respectively. </p>
<p>If <samp class="codeph"><var>info</var> = 0</samp>, or <samp class="codeph"><var>info</var><span class="eqsymbol">&gt;</span><var>ia+m-1</var></samp>, <span>the array <samp class="codeph"><var>r</var>(<var>ia:ia+m-1</var>)</samp> contains </span> the row scale factors for sub(<var>A</var>). <span class="parmname">r</span> is aligned with the distributed matrix <var>A</var>, and replicated across every process column. <span class="parmname">r</span> is tied to the distributed matrix <var>A</var>. </p>
<p>If <samp class="codeph"><var>info</var> = 0</samp>, <span>the array <span class="parmname">c</span> (<span class="parmname">ja</span>:<span class="parmname">ja</span>+<span class="parmname">n</span>-1) contains </span>the column scale factors for sub(<var>A</var>). <span class="parmname">c</span> is aligned with the distributed matrix <var>A</var>, and replicated down every process row. <span class="parmname">c</span> is tied to the distributed matrix <var>A</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">rowcnd</span>, <span class="parmname">colcnd</span></dt>

<dd><p>(global) <span><span class="keyword">REAL</span> for single precision flavors;</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for double precision flavors. </p>
<p>If <samp class="codeph"><var>info</var> = 0</samp> or <samp class="codeph"><var>info</var><span class="eqsymbol">&gt;</span><var>ia+m-1</var></samp>, <span class="parmname">rowcnd</span> contains the ratio of the smallest <span><span class="parmname">r</span>(<var>i</var>)</span> to the largest <span><span class="parmname">r</span>(<var>i</var>)</span> (i<span class="parmname">a</span> ≤ <var>i</var> ≤ <span class="parmname">ia</span>+<span class="parmname">m</span>-1).  If <samp class="codeph"><var>rowcnd</var><span class="eqsymbol">≥</span> 0.1</samp> and <span class="parmname">amax</span> is neither too large nor too small, it is not worth scaling by <samp class="codeph"><span><var>r</var>(<var>ia:ia+m-1</var>)</span></samp>. </p>
<p>If <samp class="codeph"><var>info</var> = 0</samp>, <span class="parmname">colcnd</span> contains the ratio of the smallest <span><span class="parmname">c</span>(<var>j</var>)</span> to the largest <span><span class="parmname">c</span>(<var>j</var>)</span>  (<span class="parmname">ja </span>≤ <var>j</var> ≤ <span class="parmname">ja</span>+<span class="parmname">n</span>-1). </p>
<p>If <samp class="codeph"><var>colcnd</var><span class="eqsymbol">≥</span> 0.1</samp>, it is not worth scaling by <samp class="codeph"><span><var>c</var>(<var>ja:ja+n-1</var>)</span></samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">amax</span></dt>

<dd><p>(global) <span><span class="keyword">REAL</span> for single precision flavors;</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for double precision flavors. </p>
<p>Absolute value of the largest matrix element. If <span class="parmname">amax</span> is very close to overflow or very close to underflow, the matrix should be scaled.</p>
</dd>
<dt class="dlterm"><span class="parmname">info</span></dt>

<dd><p>(global) <span><span class="keyword">INTEGER</span>. </span>If <samp class="codeph"><var>info</var>=0</samp>, the execution is successful.</p>
<p><samp class="codeph"><var>info</var> &lt; 0</samp>: </p>
<p>If the <var>i</var>-th argument is an array and the <var>j-</var>th entry had an illegal value, then <span class="parmname">info</span> = -(<var>i</var>*100+<var>j</var>); if the <var>i-</var>th argument is a scalar and had an illegal value, then <span class="parmname">info</span> = <var>-i</var>. </p>
<p><samp class="codeph"><var>info</var><span class="eqsymbol">&gt;</span> 0</samp>: </p>
<p>If <span class="parmname">info</span> = <var>i</var> and </p>
<p><var>i</var> ≤ <span class="parmname">m</span>, the <var>i</var>-th row of the distributed matrix</p>
<p>                          sub(<var>A</var>) is exactly zero;</p>
<p><var>i</var><span class="eqsymbol">&gt;</span><span class="parmname">m</span>, the (<var>i</var> - <span class="parmname">m</span>)-th column of the distributed</p>
<p>                         matrix sub(<var>A</var>) is exactly zero.</p>
</dd>
</dl>
</div>
</div>

<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-D9C8E93A-B463-4E4D-90FD-C215D80A5421.html">Matrix Equilibration: ScaLAPACK Computational Routines</a></div>
</div>
<div class="See Also"><h2>See Also</h2>
<div class="linklist">
<div><a href="GUID-97273960-E4A4-4016-8667-BE6A36156792.html#GUID-97273960-E4A4-4016-8667-BE6A36156792">Overview</a> for details of ScaLAPACK  array descriptor structures and related notations.</div></div></div>
</body>
</html>
