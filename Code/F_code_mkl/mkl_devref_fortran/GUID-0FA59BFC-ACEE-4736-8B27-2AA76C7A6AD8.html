<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0016)http://localhost -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="DC.Type" content="FunctionRef"/>
<meta name="DC.Title" content="?gemm3m"/>
<meta name="abstract" content="Computes a scalar-matrix-matrix product using matrix multiplications and adds the result to a scalar-matrix product."/>
<meta name="description" content="Computes a scalar-matrix-matrix product using matrix multiplications and adds the result to a scalar-matrix product."/>
<meta name="DC.subject" content="?gemm3m, BLAS Level 3 routines, scalar-matrix-matrix product, general matrix, scalar-matrix product, matrix-matrix operation, product, scalar-matrix-matrix, scalar-matrix"/>
<meta name="keywords" content="?gemm3m, BLAS Level 3 routines, scalar-matrix-matrix product, general matrix, scalar-matrix product, matrix-matrix operation, product, scalar-matrix-matrix, scalar-matrix"/>
<meta name="DC.Relation" scheme="URI" content="GUID-723C9818-01C2-4825-912B-343F445DDB96.html"/>
<meta name="DC.Relation" scheme="URI" content="http://www.intel.com/software/products/softwaredocs_feedback"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-0FA59BFC-ACEE-4736-8B27-2AA76C7A6AD8"/>
<meta name="DC.Language" content="en-US"/>
<link rel="stylesheet" type="text/css" href="intel_css_styles.css"/>
<title>?gemm3m</title>

</head>
<body id="GUID-0FA59BFC-ACEE-4736-8B27-2AA76C7A6AD8">
 <!-- ==============(Start:NavScript)================= -->
 <script src="NavScript.js" language="JavaScript1.2" type="text/javascript"></script>
 <script language="JavaScript1.2" type="text/javascript">WriteNavLink(0);</script>
 <!-- ==============(End:NavScript)================= -->
<p id="header_text" style="margin-bottom : 20pt"><em>Intel&reg; oneAPI Math Kernel Library Developer Reference - Fortran</em></p>


<h1 class="topictitle1"><span class="option">?gemm3m</span></h1>
<!--Computes a scalar-matrix-matrix product  using matrix multiplications and adds the result to a scalar-matrix product.--><div><p class="shortdesc">Computes a scalar-matrix-matrix product  using matrix multiplications and adds the result to a scalar-matrix product.</p>
<div class="section" id="GUID-0EC47A56-AE01-4D63-873B-D1926D0E054A"><h2 class="sectiontitle">Syntax</h2><dl class="dlsyntax"><p class="dlsyntaxpara"><span class="kwd">call cgemm3m</span><span class="delim">(</span><span class="var">transa</span><span class="sep">, </span><span class="var">transb</span><span class="sep">, </span><span class="var">m</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">k</span><span class="sep">, </span><span class="var">alpha</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">lda</span><span class="sep">, </span><span class="var">b</span><span class="sep">, </span><span class="var">ldb</span><span class="sep">, </span><span class="var">beta</span><span class="sep">, </span><span class="var">c</span><span class="sep">, </span><span class="var">ldc</span><span class="delim">)</span></p><p class="dlsyntaxpara"><span class="kwd">call zgemm3m</span><span class="delim">(</span><span class="var">transa</span><span class="sep">, </span><span class="var">transb</span><span class="sep">, </span><span class="var">m</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">k</span><span class="sep">, </span><span class="var">alpha</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">lda</span><span class="sep">, </span><span class="var">b</span><span class="sep">, </span><span class="var">ldb</span><span class="sep">, </span><span class="var">beta</span><span class="sep">, </span><span class="var">c</span><span class="sep">, </span><span class="var">ldc</span><span class="delim">)</span></p></dl><dl class="dlsyntax"><p class="dlsyntaxpara"><span class="kwd">call gemm3m</span><span class="delim">(</span><span class="var">a</span><span class="sep">, </span><span class="var">b</span><span class="sep">, </span><span class="var">c</span><span class="delim"> [</span><span class="sep">,</span><span class="var">transa</span><span class="delim">]</span><span class="delim">[</span><span class="sep">,</span><span class="var">transb</span><span class="delim">] </span><span class="delim">[</span><span class="sep">,</span><span class="var">alpha</span><span class="delim">]</span><span class="delim">[</span><span class="sep">,</span><span class="var">beta</span><span class="delim">]</span><span class="delim">)</span></p></dl></div>
<div class="section" id="GUID-C8CB08A5-2998-4C37-B9F3-15BAAF36EE10"><h2 class="sectiontitle">Include Files</h2><ul id="d163e31"><li><span class="filepath">mkl.fi</span>, <span class="filepath">blas.f90</span></li>
</ul>
</div>
<div class="section" id="GUID-78826A66-F950-4BD4-A46F-96979DDAA8EE"><h2 class="sectiontitle">Description</h2><p><span/></p>
<p>The <span class="option">?gemm3m</span> routines perform a matrix-matrix operation with general complex matrices. These routines are similar to the <a class="allformats" href="GUID-97718E5C-6E0A-44F0-B2B1-A551F0F164B2.html#GUID-97718E5C-6E0A-44F0-B2B1-A551F0F164B2"><span class="option">?gemm</span></a> routines, but  they use fewer matrix multiplication operations <span>(see <em>Application Notes</em> below)</span>.</p>
<p>The operation is defined as <pre><var>C</var> := <var>alpha</var>*op(<var>A</var>)*op(<var>B</var>) + <var>beta</var><var>*C</var>,</pre></p>
<p>where:</p>
<p><samp class="codeph">op(<var>x</var>)</samp> is one of <samp class="codeph">op(<var>x</var>) = <var>x</var></samp>, or <samp class="codeph">op(<var>x</var>) = <var>x</var>'</samp>, or <samp class="codeph">op(<var>x</var>) = conjg(<var>x</var>')</samp>,</p>
<p><var>alpha</var> and <var>beta</var> are scalars,</p>
<p><var>A</var>, <var>B</var> and <var>C</var> are matrices:</p>
<p><samp class="codeph">op(<var>A</var>)</samp> is an <var>m</var>-by-<var>k</var> matrix,</p>
<p><samp class="codeph">op(<var>B</var>)</samp> is a <var>k</var>-by-<var>n</var> matrix,</p>
<p><var>C</var> is an <var>m</var>-by-<var>n</var> matrix.</p>
</div>
<div class="section" id="GUID-B38484DC-41FE-4104-BD93-7878A344E47A"><h2 class="sectiontitle">Input Parameters</h2><dl id="GUID-04FF3FF9-9D56-436C-A294-5B5A6C170D9B"><dt class="dlterm"><span class="parmname">transa</span></dt>

<dd><p><span><span class="keyword">CHARACTER*1</span>. </span>Specifies the form of <samp class="codeph">op(<var>A</var>) </samp>used in the matrix multiplication:</p>
<p>if <span><samp class="codeph"><span class="parmname">transa</span> = 'N'</samp> or <samp class="codeph">'n'</samp></span>, then <samp class="codeph">op(<var>A</var>) = <var>A</var></samp>;</p>
<p>if <span><samp class="codeph"><span class="parmname">transa </span>= 'T'</samp> or <samp class="codeph">'t'</samp></span>, then <samp class="codeph">op(<var>A</var>) = <var>A</var>'</samp>;</p>
<p>if <span><samp class="codeph"><span class="parmname">transa</span> = 'C'</samp> or <samp class="codeph">'c'</samp></span>, then <samp class="codeph">op(<var>A</var>) = conjg(<var>A</var>')</samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">transb</span></dt>

<dd><p><span><span class="keyword">CHARACTER*1</span>. </span>Specifies the form of <samp class="codeph">op(<var>B</var>)</samp> used in the matrix multiplication:</p>
<p>if <span><samp class="codeph"><span class="parmname">transb</span> = 'N'</samp> or <samp class="codeph">'n'</samp></span>, then <samp class="codeph">op(<var>B</var>) = <var>B</var></samp>;</p>
<p>if <span><samp class="codeph"><span class="parmname">transb </span>= 'T'</samp> or <samp class="codeph">'t'</samp></span>, then <samp class="codeph">op(<var>B</var>) = <var>B</var>'</samp>;</p>
<p>if <span><samp class="codeph"><span class="parmname">transb</span> = 'C'</samp> or <samp class="codeph">'c'</samp></span>, then <samp class="codeph">op(<var>B</var>) = conjg(<var>B</var>')</samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">m</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>Specifies the number of rows of the matrix <samp class="codeph">op(<var>A</var>)</samp> and of the matrix <var>C</var>. The value of <span class="keyword">m</span> must be at least zero. </p>
</dd>
<dt class="dlterm"><span class="parmname">n</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>Specifies the number of columns of the matrix <samp class="codeph">op(<var>B</var>)</samp> and the number of columns of the matrix <var>C</var>.</p>
<p>The value of <var>n</var> must be at least zero.</p>
</dd>
<dt class="dlterm"><span class="parmname">k</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>Specifies the number of columns of the matrix <samp class="codeph">op(<var>A</var>)</samp> and the number of rows of the matrix <samp class="codeph">op(<var>B</var>)</samp>.</p>
<p>The value of <var>k</var> must be at least zero.</p>
</dd>
<dt class="dlterm"><span class="parmname">alpha</span></dt>

<dd><p><span class="keyword">COMPLEX</span> for <span class="option">cgemm3m</span></p>
<p><span class="keyword">DOUBLE COMPLEX</span> for <span class="option">zgemm3m</span></p>
<p>Specifies the scalar <var>alpha</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">a</span></dt>

<dd><p><span class="keyword">COMPLEX</span> for <span class="option">cgemm3m</span></p>
<p><span class="keyword">DOUBLE COMPLEX</span> for <span class="option">zgemm3m</span></p>
<p>Array, size <span class="parmname">lda</span> by <span class="parmname">ka</span>, where <span class="parmname">ka</span> is <span class="parmname">k</span> when <samp class="codeph"><span class="parmname">transa</span> = 'N'</samp> or <samp class="codeph">'n'</samp>, and is <span class="parmname">m</span> otherwise. Before entry with <samp class="codeph"><span class="parmname">transa</span> = 'N'</samp> or <samp class="codeph">'n'</samp>, the leading <span class="parmname">m</span>-by-<span class="parmname">k</span> part of the array <span class="parmname">a</span> must contain the matrix <var>A</var>, otherwise the leading <span class="parmname">k</span>-by-<span class="parmname">m</span> part of the array <span class="parmname">a</span> must contain the matrix <var>A</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">lda</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>Specifies the leading dimension of <var>a</var> as declared in the calling (sub)program. </p>
<p>When <samp class="codeph"><span class="parmname">transa</span> = 'N'</samp> or <samp class="codeph">'n'</samp>, then <span class="parmname">lda</span> must be at least <samp class="codeph">max(1, <span class="parmname">m</span>)</samp>, otherwise <span class="parmname">lda</span> must be at least <samp class="codeph">max(1, <span class="parmname">k</span>)</samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">b</span></dt>

<dd><p><span class="keyword">COMPLEX</span> for <span class="option">cgemm3m</span></p>
<p><span class="keyword">DOUBLE COMPLEX</span> for <span class="option">zgemm3m</span></p>
<p>Array, size <span class="parmname">ldb</span> by <span class="parmname">kb</span>, where <span class="parmname">kb</span> is <span class="parmname">n</span> when <samp class="codeph"><span class="parmname">transa</span> = 'N'</samp> or <samp class="codeph">'n'</samp>, and is <span class="parmname">k</span> otherwise. Before entry with <samp class="codeph"><span class="parmname">transa</span> = 'N'</samp> or <samp class="codeph">'n'</samp>, the leading <span class="parmname">k</span>-by-<span class="parmname">n</span> part of the array <span class="parmname">b</span> must contain the matrix <var>B</var>, otherwise the leading <span class="parmname">n</span>-by-<span class="parmname">k</span> part of the array <span class="parmname">b</span> must contain the matrix <var>B</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">ldb</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>Specifies the leading dimension of <var>b</var> as declared in the calling (sub)program. </p>
<p>When <span><samp class="codeph"><span class="parmname">transa</span> = 'N'</samp> or <samp class="codeph">'n'</samp></span>, then <span class="parmname">ldb</span> must be at least <samp class="codeph">max(1, <span class="parmname">k</span>)</samp>, otherwise <span class="parmname">ldb</span> must be at least <samp class="codeph">max(1, <span class="parmname">n</span>)</samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">beta</span></dt>

<dd><p><span class="keyword">COMPLEX</span> for <span class="option">cgemm3m</span></p>
<p><span class="keyword">DOUBLE COMPLEX</span> for <span class="option">zgemm3m</span></p>
<p>Specifies the scalar <var>beta</var>.</p>
<p>When <var>beta</var> is equal to zero, then <var>c</var> need not be set on input.</p>
</dd>
<dt class="dlterm"><span class="parmname">c</span></dt>

<dd><p><span class="keyword">COMPLEX</span> for <span class="option">cgemm3m</span></p>
<p><span class="keyword">DOUBLE COMPLEX</span> for <span class="option">zgemm3m</span></p>
<p>Array, size <span class="parmname">ldc</span> by <span class="parmname">n</span>. Before entry, the leading <span class="parmname">m</span>-by-<span class="parmname">n</span> part of the array <span class="parmname">c</span> must contain the matrix <var>C</var>, except when <span class="parmname">beta</span> is equal to zero, in which case <span class="parmname">c</span> need not be set on entry.</p>
</dd>
<dt class="dlterm"><span class="parmname">ldc</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>Specifies the leading dimension of <var>c</var> as declared in the calling (sub)program. </p>
<p>The value of <span class="parmname">ldc</span> must be at least <samp class="codeph">max(1, <span class="parmname">m</span>)</samp>. </p>
</dd>
</dl>
</div>
<div class="section" id="GUID-EB2E8312-8182-49E0-8984-CD0B7B43353D"><h2 class="sectiontitle">Output Parameters</h2><dl id="GUID-F16A26BC-13D3-4590-A4EE-B086F738683A"><dt class="dlterm"><span class="parmname">c</span></dt>

<dd><p>Overwritten by the <var>m</var>-by-<var>n</var> matrix <samp class="codeph">(<var>alpha</var>*op(<var>A</var>)*op(<var>B</var>) + <var>beta</var>*<var>C</var>)</samp>.</p>
</dd>
</dl>
</div>
<div class="section" id="GUID-BE8FC914-1F9A-485E-B6E3-143912312BFA"><h2 class="sectiontitle">BLAS 95 Interface Notes</h2><p>Routines in Fortran 95 interface have fewer arguments in the calling sequence than their FORTRAN 77   counterparts. For general conventions applied to skip redundant or reconstructible arguments, see <a class="allformats" href="GUID-90EE7236-20A4-4B7E-B942-0E00B0AAAE78.html#GUID-90EE7236-20A4-4B7E-B942-0E00B0AAAE78">BLAS 95 Interface Conventions</a>.</p>
<p>Specific details for the routine <span class="option">gemm3m</span> interface are the following:</p>
<dl id="GUID-0F384142-EB40-4AF2-B2F8-99CF19240440"><dt class="dlterm"><span class="parmname">a</span></dt>

<dd><p>Holds the matrix <var>A</var> of size (<var>ma</var>,<var>ka</var>) where </p>
<p><samp class="codeph"><var>ka</var> = <var>k</var></samp> if <samp class="codeph"><var>transa=</var><span class="keyword">'N'</span></samp>, </p>
<p><samp class="codeph"><var>ka</var> = <var>m</var></samp> otherwise,</p>
<p><samp class="codeph"><var>ma</var> = <var>m</var></samp> if <samp class="codeph"><var>transa=</var><span class="keyword">'N'</span></samp>, </p>
<p><samp class="codeph"><var>ma</var> = <var>k</var></samp> otherwise.</p>
</dd>
<dt class="dlterm"><span class="parmname">b</span></dt>

<dd><p>Holds the matrix <var>B</var> of size (<var>mb</var>,<var>kb</var>) where </p>
<p><samp class="codeph"><var>kb</var> = <var>n</var></samp> if <samp class="codeph"><var>transb</var> = <span class="keyword">'N'</span></samp>, </p>
<p><samp class="codeph"><var>kb</var> = <var>k</var></samp> otherwise, </p>
<p><samp class="codeph"><var>mb</var> = <var>k</var></samp> if <samp class="codeph"><var>transb</var> = <span class="keyword">'N'</span></samp>, </p>
<p><samp class="codeph"><var>mb</var> = <var>n</var></samp> otherwise.</p>
</dd>
<dt class="dlterm"><span class="parmname">c</span></dt>

<dd><p>Holds the matrix <var>C</var> of size (<var>m</var>,<var>n</var>).</p>
</dd>
<dt class="dlterm"><span class="parmname">transa</span></dt>

<dd><p>Must be <span class="keyword">'N'</span>, <span class="keyword">'C'</span>, or <span class="keyword">'T'</span>.</p>
<p>The default value is <span class="keyword">'N'</span>.</p>
</dd>
<dt class="dlterm"><span class="parmname">transb</span></dt>

<dd><p>Must be <span class="keyword">'N'</span>, <span class="keyword">'C'</span>, or <span class="keyword">'T'</span>.</p>
<p>The default value is <span class="keyword">'N'</span>.</p>
</dd>
<dt class="dlterm"><span class="parmname">alpha</span></dt>

<dd><p>The default value is 1.</p>
</dd>
<dt class="dlterm"><span class="parmname">beta</span></dt>

<dd><p>The default value is 1.</p>
</dd>
</dl>
</div>
<div class="section" id="APN_GEQRF"><h2 class="sectiontitle">Application Notes</h2><p>These routines perform a complex matrix multiplication by forming the real and imaginary parts of the input matrices. This uses  three real matrix multiplications and five real matrix additions instead of the conventional four real matrix multiplications and two real matrix additions. The use of three real matrix multiplications reduces the time spent in matrix operations by  25%, resulting in significant savings in compute time for large matrices. 
</p>
<p>If the errors in the floating point calculations satisfy the following conditions: </p>
<p><samp class="codeph"><var>fl</var>(<var>x</var> op <var>y</var>)=(<var>x</var> op <var>y</var>)(1+δ),|δ|≤<var>u</var>, op=×,/, <var>fl</var>(<var>x</var>±<var>y</var>)=<var>x</var>(1+α)±<var>y</var>(1+β), |α|,|β|≤<var>u</var></samp></p>
<p>then for an <var>n</var>-by-<var>n</var> matrix<samp class="codeph"><var>   Ĉ</var>=<var>fl</var>(<var>C</var><sub>1</sub>+<var>i</var><var>C</var><sub>2</sub>)= <var>fl</var>((<var>A</var><sub>1</sub>+<var>i</var><var>A</var><sub>2</sub>)(<var>B</var><sub>1</sub>+<var>i</var><var>B</var><sub>2</sub>))=<var>Ĉ</var><sub>1</sub>+<var>i</var><var>Ĉ</var><sub>2</sub></samp>, the following bounds are satisfied:</p>
<p><samp class="codeph">║<var>Ĉ</var><sub>1</sub>-<var>C</var><sub>1</sub>║≤
2(<var>n</var>+1)<var>u</var>║<var>A</var>║<sub>∞</sub>║<var>B</var>║<sub>∞</sub>+<var>O</var>(<var>u</var><sup>2</sup>)</samp>,</p>
<p><samp class="codeph">║<var>Ĉ</var><sub>2</sub>-<var>C</var><sub>2</sub>║≤
4(<var>n</var>+4)<var>u</var>║<var>A</var>║<sub>∞</sub>║<var>B</var>║<sub>∞</sub>+<var>O</var>(<var>u</var><sup>2</sup>)</samp>,</p>
<p>where <samp class="codeph">║<var>A</var>║<sub>∞</sub>=max(║<var>A</var><sub>1</sub>║<sub>∞</sub>,║<var>A</var><sub>2</sub>║<sub>∞</sub>)</samp>, and  <samp class="codeph">║<var>B</var>║<sub>∞</sub>=max(║<var>B</var><sub>1</sub>║<sub>∞</sub>,║<var>B</var><sub>2</sub>║<sub>∞</sub>)</samp>.</p>
<p>Thus the corresponding matrix multiplications  are stable.</p>
</div>
</div>

<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-723C9818-01C2-4825-912B-343F445DDB96.html">BLAS-like Extensions</a></div>
</div>
<div/>
</body>
</html>
