<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0016)http://localhost -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="DC.Type" content="FunctionRef"/>
<meta name="DC.Title" content="?laqr6"/>
<meta name="abstract" content="Performs a single small-bulge multi-shift QR sweep collecting the transformations."/>
<meta name="description" content="Performs a single small-bulge multi-shift QR sweep collecting the transformations."/>
<meta name="DC.subject" content="slaqr6, ScaLAPACK routines, auxiliary routines, dlaqr6"/>
<meta name="keywords" content="slaqr6, ScaLAPACK routines, auxiliary routines, dlaqr6"/>
<meta name="DC.Relation" scheme="URI" content="GUID-BF7438B3-BB55-478A-88DB-33C01481F990.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-97273960-E4A4-4016-8667-BE6A36156792.html#GUID-97273960-E4A4-4016-8667-BE6A36156792"/>
<meta name="DC.Relation" scheme="URI" content="http://www.intel.com/software/products/softwaredocs_feedback"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-F13F6758-335A-4F6F-BA48-252B87788DB9"/>
<meta name="DC.Language" content="en-US"/>
<link rel="stylesheet" type="text/css" href="intel_css_styles.css"/>
<title>?laqr6</title>

</head>
<body id="GUID-F13F6758-335A-4F6F-BA48-252B87788DB9">
 <!-- ==============(Start:NavScript)================= -->
 <script src="NavScript.js" language="JavaScript1.2" type="text/javascript"></script>
 <script language="JavaScript1.2" type="text/javascript">WriteNavLink(0);</script>
 <!-- ==============(End:NavScript)================= -->
<p id="header_text" style="margin-bottom : 20pt"><em>Intel&reg; oneAPI Math Kernel Library Developer Reference - Fortran</em></p>


<h1 class="topictitle1"><span class="option">?laqr6</span></h1>
<!--Performs a single small-bulge multi-shift QR
sweep collecting the transformations.--><div><p class="shortdesc">Performs a single small-bulge multi-shift QR
sweep collecting the transformations.</p>
<div class="section" id="GUID-FF0A60A0-94DD-48BB-8014-D6BF46A3C771"><h2 class="sectiontitle">Syntax</h2><dl class="dlsyntax"><p class="dlsyntaxpara"><span class="kwd">call slaqr6</span><span class="delim">(</span><span class="var"> job</span><span class="sep">, </span><span class="var">wantt</span><span class="sep">, </span><span class="var">wantz</span><span class="sep">, </span><span class="var">kacc22</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">ktop</span><span class="sep">, </span><span class="var">kbot</span><span class="sep">, </span><span class="var">nshfts</span><span class="sep">, </span><span class="var">sr</span><span class="sep">, </span><span class="var">si</span><span class="sep">, </span><span class="var">h</span><span class="sep">, </span><span class="var">ldh</span><span class="sep">, </span><span class="var">iloz</span><span class="sep">, </span><span class="var">ihiz</span><span class="sep">, </span><span class="var">z</span><span class="sep">, </span><span class="var">ldz</span><span class="sep">, </span><span class="var">v</span><span class="sep">, </span><span class="var">ldv</span><span class="sep">, </span><span class="var">u</span><span class="sep">, </span><span class="var">ldu</span><span class="sep">, </span><span class="var">nv</span><span class="sep">, </span><span class="var">wv</span><span class="sep">, </span><span class="var">ldwv</span><span class="sep">, </span><span class="var">nh</span><span class="sep">, </span><span class="var">wh</span><span class="sep">, </span><span class="var">ldwh </span><span class="delim">)</span></p><p class="dlsyntaxpara"><span class="kwd">call dlaqr6</span><span class="delim">(</span><span class="var"> job</span><span class="sep">, </span><span class="var">wantt</span><span class="sep">, </span><span class="var">wantz</span><span class="sep">, </span><span class="var">kacc22</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">ktop</span><span class="sep">, </span><span class="var">kbot</span><span class="sep">, </span><span class="var">nshfts</span><span class="sep">, </span><span class="var">sr</span><span class="sep">, </span><span class="var">si</span><span class="sep">, </span><span class="var">h</span><span class="sep">, </span><span class="var">ldh</span><span class="sep">, </span><span class="var">iloz</span><span class="sep">, </span><span class="var">ihiz</span><span class="sep">, </span><span class="var">z</span><span class="sep">, </span><span class="var">ldz</span><span class="sep">, </span><span class="var">v</span><span class="sep">, </span><span class="var">ldv</span><span class="sep">, </span><span class="var">u</span><span class="sep">, </span><span class="var">ldu</span><span class="sep">, </span><span class="var">nv</span><span class="sep">, </span><span class="var">wv</span><span class="sep">, </span><span class="var">ldwv</span><span class="sep">, </span><span class="var">nh</span><span class="sep">, </span><span class="var">wh</span><span class="sep">, </span><span class="var">ldwh </span><span class="delim">)</span></p></dl></div>
<div class="section" id="GUID-8ECC7F8C-9C50-4EB2-B51D-33C46628D8E1"><h2 class="sectiontitle">Description</h2><p>This auxiliary <span>subroutine called by <a href="GUID-84DE0984-4809-46E4-B6C0-6629E85D5EF9.html"><span class="option">p?laqr5</span></a></span> performs a single small-bulge multi-shift QR sweep, moving the chain of bulges from top to bottom in the submatrix <var>H</var>(<span class="parmname">ktop</span>:<span class="parmname">kbot</span>,<span class="parmname">ktop</span>:<span class="parmname">kbot</span>), collecting the transformations in the matrix <var>V </var><em>or</em> accumulating the transformations in the matrix <var>Z</var> (see below). </p>
<p>This is a modified version of <a href="GUID-45CD5B1E-F83E-4A7B-B490-7EEB822BEB19.html"><span class="option">?laqr5</span></a> from LAPACK 3.1. </p>
</div>
<div class="section" id="GUID-C7EC25EF-B9F2-435A-A54E-7563277C6617"><h2 class="sectiontitle">Input Parameters</h2><dl id="GUID-EE38D079-73B8-4FF4-93F0-9F5871EA88E8"><dt class="dlterm"><span class="parmname">job</span></dt>

<dd><p><span class="keyword">CHARACTER</span> scalar</p>
<p>Set the kind of job to do in <span class="option">?laqr6</span>, as follows:</p>
<p><span class="parmname">job</span> = 'I': Introduce and chase bulges in submatrix</p>
<p><span class="parmname">job</span> = 'C': Chase bulges from top to bottom of submatrix</p>
<p><span class="parmname">job</span> = 'O': Chase bulges off submatrix</p>
</dd>
<dt class="dlterm"><span class="parmname">wantt</span></dt>

<dd><p><span class="keyword">LOGICAL</span> scalar</p>
<p><span class="parmname">wantt</span><span class="keyword">= .TRUE.</span> if the quasi-triangular Schur factor is being computed.  <span class="parmname">wantt</span> is set to <span class="keyword">.FALSE.</span> otherwise.</p>
</dd>
<dt class="dlterm"><span class="parmname">wantz</span></dt>

<dd><p><span class="keyword">LOGICAL</span> scalar</p>
<p><span class="parmname">wantz</span><span class="keyword">= .TRUE.</span> if the orthogonal Schur factor is being computed.  <span class="parmname">wantz</span> is set to <span class="keyword">.FALSE.</span> otherwise.</p>
</dd>
<dt class="dlterm"><span class="parmname">kacc22</span></dt>

<dd><p><span class="keyword">INTEGER</span> with value 0, 1, or 2.</p>
<p>Specifies the computation mode of far-from-diagonal orthogonal updates.</p>
<p>= 0: <span class="option">?laqr6</span> does not accumulate reflections and does not use matrix-matrix multiply to update far-from-diagonal matrix entries.</p>
<p>= 1: <span class="option">?laqr6</span> accumulates reflections and uses matrix-matrix multiply to update the far-from-diagonal matrix entries.</p>
<p>= 2: <span class="option">?laqr6</span> accumulates reflections, uses matrix-matrix multiply to update the far-from-diagonal matrix entries, and takes advantage of 2-by-2 block structure during matrix multiplies.</p>
</dd>
<dt class="dlterm"><span class="parmname">n</span></dt>

<dd><p><span class="keyword">INTEGER</span> scalar</p>
<p><span class="parmname">n</span> is the order of the Hessenberg matrix <var>H</var> upon which this <span>subroutine </span>operates.</p>
</dd>
<dt class="dlterm"><span class="parmname">ktop</span>, <span class="parmname">kbot</span></dt>

<dd><p><span class="keyword">INTEGER</span> scalar</p>
<p>These are the first and last rows and columns of an isolated diagonal block upon which the QR sweep is to be applied. It is assumed without a check that either <span class="parmname">ktop</span> = 1  or   <var>H</var>(<span class="parmname">ktop</span>,<span class="parmname">ktop</span>-1) = 0 and either <span class="parmname">kbot</span> = <span class="parmname">n</span>  or   <span class="parmname"/><var>H</var>(<span class="parmname">kbot</span>+1,<span class="parmname">kbot</span>) = 0.</p>
</dd>
<dt class="dlterm"><span class="parmname">nshfts</span></dt>

<dd><p><span class="keyword">INTEGER</span> scalar</p>
<p><span class="parmname">nshfts</span> gives the number of simultaneous shifts.  <span class="parmname">nshfts</span> must be positive and even.</p>
</dd>
<dt class="dlterm"><span class="parmname">sr</span>, <span class="parmname">si</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">slaqr6</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dlaqr6</span></p>
<p>Array of size <span class="parmname">nshfts</span></p>
<p><span class="parmname">sr</span> contains the real parts and <span class="parmname">si</span> contains the imaginary parts of the <span class="parmname">nshfts</span> shifts of origin that define the multi-shift QR sweep.</p>
</dd>
<dt class="dlterm"><span class="parmname">h</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">slaqr6</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dlaqr6</span></p>
<p>             Array of size <span>(<span class="parmname">ldh</span>,<span class="parmname">n</span>)</span></p>
<p>On input <span class="parmname">h</span> contains a Hessenberg matrix .  </p>
</dd>
<dt class="dlterm"><span class="parmname">ldh</span></dt>

<dd><p><span class="keyword">INTEGER</span> scalar</p>
<p><span class="parmname">ldh</span> is the leading dimension of <span class="parmname"/><var>H</var> just as declared in the calling <span>procedure</span>.  <span class="parmname">ldh</span><span class="eqsymbol">≥</span> max(1,<span class="parmname">n</span>).</p>
</dd>
<dt class="dlterm"><span class="parmname">iloz</span>, <span class="parmname">ihiz</span></dt>

<dd><p><span class="keyword">INTEGER</span> scalar</p>
<p>Specify the rows of <span class="parmname">z </span>to which transformations must be applied if <span class="parmname">wantz</span><span>is <span class="keyword">.TRUE.</span></span>. 1<span class="eqsymbol">≤</span><span class="parmname">iloz</span><span class="eqsymbol">≤</span><span class="parmname">ihiz</span><span class="eqsymbol">≤</span><span class="parmname">n</span></p>
</dd>
<dt class="dlterm"><span class="parmname">z</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">slaqr6</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dlaqr6</span></p>
<p>Array of size <span>(<span class="parmname">ldz</span>,<span class="parmname">ktop</span>)</span></p>
<p>If <span class="parmname">wantz</span><span class="keyword">= .TRUE.</span>, then the QR sweep orthogonal similarity transformation is accumulated into the matrix <var>Z</var>(<span class="parmname">iloz</span>:<span class="parmname">ihiz</span>,<span class="parmname">kbot</span>:<span class="parmname">ktop</span>), stored in the array <span class="parmname">z</span>, from the right.</p>
<p>If <span class="parmname">wantz</span><span class="keyword">= .FALSE.</span>, then <span class="parmname">z</span> is unreferenced.</p>
</dd>
<dt class="dlterm"><span class="parmname">ldz</span></dt>

<dd><p><span class="keyword">INTEGER</span> scalar</p>
<p><span class="parmname">ldz</span> is the leading dimension of <span class="parmname">z</span> just as declared in the calling <span>procedure</span>. <span class="parmname">ldz</span><span class="eqsymbol">≥</span><span class="parmname">n</span>.</p>
</dd>
<dt class="dlterm"><span class="parmname">v</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">slaqr6</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dlaqr6</span></p>
<p>(workspace)              array of size <span>(<span class="parmname">ldv</span>,<span class="parmname">nshfts</span>/2)</span></p>
</dd>
<dt class="dlterm"><span class="parmname">ldv</span></dt>

<dd><p><span class="keyword">INTEGER</span> scalar</p>
<p><span class="parmname">ldv</span> is the leading dimension of <span class="parmname">v</span> as declared in the calling <span>procedure</span>.  <span class="parmname">ldv</span><span class="eqsymbol">≥</span>3.</p>
</dd>
<dt class="dlterm"><span class="parmname">u</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">slaqr6</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dlaqr6</span></p>
<p>(workspace)              array of size <span>(<span class="parmname">ldu</span>,3*<span class="parmname">nshfts</span>-3)</span></p>
</dd>
<dt class="dlterm"><span class="parmname">ldu</span></dt>

<dd><p><span class="keyword">INTEGER</span> scalar</p>
<p><span class="parmname">ldu</span> is the leading dimension of <span class="parmname">u</span> just as declared in the calling <span>subroutine</span>.  <span class="parmname">ldu</span><span class="eqsymbol">≥</span>3*<span class="parmname">nshfts</span>-3.</p>
</dd>
<dt class="dlterm"><span class="parmname">nh</span></dt>

<dd><p><span class="keyword">INTEGER</span> scalar</p>
<p><span class="parmname">nh</span> is the number of columns in array <span class="parmname">wh</span> available for workspace. <span class="parmname">nh</span><span class="eqsymbol">≥</span>1 is required for usage of this workspace, otherwise the updates of the far-from-diagonal elements will be updated without level 3 BLAS.</p>
</dd>
<dt class="dlterm"><span class="parmname">wh</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">slaqr6</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dlaqr6</span></p>
<p>(workspace)             array of size <span>(<span class="parmname">ldwh</span>,<span class="parmname">nh</span>)</span></p>
</dd>
<dt class="dlterm"><span class="parmname">ldwh</span></dt>

<dd><p><span class="keyword">INTEGER</span> scalar</p>
<p>Leading dimension of <span class="parmname">wh</span> just as declared in the calling <span>procedure</span>.  <span class="parmname">ldwh</span><span class="eqsymbol">≥</span>3*<span class="parmname">nshfts</span>-3.</p>
</dd>
<dt class="dlterm"><span class="parmname">nv</span></dt>

<dd><p><span class="keyword">INTEGER</span> scalar</p>
<p><span class="parmname">nv</span> is the number of rows in <span class="parmname">wv</span> available for workspace. <span class="parmname">nv</span><span class="eqsymbol">≥</span>1 is required for usage of this workspace, otherwise the updates of the far-from-diagonal elements will be updated without level 3 BLAS.</p>
</dd>
<dt class="dlterm"><span class="parmname">wv</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">slaqr6</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dlaqr6</span></p>
<p>(workspace)              array of size <span>(<span class="parmname">ldwv</span>,3*<span class="parmname">nshfts</span>-3)</span></p>
</dd>
<dt class="dlterm"><span class="parmname">ldwv</span></dt>

<dd><p><span class="keyword">INTEGER</span> scalar</p>
<p><span class="parmname">ldwv</span> is the leading dimension of <span class="parmname">wv</span> as declared in the in the calling <span>subroutine</span>.  <span class="parmname">ldwv</span><span class="eqsymbol">≥</span><span class="parmname">nv</span>.</p>
</dd>
</dl>
</div>
<div class="section" id="GUID-E4942579-CEDB-417A-AA73-F509163229BA"><h2 class="sectiontitle">OUTPUT Parameters</h2><dl id="GUID-7849B652-6A51-4CEC-BA14-F8098A7574FF"><dt class="dlterm"><span class="parmname">h</span></dt>

<dd><p>A multi-shift QR sweep with shifts <span><span class="parmname">sr</span>(<var>j</var>)+<var>i</var>*<span class="parmname">si</span>(<var>j</var>)</span> is applied to the isolated diagonal block in rows and columns <span class="parmname">ktop</span> through <span class="parmname">kbot</span>.</p>
</dd>
<dt class="dlterm"><span class="parmname">z</span></dt>

<dd><p> If <span class="parmname">wantz</span><span>is <span class="keyword">.TRUE.</span></span>, then the
QR sweep orthogonal/unitary similarity transformation is accumulated into
the matrix <var>Z</var>(<span class="parmname">iloz</span>:<span class="parmname">ihiz</span>,<span class="parmname">kbot</span>:<span class="parmname">ktop</span>) from the right.</p>
<p> If <span class="parmname">wantz</span><span>is <span class="keyword">.FALSE.</span></span>, then <span class="parmname">z</span> is
unreferenced. </p>
</dd>
</dl>
</div>
<div class="section" id="GUID-48588599-DE7C-4F49-ABBE-A962490ABEEA"><h2 class="sectiontitle">Application Notes</h2><p>Notes</p>
<p>Based on contributions by Karen Braman and Ralph Byers, Department of Mathematics, University of Kansas, USA Robert Granat, Department of Computing Science and HPC2N, Umea University, Sweden </p>
</div>
</div>

<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-BF7438B3-BB55-478A-88DB-33C01481F990.html">ScaLAPACK Auxiliary Routines</a></div>
</div>
<div class="See Also"><h2>See Also</h2>
<div class="linklist">
<div><a href="GUID-97273960-E4A4-4016-8667-BE6A36156792.html#GUID-97273960-E4A4-4016-8667-BE6A36156792">Overview</a> for details of ScaLAPACK  array descriptor structures and related notations.</div></div></div>
</body>
</html>
