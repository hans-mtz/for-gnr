<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0016)http://localhost -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="DC.Type" content="FunctionRef"/>
<meta name="DC.Title" content="gemm_*_compute"/>
<meta name="abstract" content="Computes a matrix-matrix product with general integer matrices (where one or both input matrices are stored in a packed data structure) and adds the result to a scalar-matrix product."/>
<meta name="description" content="Computes a matrix-matrix product with general integer matrices (where one or both input matrices are stored in a packed data structure) and adds the result to a scalar-matrix product."/>
<meta name="DC.subject" content="sgemm_compute, dgemm_compute"/>
<meta name="keywords" content="sgemm_compute, dgemm_compute"/>
<meta name="DC.Relation" scheme="URI" content="GUID-723C9818-01C2-4825-912B-343F445DDB96.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-8F12581B-B0ED-49F5-8061-B84AD89F39C4.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-16188573-1301-4078-8837-95670AF6FF48.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-964535E4-74AC-4612-81D3-11D6F5B89CBA"/>
<meta name="DC.Language" content="en-US"/>
<link rel="stylesheet" type="text/css" href="intel_css_styles.css"/>
<title>gemm_*_compute</title>

</head>
<body id="GUID-964535E4-74AC-4612-81D3-11D6F5B89CBA">
 <!-- ==============(Start:NavScript)================= -->
 <script src="NavScript.js" language="JavaScript1.2" type="text/javascript"></script>
 <script language="JavaScript1.2" type="text/javascript">WriteNavLink(0);</script>
 <!-- ==============(End:NavScript)================= -->
<p id="header_text" style="margin-bottom : 20pt"><em>Intel&reg; oneAPI Math Kernel Library Developer Reference - Fortran</em></p>


<h1 class="topictitle1"><span class="option">gemm_*_compute</span></h1>
<!--Computes a matrix-matrix product with general integer matrices (where one or both input matrices are stored in a packed data structure) and adds the result to a scalar-matrix product.--><div><p class="shortdesc">Computes a matrix-matrix product with general integer matrices (where one or both input matrices are stored in a packed data structure) and adds the result to a scalar-matrix product.</p>
<div class="section" id="GUID-F29E2C33-FEE1-4E32-A562-CDBF960736F6"><h2 class="sectiontitle">Syntax</h2><dl class="dlsyntax"><p class="dlsyntaxpara"><span class="kwd">call gemm_s8u8s32_compute</span><span class="delim"> (</span><span class="var">transa</span><span class="sep">, </span><span class="var">transb</span><span class="sep">, </span><span class="var">offsetc</span><span class="sep">, </span><span class="var">m</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">k</span><span class="sep">, </span><span class="var">alpha</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">lda</span><span class="sep">, </span><span class="var">oa</span><span class="sep">, </span><span class="var">b</span><span class="sep">, </span><span class="var">ldb</span><span class="sep">, </span><span class="var">ob</span><span class="sep">, </span><span class="var">beta</span><span class="sep">, </span><span class="var">c</span><span class="sep">, </span><span class="var">ldc</span><span class="sep">, </span><span class="var">oc</span><span class="delim">)</span></p><p class="dlsyntaxpara"><span class="kwd">call gemm_s16s16s32_compute</span><span class="delim"> (</span><span class="var">transa</span><span class="sep">, </span><span class="var">transb</span><span class="sep">, </span><span class="var">offsetc</span><span class="sep">, </span><span class="var">m</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">k</span><span class="sep">, </span><span class="var">alpha</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">lda</span><span class="sep">, </span><span class="var">oa</span><span class="sep">, </span><span class="var">b</span><span class="sep">, </span><span class="var">ldb</span><span class="sep">, </span><span class="var">ob</span><span class="sep">, </span><span class="var">beta</span><span class="sep">, </span><span class="var">c</span><span class="sep">, </span><span class="var">ldc</span><span class="sep">, </span><span class="var">oc</span><span class="delim">)</span></p></dl></div>
<div class="section" id="GUID-43A72B70-DEC8-4931-9CA2-42E87C54169C"><h2 class="sectiontitle">Include Files</h2><ul id="GUID-9591982E-0D7F-4215-B3F5-2455C194D4D7"><li><span class="filepath">mkl.fi</span></li>
</ul>
</div>
<div class="section" id="GUID-3C76C7A4-F916-4D99-A3EB-67F5FE139DCF"><h2 class="sectiontitle">Description</h2><p> The <span class="option">gemm_*_compute</span> routine is one of a set of related routines
that enable use of an internal packed storage.
After calling  <span class="option">gemm_*_pack</span> call  <span class="option">gemm_*_compute</span> to compute</p>
<p id="GEMM_OP"><samp class="codeph"><var>C</var> := <var>alpha</var>*(op(<var>A</var>) + <var>A_offset</var>)*(op(<var>B</var>) + <var>B_offset</var>) + <var>beta</var>*<var>C</var> + <var>C_offset</var></samp>,</p>
<p id="GEMM_LIST"> where:<ul class="simple"><li><samp class="codeph"> op(<var>X</var>)</samp> is either <samp class="codeph"> op(<var>X</var>) = <var>X</var></samp> or  <samp class="codeph"> op(<var>X</var>) = <var>X</var><sup>T</sup></samp></li>
<li><var>alpha</var> and <var>beta</var>are scalars</li>
<li><var>A</var> , <var>B</var>, and
<var>C</var> are matrices:</li>
<li><samp class="codeph"> op(<var>A</var>)</samp> is an <span class="parmname">m</span>-by-<span class="parmname">k</span>
matrix,</li>
<li><samp class="codeph"> op(<var>B</var>)</samp> is a <span class="parmname">k</span>-by-<span class="parmname">n</span>
matrix,</li>
<li><var>C</var> is an
<span class="parmname">m</span>-by-<span class="parmname">n</span> matrix.</li>
<li><var>A_offset</var> is an
<span class="parmname">m</span>-by-<span class="parmname">k</span> matrix with every element equal to the value <span class="keyword">oa</span>.</li>
<li><var>B_offset</var> is an
<span class="parmname">k</span>-by-<span class="parmname">n</span> matrix with every element equal to the value <span class="keyword">ob</span>.</li>
<li><var>C_offset</var> is an
<span class="parmname">m</span>-by-<span class="parmname">n</span> matrix defined by the <span class="keyword">oc</span> array as described in the description of the <span class="parmname">offsetc</span> parameter.</li>
</ul>
</p>
<div class="Note"><h3 class="NoteTipHead">Note</h3> <p> For best performance, use the same number of threads for packing and for computing.</p>
<p>If you are packing for both <var>A</var> and <var>B</var> matrices, you must use the same number of threads for packing <var>A</var> as for packing <var>B</var>.</p>
</div>
</div>
<div class="section" id="GUID-150ED248-A07F-406B-B294-83E03B272302"><h2 class="sectiontitle">Input Parameters</h2><table cellspacing="0" cellpadding="4" border="0" width="90%" style="border-spacing:0; border-collapse:collapse"><tr><td valign="top" class="noborder" width="10%"><p><span class="parmname">transa</span></p></td>

<td valign="top" class="noborder"><p><span><span class="keyword">CHARACTER*1</span>. </span>Specifies the form of <samp class="codeph">op(<var>A</var>)</samp> used in the packing:</p>
<p>If <span class="parmname">transa</span> = <span><samp class="codeph">'N'</samp> or <samp class="codeph">'n'</samp></span>  <samp class="codeph">op(<var>A</var>) = <var>A</var></samp>.</p>
<p>If <span class="parmname">transa</span> = <span><samp class="codeph">'T'</samp> or <samp class="codeph">'t'</samp></span>  <samp class="codeph">op(<var>A</var>) = <var>A</var><sup>T</sup></samp>.</p>
<p>If <span class="parmname">transa</span> = <span><samp class="codeph">'P'</samp> or <samp class="codeph">'p'</samp></span> the matrix in array <span class="parmname">a</span>is packed into a format internal to Intel&reg; oneAPI Math Kernel Library and<span class="parmname">lda</span> is ignored.</p>
</td>
</tr><tr><td valign="top" class="noborder" width="10%"><p><span class="parmname">transb</span></p></td>

<td valign="top" class="noborder"><p><span><span class="keyword">CHARACTER*1</span>. </span> Specifies the form of <samp class="codeph">op(<var>B</var>)</samp> used in the packing:</p>
<p>If <span class="parmname">transb</span> = <span><samp class="codeph">'N'</samp> or <samp class="codeph">'n'</samp></span>  <samp class="codeph">op(<var>B</var>) = <var>B</var></samp>.</p>
<p>If <span class="parmname">transb</span> = <span><samp class="codeph">'T'</samp> or <samp class="codeph">'t'</samp></span><samp class="codeph"> op(<var>B</var>) = <var>B</var><sup>T</sup></samp>.</p>
<p>If <span class="parmname">transb</span> = <span><samp class="codeph">'P'</samp> or <samp class="codeph">'p'</samp></span> the matrix in array <span class="parmname">b</span>is packed into a format internal to Intel&reg; oneAPI Math Kernel Library and<span class="parmname">ldb</span> is ignored.</p>
</td>
</tr><tr><td valign="top" class="noborder" width="10%"><p><span class="parmname">offsetc</span></p></td>

<td valign="top" class="noborder"><p><span><span class="keyword">CHARACTER*1</span>. </span> Specifies the form of <var>C_offset</var> used in the matrix multiplication.</p>
<p>If <span class="parmname">offsetc</span>=<span><samp class="codeph">'F'</samp> or <samp class="codeph">'f'</samp></span>  :<samp class="codeph">oc</samp> has a single element and every element of <var>C_offset</var> is equal to this element.</p>
<p>If <span class="parmname">offsetc</span>=<span><samp class="codeph">'C'</samp> or <samp class="codeph">'c'</samp></span> :<samp class="codeph">oc</samp> has a size of <span class="parmname">m</span> and every element of <var>C_offset</var> is equal to <samp class="codeph">oc</samp>.</p>
<p>If <span class="parmname">offsetc</span>=<span><samp class="codeph">'R'</samp> or <samp class="codeph">'r'</samp></span> :<samp class="codeph">oc</samp> has a size of <span class="parmname">n</span> and every element of <var>C_offset</var> is equal to <samp class="codeph">oc</samp>.</p>
</td>
</tr><tr><td valign="top" class="noborder" width="10%"><p><span class="parmname">m</span></p></td>

<td valign="top" class="noborder"><p><span><span class="keyword">INTEGER</span>. </span>Specifies the number of rows of the matrix <samp class="codeph">op(<var>A</var>)</samp> and of the matrix <var>C</var>. The value of <span class="parmname">m</span> must be at least zero.</p>
</td>
</tr><tr><td valign="top" class="noborder" width="10%"><p><span class="parmname">n</span></p></td>

<td valign="top" class="noborder"><p><span><span class="keyword">INTEGER</span>. </span>Specifies the number of columns of the matrix <samp class="codeph">op(<var>B</var>)</samp> and the number of columns of the matrix <var>C</var>.  The value of <span class="parmname">n</span> must be at least zero.</p>
</td>
</tr><tr><td valign="top" class="noborder" width="10%"><p><span class="parmname">k</span></p></td>

<td valign="top" class="noborder"><p><span><span class="keyword">INTEGER</span>. </span>Specifies the number of columns of the matrix <samp class="codeph">op(<var>A</var>)</samp> and the number of rows of the matrix <samp class="codeph">op(<var>B</var>)</samp>.  The value of <span class="parmname">k</span> must be at least zero.</p>
</td>
</tr><tr><td valign="top" class="noborder" width="10%"><p><span class="parmname">alpha</span></p></td>

<td valign="top" class="noborder"><p><span><span class="keyword">REAL</span>. </span>Specifies the scalar <var>alpha</var>.</p>
</td>
</tr><tr><td valign="top" class="noborder" width="10%"><p><span class="parmname">a</span></p></td>

<td valign="top" class="noborder"><p><span class="keyword">INTEGER*1</span> for <span class="option">gemm_s8u8s32_compute</span></p>
<p><span class="keyword">INTEGER*2</span> for <span class="option">gemm_s16s16s32_compute</span></p>
<p/>
<p/>
<table cellpadding="4" cellspacing="0" summary="" border="1" class="simpletableborder"><tr><td valign="top"><p><span class="parmname">transa</span> = <samp class="codeph">'N'</samp> or <samp class="codeph">'n'</samp></p>
</td>
<td valign="top"><p><span class="parmname">transa</span> = <samp class="codeph">'T'</samp>, <samp class="codeph">'t'</samp></p>
</td>
<td valign="top"><p><span class="parmname">transa</span> = <samp class="codeph">'P'</samp> or <samp class="codeph">'p'</samp></p>
</td>
</tr>
<tr><td valign="top"><p>Array, size <samp class="codeph"><span class="parmname">lda</span>*<span class="parmname">k</span></samp>.</p>
<p>Before entry, the leading <span class="parmname">m</span>-by-<span class="parmname">k</span> part of the array <span class="parmname">a</span> must contain the matrix <var>A</var>.</p>
</td>
<td valign="top"><p>Array, size <samp class="codeph"><span class="parmname">lda</span>*<span class="parmname">m</span></samp>.</p>
<p>Before entry, the leading <span class="parmname">k</span>-by-<span class="parmname">m</span> part of the array <span class="parmname">a</span> must contain the matrix <var>A</var>.</p>
</td>
<td valign="top"><p>Array of size returned by <span class="option">gemm_*_pack_get_size</span> and initialized using <span class="option">gemm_*_pack</span></p>
</td>
</tr>
</table>
</td>
</tr><tr><td valign="top" class="noborder" width="10%"><p><span class="parmname">lda</span></p></td>

<td valign="top" class="noborder"><p><span><span class="keyword">INTEGER</span>. </span>Specifies the leading dimension of <span class="parmname">a</span> as declared in the calling (sub)program.</p>
<p>If <span class="parmname">transa</span> = <samp class="codeph">'N'</samp> or <samp class="codeph">'n'</samp>, <span class="parmname">lda</span> must be at least <samp class="codeph">max (1, <span class="parmname">m</span>)</samp>.</p>
<p>If <span class="parmname">transa</span> = <samp class="codeph">'T'</samp>, <samp class="codeph">'t'</samp>, <span class="parmname">lda</span> must be at least <samp class="codeph">max (1, <span class="parmname">k</span>)</samp>.</p>
</td>
</tr><tr><td valign="top" class="noborder" width="10%"><p><span class="parmname">oa</span></p></td>

<td valign="top" class="noborder"><p/>
<p/>
<p><span>INTEGER*1 for <samp class="codeph">gemm_s8u8s32_compute</samp></span></p>
<p><span>INTEGER*2 for <samp class="codeph">gemm_s16s16s32_compute</samp></span></p>
<p>Specifies the scalar offset value for the matrix <var>A</var>.</p>
</td>
</tr><tr><td valign="top" class="noborder" width="10%"><p><span class="parmname">b</span></p></td>

<td valign="top" class="noborder"><p>INTEGER*1 for <samp class="codeph">gemm_s8u8s32_compute</samp></p>
<p>INTEGER*2 for <samp class="codeph">gemm_s16s16s32_compute</samp></p>
<p/>
<p/>
<table cellpadding="4" cellspacing="0" summary="" border="1" class="simpletableborder"><tr><td valign="top"><p><span class="parmname">transb</span> = <samp class="codeph">'N'</samp> or <samp class="codeph">'n'</samp></p>
</td>
<td valign="top"><p><span class="parmname">transb</span> = <samp class="codeph">'T'</samp>, <samp class="codeph">'t'</samp></p>
</td>
<td valign="top"><p><span class="parmname">transb</span> = <samp class="codeph">'P'</samp> or <samp class="codeph">'p'</samp></p>
</td>
</tr>
<tr><td valign="top"><p>Array, size <samp class="codeph"><span class="parmname">ldb</span>*<span class="parmname">n</span></samp>.</p>
<p>Before entry, the leading <span class="parmname">k</span>-by-<span class="parmname">n</span> part of the array <span class="parmname">b</span> must contain the matrix <var>B</var>.</p>
</td>
<td valign="top"><p>Array, size  <samp class="codeph"><span class="parmname">ldb</span>*<span class="parmname">k</span></samp>.</p>
<p>Before entry, the leading <span class="parmname">n</span>-by-<span class="parmname">k</span> part of the array <span class="parmname">b</span> must contain the matrix <var>B</var>.</p>
</td>
<td valign="top"><p>Array of size returned by <span class="option">gemm_*_pack_get_size</span> and initialized using <span class="option">gemm_*_pack</span></p>
</td>
</tr>
</table>
</td>
</tr><tr><td valign="top" class="noborder" width="10%"><p><span class="parmname">ldb</span></p></td>

<td valign="top" class="noborder"><p><span><span class="keyword">INTEGER</span>. </span> Specifies the leading dimension of <span class="parmname">b</span> as declared in the calling (sub)program.</p>
<p>If <span class="parmname">transb</span> = <samp class="codeph">'N'</samp> or <samp class="codeph">'n'</samp>, <span class="parmname">ldb</span> must be at least <samp class="codeph">max (1, <span class="parmname">k</span>)</samp>.</p>
<p>If <span class="parmname">transb</span> = <samp class="codeph">'T'</samp>, <samp class="codeph">'t'</samp>, <samp class="codeph">'C'</samp>, or <samp class="codeph">'c'</samp>, <span class="parmname">ldb</span> must be at least <samp class="codeph">max (1, <span class="parmname">n</span>)</samp>.</p>
</td>
</tr><tr><td valign="top" class="noborder" width="10%"><p><span class="parmname">ob</span></p></td>

<td valign="top" class="noborder"><p/>
<p/>
<p><span>INTEGER*1 for <samp class="codeph">gemm_s8u8s32_compute</samp></span></p>
<p><span>INTEGER*2 for <samp class="codeph">gemm_s16s16s32_compute</samp></span></p>
<p>Specifies the scalar offset value for the matrix <var>B</var>.</p>
</td>
</tr><tr><td valign="top" class="noborder" width="10%"><p><span class="parmname">beta</span></p></td>

<td valign="top" class="noborder"><p><span class="keyword">REAL</span></p>
<p>Specifies the scalar <var>beta</var>.</p>
</td>
</tr><tr><td valign="top" class="noborder" width="10%"><p><span class="parmname">c</span></p></td>

<td valign="top" class="noborder"><p><span class="keyword">INTEGER*4</span></p>
<p>Array, size <span class="parmname">ldc</span> by <span class="parmname">n</span>.  Before entry, the leading <span class="parmname">m</span>-by-<span class="parmname">n</span> part of the array <span class="parmname">c</span> must contain the matrix <var>C</var>, except when <span class="parmname">beta</span> is equal to zero, in which case <span class="parmname">c</span> need not be set on entry.</p>
</td>
</tr><tr><td valign="top" class="noborder" width="10%"><p><span class="parmname">ldc</span></p></td>

<td valign="top" class="noborder"><p><span><span class="keyword">INTEGER</span>. </span> Specifies the leading dimension of <span class="parmname">c</span> as declared in the calling (sub)program.</p>
<p>The value of <span class="parmname">ldc</span> must be at least <samp class="codeph">max (1, <span class="parmname">m</span>)</samp>.</p>
</td>
</tr><tr><td valign="top" class="noborder" width="10%"><p><span class="parmname">oc</span></p></td>

<td valign="top" class="noborder"><p><span>INTEGER*4 </span></p>
<p>Array, size <samp class="codeph">len</samp>. Specifies the scalar offset value for the matrix <var>C</var>.</p>
<p>If <samp class="codeph">offsetc</samp> =  <samp class="codeph">'F' or 'f'</samp>, <samp class="codeph">len</samp> must be at least 1.</p>
<p>If <samp class="codeph">offsetc</samp> =  <samp class="codeph">'C' or 'c'</samp>, <samp class="codeph">len</samp> must be at least <samp class="codeph">max(1, <span class="parmname">m</span>)</samp>.</p>
<p>If <samp class="codeph">offsetc</samp> =  <samp class="codeph">'R' or 'r'</samp>, <samp class="codeph">len</samp> must be at least <samp class="codeph">max(1, <span class="parmname">n</span>)</samp>.</p>
</td>
</tr></table></div>
<div class="section" id="GUID-E47B95D9-54BB-4D29-BC7B-CC9474D2FB79"><h2 class="sectiontitle">Output Parameters</h2><table cellspacing="0" cellpadding="4" border="0" width="90%" style="border-spacing:0; border-collapse:collapse"><tr><td valign="top" width="30%" class="noborder"><p><span class="parmname">c</span></p></td>

<td valign="top" class="noborder"><p><span>INTEGER*4 </span></p>
<p>Overwritten by the matrix <var>alpha</var>*(<samp class="codeph">op(<var>A</var>) + <var>A_offset</var>)*(op(<var>B</var>) + <var>B_offset</var>) + <var>beta</var>*<var>C</var> + <var>C_offset</var></samp>.</p>
</td>
</tr></table></div>
<div class="section" id="GUID-AD5735A2-E79E-4F56-B17F-7514B85F3513"><h2 class="sectiontitle">Example</h2><p>See the following examples in the MKL installation directory to understand the use of these routines:</p>
<p> gemm_s8u8s32_compute: examples\blas\source\gemm_s8u8s32_computex.f
</p>
<p> gemm_s16s16s32_compute: examples\blas\source\gemm_s16s16s32_computex.f
</p>
</div>
<div class="section" id="GUID-7542C5FE-FE06-48C1-980F-362D01851F74"><h2 class="sectiontitle">Application Notes</h2><p>You can expand the matrix-matrix product in this manner:</p>
<p><samp class="codeph">(op(<var>A</var>) + <var>A_offset</var>)*(op(<var>B</var>) + <var>B_offset</var>) = op(<var>A</var>)*op(<var>B</var>) + op(<var>A</var>)*<var>B_offset</var> + <var>A_offset</var>*op(<var>B</var>) + <var>A_offset</var>*<var>B_offset</var></samp></p>
<p>After computing these four multiplication terms separately, they
are summed from left to right. The results from the matrix-matrix
product and the  <var>C</var> matrix are scaled with
 <var>alpha</var> and  <var>beta</var>
floating-point values respectively using double-precision
arithmetic. Before storing the results to the output  <var>c</var> array, the floating-point values are rounded
to the nearest integers. </p>
<p>In the event of overflow or underflow, the
results depend on the architecture. The results are either
unsaturated (wrapped) or saturated to maximum or minimum
representable integer values for the data type of the output
matrix.</p>
</div>
</div>

<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-723C9818-01C2-4825-912B-343F445DDB96.html">BLAS-like Extensions</a></div>
</div>
<div class="See Also"><h2>See Also</h2>
<div class="linklist">
<div><a href="GUID-8F12581B-B0ED-49F5-8061-B84AD89F39C4.html"><span class="option">gemm_*_pack_get_size</span></a>  to return the number of bytes needed to store the packed matrix.</div>
<div><a href="GUID-16188573-1301-4078-8837-95670AF6FF48.html"><span class="option">gemm_*_pack</span></a>  to pack the matrix into the buffer allocated previously.</div></div></div>
</body>
</html>
