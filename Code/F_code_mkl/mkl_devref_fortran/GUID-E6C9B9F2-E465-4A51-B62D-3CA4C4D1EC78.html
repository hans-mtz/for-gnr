<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0016)http://localhost -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="DC.Type" content="FunctionRef"/>
<meta name="DC.Title" content="?tgex2"/>
<meta name="abstract" content="Swaps adjacent diagonal blocks in an upper (quasi) triangular matrix pair by an orthogonal/unitary equivalence transformation."/>
<meta name="description" content="Swaps adjacent diagonal blocks in an upper (quasi) triangular matrix pair by an orthogonal/unitary equivalence transformation."/>
<meta name="DC.subject" content="LAPACK routines, auxiliary routines, ?tgex2, stgex2, dtgex2, ctgex2, ztgex2, swapping adjacent diagonal blocks, triangular matrix"/>
<meta name="keywords" content="LAPACK routines, auxiliary routines, ?tgex2, stgex2, dtgex2, ctgex2, ztgex2, swapping adjacent diagonal blocks, triangular matrix"/>
<meta name="DC.Relation" scheme="URI" content="GUID-118DC64D-62BB-4B91-9E76-562387E86B79.html"/>
<meta name="DC.Relation" scheme="URI" content="http://www.intel.com/software/products/softwaredocs_feedback"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-E6C9B9F2-E465-4A51-B62D-3CA4C4D1EC78"/>
<meta name="DC.Language" content="en-US"/>
<link rel="stylesheet" type="text/css" href="intel_css_styles.css"/>
<title>?tgex2</title>

</head>
<body id="GUID-E6C9B9F2-E465-4A51-B62D-3CA4C4D1EC78">
 <!-- ==============(Start:NavScript)================= -->
 <script src="NavScript.js" language="JavaScript1.2" type="text/javascript"></script>
 <script language="JavaScript1.2" type="text/javascript">WriteNavLink(0);</script>
 <!-- ==============(End:NavScript)================= -->
<p id="header_text" style="margin-bottom : 20pt"><em>Intel&reg; oneAPI Math Kernel Library Developer Reference - Fortran</em></p>


<h1 class="topictitle1"><span class="option">?tgex2</span></h1>
<!--Swaps adjacent diagonal blocks in an upper (quasi) triangular matrix pair by an orthogonal/unitary equivalence transformation.--><div><p class="shortdesc">Swaps adjacent diagonal blocks in an upper (quasi) triangular matrix pair by an orthogonal/unitary equivalence transformation.</p>
<div class="section" id="GUID-B3D260A0-80CD-4350-B4C3-FDC4DECF3A92"><h2 class="sectiontitle">Syntax</h2><div class="dlsyntaxpara"><p class="dlsyntaxpara"><span class="kwd">call stgex2</span><span class="delim">( </span><span class="var">wantq</span><span class="sep">, </span><span class="var">wantz</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">lda</span><span class="sep">, </span><span class="var">b</span><span class="sep">, </span><span class="var">ldb</span><span class="sep">, </span><span class="var">q</span><span class="sep">, </span><span class="var">ldq</span><span class="sep">, </span><span class="var">z</span><span class="sep">, </span><span class="var">ldz</span><span class="sep">, </span><span class="var">j1</span><span class="sep">, </span><span class="var">n1</span><span class="sep">, </span><span class="var">n2</span><span class="sep">, </span><span class="var">work</span><span class="sep">, </span><span class="var">lwork</span><span class="sep">, </span><span class="var">info</span><span class="delim"> )</span></p><p class="dlsyntaxpara"><span class="kwd">call dtgex2</span><span class="delim">( </span><span class="var">wantq</span><span class="sep">, </span><span class="var">wantz</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">lda</span><span class="sep">, </span><span class="var">b</span><span class="sep">, </span><span class="var">ldb</span><span class="sep">, </span><span class="var">q</span><span class="sep">, </span><span class="var">ldq</span><span class="sep">, </span><span class="var">z</span><span class="sep">, </span><span class="var">ldz</span><span class="sep">, </span><span class="var">j1</span><span class="sep">, </span><span class="var">n1</span><span class="sep">, </span><span class="var">n2</span><span class="sep">, </span><span class="var">work</span><span class="sep">, </span><span class="var">lwork</span><span class="sep">, </span><span class="var">info</span><span class="delim"> )</span></p><p class="dlsyntaxpara"><span class="kwd">call ctgex2</span><span class="delim">( </span><span class="var">wantq</span><span class="sep">, </span><span class="var">wantz</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">lda</span><span class="sep">, </span><span class="var">b</span><span class="sep">, </span><span class="var">ldb</span><span class="sep">, </span><span class="var">q</span><span class="sep">, </span><span class="var">ldq</span><span class="sep">, </span><span class="var">z</span><span class="sep">, </span><span class="var">ldz</span><span class="sep">, </span><span class="var">j1</span><span class="sep">, </span><span class="var">info</span><span class="delim"> )</span></p><p class="dlsyntaxpara"><span class="kwd">call ztgex2</span><span class="delim">( </span><span class="var">wantq</span><span class="sep">, </span><span class="var">wantz</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">lda</span><span class="sep">, </span><span class="var">b</span><span class="sep">, </span><span class="var">ldb</span><span class="sep">, </span><span class="var">q</span><span class="sep">, </span><span class="var">ldq</span><span class="sep">, </span><span class="var">z</span><span class="sep">, </span><span class="var">ldz</span><span class="sep">, </span><span class="var">j1</span><span class="sep">, </span><span class="var">info</span><span class="delim"> )</span></p></div></div>
<div class="section" id="GUID-99E620D9-5DB9-4DD8-9D84-5400111BC7F8"><h2 class="sectiontitle">Include Files</h2><ul id="d163e82"><li id="d163e83"><span class="filepath">mkl.fi</span></li>
</ul>
</div>
<div class="section" id="GUID-56C1F206-8CFC-4AEE-9DB4-1983D4A1F3DF"><h2 class="sectiontitle">Description</h2><p>The real routines <span class="option">stgex2</span>/<span class="option">dtgex2</span> swap adjacent diagonal blocks (<var>A</var>11, <var>B</var>11) and (<var>A</var>22, <var>B</var>22)  of size 1-by-1 or 2-by-2 in an upper (quasi) triangular matrix pair  (<var>A</var>, <var>B</var>) by an orthogonal equivalence transformation. (<var>A</var>, <var>B</var>) must be in generalized real Schur canonical form (as returned by <span class="option">sgges</span>/<span class="option">dgges</span>), that is, <var>A</var> is block upper triangular with 1-by-1 and 2-by-2  diagonal blocks. <var>B</var> is upper triangular. </p>
<p>The complex routines <span class="option">ctgex2</span>/<span class="option">ztgex2</span> swap adjacent diagonal 1-by-1 blocks (<var>A</var>11, <var>B</var>11) and (<var>A</var>22, <var>B</var>22)  in an upper triangular matrix pair (<var>A</var>, <var>B</var>)  by an unitary equivalence transformation.</p>
<p>(<var>A</var>, <var>B</var>) must be in generalized  Schur canonical form, that is, <var>A</var> and <var>B</var> are both upper triangular. </p>
<p>All routines optionally update the matrices <var>Q</var> and <var>Z</var> of generalized Schur vectors:</p>
<p>For real flavors,</p>
<p><samp class="codeph"><var>Q</var>(in)*<var>A</var>(in)*<var>Z</var>(in)<sup class="power"><var>T</var></sup> = <var>Q</var>(out)*<var>A</var>(out)*<var>Z</var>(out)<sup class="power"><var>T</var></sup></samp></p>
<p><samp class="codeph"><var>Q</var>(in)*<var>B</var>(in)*<var>Z</var>(in)<sup class="power"><var>T</var></sup> = <var>Q</var>(out)*<var>B</var>(out)*<var>Z</var>(out)<sup class="power"><var>T</var></sup></samp>.</p>
<p>For complex flavors,</p>
<p><samp class="codeph"><var>Q</var>(in)*<var>A</var>(in)*<var>Z</var>(in)<sup class="power"><var>H</var></sup> = <var>Q</var>(out)*<var>A</var>(out)*<var>Z</var>(out)<sup class="power"><var>H</var></sup></samp></p>
<p><samp class="codeph"><var>Q</var>(in)*<var>B</var>(in)*<var>Z</var>(in)<sup class="power"><var>H</var></sup> = <var>Q</var>(out)*<var>B</var>(out)*<var>Z</var>(out)<sup class="power"><var>H</var></sup></samp>.</p>
</div>
<div class="section" id="GUID-16A628B0-7C30-477D-8139-C38F5A1C2928"><h2 class="sectiontitle">Input Parameters</h2><dl id="GUID-7DDB5D24-BA08-428F-94DD-DB51338D8471"><dt class="dlterm"><span class="parmname">wantq</span></dt>

<dd><p><span class="keyword">LOGICAL</span>. </p>
<p>If <var>wantq</var> =  <span class="keyword">.TRUE.</span> : update the left transformation matrix <var>Q</var>;</p>
<p>If <var>wantq</var> =  <span class="keyword">.FALSE.</span> : do not update <var>Q</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">wantz</span></dt>

<dd><p><span class="keyword">LOGICAL</span>. </p>
<p>If <var>wantz</var> =  <span class="keyword">.TRUE.</span> : update the right transformation matrix <var>Z</var>;</p>
<p>If <var>wantz</var> = <span class="keyword">.FALSE.</span>: do not update <var>Z</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">n</span></dt>

<dd><p><span class="keyword">INTEGER</span>. The order of the matrices <var>A</var> and <var>B</var>. <samp class="codeph"><var>n</var><span class="eqsymbol">≥</span> 0</samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">a</span>, <span class="parmname">b</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">stgex2</span><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dtgex2</span></p>
<p><span class="keyword">COMPLEX</span> for <span class="option">ctgex2</span></p>
<p><span class="keyword">DOUBLE COMPLEX</span> for <span class="option">ztgex2</span>.</p>
<p>Arrays, <span class="keyword">DIMENSION</span> (<var>lda</var>, <var>n</var>) and (<var>ldb</var>, <var>n</var>), respectively. </p>
<p>On entry, the matrices <var>A</var> and <var>B</var> in the pair (<var>A</var>, <var>B</var>).</p>
</dd>
<dt class="dlterm"><span class="parmname">lda</span></dt>

<dd><p><span class="keyword">INTEGER</span>. The leading dimension of the array <var>a</var>. <samp class="codeph"><var>lda</var><span class="eqsymbol">≥</span> max(1,<var>n</var>)</samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">ldb</span></dt>

<dd><p><span class="keyword">INTEGER</span>. The leading dimension of the array <var>b</var>. <samp class="codeph"><var>ldb</var><span class="eqsymbol">≥</span> max(1,<var>n</var>)</samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">q</span>, <span class="parmname">z</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">stgex2</span><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dtgex2</span></p>
<p><span class="keyword">COMPLEX</span> for <span class="option">ctgex2</span></p>
<p><span class="keyword">DOUBLE COMPLEX</span> for <span class="option">ztgex2</span>.</p>
<p>Arrays, <span class="keyword">DIMENSION</span> (<var>ldq</var>, <var>n</var>) and (<var>ldz</var>, <var>n</var>), respectively. </p>
<p>On entry, if <samp class="codeph"><var>wantq</var> = <span class="keyword">.TRUE.</span></samp>, <var>q</var> contains the orthogonal/unitary matrix <var>Q</var>, and if <samp class="codeph"><var>wantz</var> = <span class="keyword">.TRUE.</span></samp>, <var>z</var> contains the orthogonal/unitary matrix <var>Z</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">ldq</span></dt>

<dd><p><span class="keyword">INTEGER</span>. The leading dimension of the array <var>q</var>. <samp class="codeph"><var>ldq</var><span class="eqsymbol">≥</span> 1</samp>. </p>
<p>If <samp class="codeph"><var>wantq</var> = <span class="keyword">.TRUE.</span></samp>, <samp class="codeph"><var>ldq</var><span class="eqsymbol">≥</span><var>n</var></samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">ldz</span></dt>

<dd><p><span class="keyword">INTEGER</span>. The leading dimension of the array <var>z</var>. <samp class="codeph"><var>ldz</var><span class="eqsymbol">≥</span> 1</samp>. </p>
<p>If <samp class="codeph"><var>wantz</var> = <span class="keyword">.TRUE.</span></samp>, <samp class="codeph"><var>ldz</var><span class="eqsymbol">≥</span><var>n</var></samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">j1</span></dt>

<dd><p><span class="keyword">INTEGER</span>. </p>
<p>The index to the first block (<var>A</var>11, <var>B</var>11). <samp class="codeph">1 ≤ <var>j1</var> ≤ <var>n</var></samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">n1</span></dt>

<dd><p><span class="keyword">INTEGER</span>. Used with real flavors only. The order of the first block (<var>A</var>11, <var>B</var>11). <samp class="codeph"><var>n1</var> = 0</samp>, <samp class="codeph">1</samp> or <samp class="codeph">2</samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">n2</span></dt>

<dd><p><span class="keyword">INTEGER</span>. Used with real flavors only. The order of the second block (<var>A</var>22, <var>B</var>22). <samp class="codeph"><var>n2</var> = 0</samp>,  <samp class="codeph">1</samp> or <samp class="codeph">2</samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">work</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">stgex2</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dtgex2</span>.</p>
<p>Workspace array, <span class="keyword">DIMENSION</span><samp class="codeph">(max(1,<var>lwork</var>))</samp>. Used with real flavors only.</p>
</dd>
<dt class="dlterm"><span class="parmname">lwork</span></dt>

<dd><p><span class="keyword">INTEGER</span>. The dimension of the array <var>work</var>. </p>
<p><samp class="codeph"><var>lwork</var><span class="eqsymbol">≥</span>max(<var>n</var>*(<var>n2</var>+<var>n1</var>), 2*(<var>n2</var>+<var>n1</var>)<sup class="power">2</sup>)</samp></p>
</dd>
</dl>
</div>
<div class="section" id="GUID-20C81695-16BC-443F-BA67-1DD110C6F3CA"><h2 class="sectiontitle">Output Parameters</h2><dl id="GUID-F0E40C51-C3AF-452B-AA46-00C5D49246A1"><dt class="dlterm"><span class="parmname">a</span></dt>

<dd><p>On exit, the updated matrix <var>A</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">B</span></dt>

<dd><p>On exit, the updated matrix <var>B</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">Q</span></dt>

<dd><p>On exit, the updated matrix <var>Q</var>. </p>
<p>Not referenced if <samp class="codeph"><var>wantq</var> = <span class="keyword">.FALSE.</span></samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">z</span></dt>

<dd><p>On exit, the updated matrix <var>Z</var>. </p>
<p>Not referenced if <samp class="codeph"><var>wantz</var> = <span class="keyword">.FALSE.</span></samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">info</span></dt>

<dd><p><span class="keyword">INTEGER</span>. </p>
<p>=0: Successful exit For <span class="option">stgex2</span>/<span class="option">dtgex2</span>: If <samp class="codeph"><var>info</var> = 1</samp>, the transformed matrix (<var>A</var>, <var>B</var>) would be too far from generalized Schur form; the blocks are not swapped and (<var>A</var>, <var>B</var>) and (<var>Q</var>, <var>Z</var>) are unchanged. The problem of swapping is too ill-conditioned. If <samp class="codeph"><var>info</var> = -16</samp>: <var>lwork</var> is too small. Appropriate value for <var>lwork</var> is returned in <var>work</var>(1).</p>
<p>For <span class="option">ctgex2</span>/<span class="option">ztgex2</span>:</p>
<p>If <samp class="codeph"><var>info</var> = 1</samp>, the transformed matrix pair (<var>A</var>, <var>B</var>) would be too far from generalized Schur form; the problem is ill-conditioned.</p>
</dd>
</dl>
</div>
</div>

<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-118DC64D-62BB-4B91-9E76-562387E86B79.html">LAPACK Auxiliary Routines</a></div>
</div>
<div/>
</body>
</html>
