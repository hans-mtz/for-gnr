<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0016)http://localhost -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="DC.Type" content="FunctionRef"/>
<meta name="DC.Title" content="?gesvj"/>
<meta name="abstract" content="Computes the singular value decomposition of a real matrix using Jacobi plane rotations."/>
<meta name="description" content="Computes the singular value decomposition of a real matrix using Jacobi plane rotations."/>
<meta name="DC.subject" content="?gesvj, sgesvj, dgesvj, LAPACK routines, driver routines, singular value decomposition, Jacobi plane rotations"/>
<meta name="keywords" content="?gesvj, sgesvj, dgesvj, LAPACK routines, driver routines, singular value decomposition, Jacobi plane rotations"/>
<meta name="DC.Relation" scheme="URI" content="GUID-BDA281B1-921F-4A41-B381-DCD341B0774A.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-7D137664-6F3E-4832-BEDD-39EAF5AE9F52.html#GUID-7D137664-6F3E-4832-BEDD-39EAF5AE9F52"/>
<meta name="DC.Relation" scheme="URI" content="http://www.intel.com/software/products/softwaredocs_feedback"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-9469788C-1DF5-46A8-999B-F71B17245938"/>
<meta name="DC.Language" content="en-US"/>
<link rel="stylesheet" type="text/css" href="intel_css_styles.css"/>
<title>?gesvj</title>

</head>
<body id="GUID-9469788C-1DF5-46A8-999B-F71B17245938">
 <!-- ==============(Start:NavScript)================= -->
 <script src="NavScript.js" language="JavaScript1.2" type="text/javascript"></script>
 <script language="JavaScript1.2" type="text/javascript">WriteNavLink(0);</script>
 <!-- ==============(End:NavScript)================= -->
<p id="header_text" style="margin-bottom : 20pt"><em>Intel&reg; oneAPI Math Kernel Library Developer Reference - Fortran</em></p>


<h1 class="topictitle1"><span class="option">?gesvj</span></h1>
<!--Computes the singular value decomposition of a real matrix using Jacobi plane rotations.--><div><p class="shortdesc">Computes the singular value decomposition of a real matrix using Jacobi plane rotations.</p>
<div class="section" id="GUID-2F3AF757-DE30-4A84-BDA1-72E75248D2B8"><h2 class="sectiontitle">Syntax</h2><dl class="dlsyntax"><p class="dlsyntaxpara"><span class="kwd">call sgesvj</span><span class="delim">(</span><span class="var">joba</span><span class="sep">, </span><span class="var">jobu</span><span class="sep">, </span><span class="var">jobv</span><span class="sep">, </span><span class="var">m</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">lda</span><span class="sep">, </span><span class="var">sva</span><span class="sep">, </span><span class="var">mv</span><span class="sep">, </span><span class="var">v</span><span class="sep">, </span><span class="var">ldv</span><span class="sep">, </span><span class="var">work</span><span class="sep">, </span><span class="var">lwork</span><span class="sep">, </span><span class="var">info</span><span class="delim">)</span></p><p class="dlsyntaxpara"><span class="kwd">call dgesvj</span><span class="delim">(</span><span class="var">joba</span><span class="sep">, </span><span class="var">jobu</span><span class="sep">, </span><span class="var">jobv</span><span class="sep">, </span><span class="var">m</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">lda</span><span class="sep">, </span><span class="var">sva</span><span class="sep">, </span><span class="var">mv</span><span class="sep">, </span><span class="var">v</span><span class="sep">, </span><span class="var">ldv</span><span class="sep">, </span><span class="var">work</span><span class="sep">, </span><span class="var">lwork</span><span class="sep">, </span><span class="var">info</span><span class="delim">)</span></p><p class="dlsyntaxpara"><span class="kwd">call cgesvj</span><span class="delim">(</span><span class="var">joba</span><span class="sep">, </span><span class="var">jobu</span><span class="sep">, </span><span class="var">jobv</span><span class="sep">, </span><span class="var">m</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">lda</span><span class="sep">, </span><span class="var">sva</span><span class="sep">, </span><span class="var">mv</span><span class="sep">, </span><span class="var">v</span><span class="sep">, </span><span class="var">ldv</span><span class="sep">, </span><span class="var">cwork</span><span class="sep">, </span><span class="var">lwork</span><span class="sep">, </span><span class="var">rwork</span><span class="sep">, </span><span class="var">lrwork</span><span class="sep">, </span><span class="var">info </span><span class="delim">)</span></p><p class="dlsyntaxpara"><span class="kwd">call zgesvj</span><span class="delim">(</span><span class="var">joba</span><span class="sep">, </span><span class="var">jobu</span><span class="sep">, </span><span class="var">jobv</span><span class="sep">, </span><span class="var">m</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">lda</span><span class="sep">, </span><span class="var">sva</span><span class="sep">, </span><span class="var">mv</span><span class="sep">, </span><span class="var">v</span><span class="sep">, </span><span class="var">ldv</span><span class="sep">, </span><span class="var">cwork</span><span class="sep">, </span><span class="var">lwork</span><span class="sep">, </span><span class="var">rwork</span><span class="sep">, </span><span class="var">lrwork</span><span class="sep">, </span><span class="var">info </span><span class="delim">)</span></p></dl></div>
<div class="section" id="GUID-551E1F8B-BBBE-430F-B3FF-E3FD046268EA"><h2 class="sectiontitle">Include Files</h2><ul id="d163e88"><li id="d163e89"><span class="filepath">mkl.fi</span></li>
</ul>
</div>
<div class="section" id="GUID-E812CB1E-F820-4097-B61E-7324C0E99903"><h2 class="sectiontitle">Description</h2><p>The routine computes the singular value decomposition (SVD) of a real or complex <span class="parmname">m</span>-by-<span class="parmname">n</span> matrix <var>A</var>, where <span class="parmname">m</span><span class="eqsymbol">≥</span><span class="parmname">n</span>. </p>
<p>The SVD of <var>A</var> is written as</p>
<p><samp class="codeph"><var>A</var> = <var>U</var>*<span class="eqsymbol">Σ</span>*<var>V</var><sup>T</sup></samp> for real flavors, or</p>
<p><samp class="codeph"><var>A</var> = <var>U</var>*<span class="eqsymbol">Σ</span>*<var>V</var><sup>H</sup></samp> for complex flavors,</p>
<p>where <span class="eqsymbol">Σ</span> is an <span class="parmname">m</span>-by-<span class="parmname">n</span> diagonal matrix, <var>U</var> is an <span class="parmname">m</span>-by-<span class="parmname">n</span> orthonormal matrix, and <var>V</var> is an <span class="parmname">n</span>-by-<span class="parmname">n</span> orthogonal/unitary matrix. The diagonal elements of <span class="eqsymbol">Σ</span> are the singular values of <var>A</var>; the columns of <var>U</var> and <var>V</var> are the left and right singular vectors of <var>A</var>, respectively. The matrices <var>U</var> and <var>V</var> are computed and stored in the arrays <span class="parmname">u</span>
and <span class="parmname">v</span>, respectively. The diagonal of <span class="eqsymbol">Σ</span> is computed and
stored in the array <span class="parmname">sva</span>.</p>
<p>The <span class="option">?gesvj</span> routine can sometimes compute tiny singular values and their
singular vectors much more accurately than other SVD
routines.</p>
<p>The <span class="parmname">n</span>-by-<span class="parmname">n</span> orthogonal matrix <var>V</var>
is obtained as a product of Jacobi plane rotations. The rotations
are implemented as fast scaled rotations of Anda and Park [<a href="GUID-732F9EE1-BCEC-4D9B-9B93-AF5499B21140.html#ANDAPARK94">AndaPark94</a>]. In the case of underflow of the Jacobi angle, a modified Jacobi transformation of Drmac ([<a href="GUID-732F9EE1-BCEC-4D9B-9B93-AF5499B21140.html#DRMAC08-4">Drmac08-4</a>]) is used. Pivot strategy uses column interchanges of de Rijk ([<a href="GUID-732F9EE1-BCEC-4D9B-9B93-AF5499B21140.html#DERIJK98">deRijk98</a>]). The relative accuracy of the computed singular values and the accuracy of the computed singular vectors (in angle metric) is as guaranteed by the theory of Demmel and Veselic [<a href="GUID-732F9EE1-BCEC-4D9B-9B93-AF5499B21140.html#DEMMEL92">Demmel92</a>]. The condition number that determines the accuracy in the full rank case is essentially</p>
<p><br/><div class="imagecenter"><img src="GUID-477C1918-78FD-401B-844B-3988B24C50F3-low.gif" align="center"/></div><br/></p>
<p>where <span class="eqsymbol">κ</span>(.) is the spectral condition number. The best performance of this Jacobi SVD procedure is achieved if used in an accelerated version of Drmac and Veselic [<a href="GUID-732F9EE1-BCEC-4D9B-9B93-AF5499B21140.html#DRMAC08-1">Drmac08-1</a>], [<a href="GUID-732F9EE1-BCEC-4D9B-9B93-AF5499B21140.html#DRMAC08-2">Drmac08-2</a>]. </p>
<p>The computational range for the nonzero singular values is the machine number interval ( <span class="keyword">UNDERFLOW</span>,<span class="keyword">OVERFLOW</span> ). In extreme cases, even denormalized singular values can be
computed with the corresponding gradual loss of accurate digit.</p>
</div>
<div class="section" id="GUID-D1DE1075-5F85-42A8-8809-EB8110BBDACE"><h2 class="sectiontitle">Input Parameters</h2><dl id="GUID-CECF66E6-E29D-4C71-AF02-350A253AD24B"><dt class="dlterm"><span class="parmname">joba</span></dt>

<dd><p><span><span class="keyword">CHARACTER*1</span>. </span>Must be <span class="keyword">'L'</span>, <span class="keyword">'U'</span> or <span class="keyword">'G'</span>.</p>
<p>Specifies the structure of <var>A</var>:</p>
<p>If <samp class="codeph"><span class="parmname">joba</span> = <span class="keyword">'L'</span></samp>, the input matrix <var>A</var> is lower triangular.</p>
<p>If <samp class="codeph"><span class="parmname">joba</span> = <span class="keyword">'U'</span></samp>, the input matrix <var>A</var> is upper triangular.</p>
<p>If <samp class="codeph"><span class="parmname">joba</span> = <span class="keyword">'G'</span></samp>, the input matrix <var>A</var> is a general <span class="parmname">m</span>-by-<span class="parmname">n</span>, <span class="parmname">m</span><span class="eqsymbol">≥</span><span class="parmname">n</span>.</p>
</dd>
<dt class="dlterm"><span class="parmname">jobu</span></dt>

<dd><p><span><span class="keyword">CHARACTER*1</span>. </span>Must be <span class="keyword">'U'</span>, <span class="keyword">'C'</span> or <span class="keyword">'N'</span>.</p>
<p>Specifies whether to compute the left singular vectors (columns of
<var>U</var>):</p>
<p>If <samp class="codeph"><span class="parmname">jobu</span> = <span class="keyword">'U'</span></samp>, the left singular vectors corresponding to the nonzero singular
values are computed and returned in the leading columns of
 <var>A</var>.  See more details in the description of <span class="parmname">a</span>. The default numerical orthogonality threshold is set to approximately
<samp class="codeph">TOL=CTOL*EPS, CTOL=sqrt(<span class="parmname">m</span>), EPS = <span class="option">?lamch</span>(<span class="keyword">'E'</span>)</samp></p>
<p>If <samp class="codeph"><span class="parmname">jobu</span> = <span class="keyword">'C'</span></samp>, analogous to 
 <samp class="codeph"><span class="parmname">jobu</span> = <span class="keyword">'U'</span></samp>, except that you can control the level of numerical orthogonality of the
computed left singular vectors.
<span class="keyword">TOL</span>
can be set to <samp class="codeph">TOL=CTOL*EPS</samp>, where <span class="keyword">CTOL</span> is given on input in the array <span class="parmname">work</span>. No <span class="keyword">CTOL</span> smaller than ONE is allowed. <span class="keyword">CTOL</span> greater than <samp class="codeph">1 / EPS</samp> is
meaningless. The option <span class="keyword">'C'</span> can be used if <samp class="codeph"><span class="parmname">m</span>*EPS</samp> is satisfactory
orthogonality of the computed left singular vectors, so <samp class="codeph">CTOL=<span class="parmname">m</span></samp> could save a few sweeps of Jacobi rotations. See the descriptions
of <span class="parmname">a</span> and <span class="parmname">work(1)</span>.
</p>
<p>If <samp class="codeph"><span class="parmname">jobu</span> = <span class="keyword">'N'</span></samp>, <span class="parmname">u</span> is not computed. However, see the description of <span class="parmname">a</span>.</p>
</dd>
<dt class="dlterm"><span class="parmname">jobv</span></dt>

<dd><p><span><span class="keyword">CHARACTER*1</span>. </span>Must be <span class="keyword">'V'</span>, <span class="keyword">'A'</span> or <span class="keyword">'N'</span>.</p>
<p>Specifies whether to compute the right singular vectors, that is, the matrix
<var>V</var>:</p>
<p>If <samp class="codeph"><span class="parmname">jobv</span> = <span class="keyword">'V'</span></samp>, the matrix <var>V</var> is computed and returned in the array <span class="parmname">v</span>.</p>
<p>If <samp class="codeph"><span class="parmname">jobv</span> = <span class="keyword">'A'</span></samp>, the Jacobi rotations are applied to the <span class="parmname">mv</span>-by<span class="parmname">n</span>  array <span class="parmname">v</span>. In other
words, the right singular vector matrix <var>V</var> is not computed
explicitly, instead it is applied to an <span class="parmname">mv</span>-by<span class="parmname">n</span> matrix initially
stored in the first <span class="parmname">mv</span> rows of <var>V</var>.</p>
<p>If <samp class="codeph"><span class="parmname">jobv</span> = <span class="keyword">'N'</span></samp>, the matrix <var>V</var> is not computed and the array <span class="parmname">v</span> is not referenced.</p>
</dd>
<dt class="dlterm"><span class="parmname">m</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>The number of rows of the input matrix <var>A</var>.</p>
<p><samp class="codeph">1/slamch('E')&gt; <var>m</var><span class="eqsymbol">≥</span> 0</samp> for <span class="option">sgesvj</span>.</p>
<p><samp class="codeph">1/dlamch('E')&gt; <var>m</var><span class="eqsymbol">≥</span> 0</samp> for <span class="option">dgesvj</span>.</p>
</dd>
<dt class="dlterm"><span class="parmname">n</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>The number of columns in the input matrix <var>A</var>; <var>m</var><span class="eqsymbol">≥</span><var>n</var><span class="eqsymbol">≥</span> 0. </p>
</dd>
<dt class="dlterm"><span class="parmname">a</span>, <span class="parmname">v</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">sgesvj</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dgesvj</span>.</p>
<p><span class="keyword">COMPLEX</span> for <span class="option">cgesvj</span></p>
<p><span class="keyword">DOUBLE COMPLEX</span> for <span class="option">zgesvj</span></p>
<p>Array <span class="parmname">a</span><span>(<var>lda</var>,<span class="parmname">n</span>)</span>
 is an array containing the <span class="parmname">m</span>-by-<span class="parmname">n</span> matrix <var>A</var>. </p>
<p>Array <var>v</var><span> is a workspace array, its dimension is (<span class="parmname">ldv</span>,*); the second dimension of <var>v</var> must be at least max(1, <var>n</var>)</span>.</p>
</dd>
<dt class="dlterm"><span class="parmname">lda</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>The leading dimension of the array <span class="parmname">a</span>. Must be at least <samp class="codeph">max(1, <span class="parmname">m</span>)</samp>
.</p>
</dd>
<dt class="dlterm"><span class="parmname">mv</span></dt>

<dd><p><span class="keyword">INTEGER</span>.</p>
<p>If<span class="parmname">jobv</span> = <span class="keyword">'A'</span>, the product of Jacobi rotations in <span class="option">?gesvj</span> is applied to the first
<span class="parmname">mv</span> rows of <var>v</var>. See the description of <span class="parmname">jobv</span>.  <samp class="codeph">0 <span class="eqsymbol">≤</span><span class="parmname">mv</span><span class="eqsymbol">≤</span><span class="parmname">ldv</span></samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">ldv</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>The leading dimension of the array <var>v</var>;  <samp class="codeph"><span class="parmname">ldv</span><span class="eqsymbol">≥</span> 1</samp>.</p>
<p><span class="parmname">jobv</span> = <span class="keyword">'V'</span>, <samp class="codeph"><span class="parmname">ldv</span><span class="eqsymbol">≥</span>
max(1, <span class="parmname">n</span>)</samp>.</p>
<p><span class="parmname">jobv</span> = <span class="keyword">'A'</span>, <samp class="codeph"><span class="parmname">ldv</span><span class="eqsymbol">≥</span>
max(1, <span class="parmname">mv</span>)</samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">work</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">sgesvj</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dgesvj</span>.</p>
<p><var>work</var> is a workspace array, its dimension <samp class="codeph">max(4, <span class="parmname">m</span>+<span class="parmname">n</span>)</samp>.</p>
<p>If <samp class="codeph"><span class="parmname">jobu</span> = <span class="keyword">'C'</span></samp>, <samp class="codeph"><span class="parmname">work(1)</span>=CTOL</samp>, where 
<span class="keyword">CTOL</span>
defines the threshold for convergence. The process stops if all
columns of <var>A</var> are mutually orthogonal up to <samp class="codeph">CTOL*EPS</samp>,
<samp class="codeph">EPS=<span class="option">?lamch</span>(<span class="keyword">'E'</span>)</samp>. It is required that <samp class="codeph">CTOL <span class="eqsymbol">≥</span> 1</samp>, that is,  it is
not allowed to force the routine to obtain orthogonality below <span class="eqsymbol">ε</span>.</p>
</dd>
<dt class="dlterm"><span class="parmname">cwork</span></dt>

<dd><p><span class="keyword">COMPLEX</span> for <span class="option">cgesvj</span></p>
<p><span class="keyword">DOUBLE COMPLEX</span> for <span class="option">zgesvj</span></p>
<p><span class="parmname">cwork</span> is a workspace array, its dimension <span class="parmname">m</span>+<span class="parmname">n</span>.</p>
</dd>
<dt class="dlterm"><span class="parmname">lwork</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span></p>
<p>Length of <var>work</var> for real flavors or <var>cwork</var> for complex flavors, <samp class="codeph"><var>lwork</var><span class="eqsymbol">≥</span> max(6,<span class="parmname">m</span>+<span class="parmname">n</span>)</samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">rwork</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">cgesvj</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">zgesvj</span></p>
<p><span class="parmname">rwork</span> is a workspace array, its dimension <samp class="codeph">max(6,<span class="parmname">m</span>+<span class="parmname">n</span>)</samp>.</p>
<p> If <samp class="codeph"><span class="parmname">jobu</span> = <span class="keyword">'C'</span></samp>,  <samp class="codeph"><span class="parmname">rwork(1) </span>= <span class="keyword">CTOL</span></samp>, where <span class="keyword">CTOL</span> defines the threshold for convergence. The process stops if all columns of <span class="parmname">a</span> are mutually orthogonal up to <samp class="codeph"><span class="keyword">CTOL</span>*<span class="keyword">EPS</span></samp>, <samp class="codeph"><span class="keyword">EPS</span>=<span class="option">?lamch</span>(<span class="keyword">'E'</span>)</samp>. It is required that <samp class="codeph"><span class="keyword">CTOL</span><span class="eqsymbol">≥</span> 1</samp>, that is, it is not allowed to force the routine to obtain orthogonality below <span class="eqsymbol">ε</span>.</p>
</dd>
<dt class="dlterm"><span class="parmname">lrwork</span></dt>

<dd><p><span class="keyword">INTEGER</span> for <span class="option">cgesvj</span></p>
<p><span class="keyword">INTEGER</span> for <span class="option">zgesvj</span></p>
<p>Length of <span class="parmname">rwork</span>, <samp class="codeph"><span class="parmname">lrwork</span><span class="eqsymbol">≥</span> max(6,<span class="parmname">n</span>)</samp>.</p>
</dd>
</dl>
</div>
<div class="section" id="GUID-0B189689-44B9-4062-BA06-C311AF777218"><h2 class="sectiontitle">Output Parameters</h2><dl id="GUID-A4B26686-FF48-4FDA-9FA5-6CCB4F680CBD"><dt class="dlterm"><span class="parmname">a</span></dt>

<dd><p>On exit:</p>
<p>If <samp class="codeph"><span class="parmname">jobu</span> = <span class="keyword">'U'</span></samp> or <samp class="codeph"><span class="parmname">jobu</span> = <span class="keyword">'C'</span></samp>:</p>
<ul id="GUID-D6C813DB-8214-4FB1-9C62-EEFD4C9B118D"><li><p>if <samp class="codeph"><span class="parmname">info</span> = 0</samp>, the leading columns of <var>A</var> contain left singular vectors corresponding to the computed
singular values of <span class="parmname">a</span> that are above the underflow threshold <span class="option">?lamch</span>(<span class="keyword">'S'</span>), that is, non-zero singular values. The number of the computed non-zero singular values is returned in <span><span class="parmname">work(2)</span> for real flavors or <span class="parmname">rwork(2)</span> for complex flavors</span>.
Also see the descriptions of <span class="parmname">sva</span> and <span><span class="parmname">work</span> for real flavors or <span class="parmname">rwork</span> for complex flavors</span>. The computed columns
of <span class="parmname">u</span> are mutually numerically orthogonal up to approximately <samp class="codeph">TOL=sqrt(<span class="parmname">m</span>)*EPS</samp> (default); or <samp class="codeph">TOL=CTOL*EPS</samp><samp class="codeph"><span class="parmname">jobu</span> = <span class="keyword">'C'</span></samp>, see
the description of <span class="parmname">jobu</span>.</p>
</li>
<li><p>if <samp class="codeph"><span class="parmname">info</span> &gt; 0</samp>, 
the procedure <span class="option">?gesvj</span> did not converge in the given number of
iterations (sweeps). In that case, the computed columns of <span class="parmname">u</span> may
not be orthogonal up to <span class="keyword">TOL</span>. The output <span class="parmname">u</span> (stored in <span class="parmname">a</span>), <var>sigma</var>
(given by the computed singular values in <samp class="codeph"><span class="parmname">sva</span>(1:n)</samp>) and <span class="parmname">v</span> is
still a decomposition of the input matrix <var>A</var> in the sense that the residual <samp class="codeph">||<var>A</var>-scale*<var>U</var>*<var>sigma</var>*<var>V</var><sup>T</sup>||<sub>2</sub> / ||<var>A</var>||<sub>2</sub></samp> for real flavors or <samp class="codeph">||<var>A</var>-scale*<var>U</var>*<var>sigma</var>*<var>V</var><sup>H</sup>||<sub>2</sub> / ||<var>A</var>||<sub>2</sub></samp> for complex flavors (where <samp class="codeph">scale = <span class="parmname">stat</span></samp><samp class="codeph">[0]</samp>) is small.</p>
</li>
</ul>
<p>If <samp class="codeph"><span class="parmname">jobu</span> = <span class="keyword">'N'</span></samp>:</p>
<ul id="GUID-34692F44-6160-477A-B06D-A066815523C7"><li><p>if <samp class="codeph"><span class="parmname">info</span> = 0</samp>, note that the left singular vectors are 'for free' in the one-sided Jacobi SVD algorithm. However, if only the singular
values are needed, the level of numerical orthogonality of <span class="parmname">u</span> is
not an issue and iterations are stopped when the columns of the
iterated matrix are numerically orthogonal up to approximately
<samp class="codeph"><span class="parmname">m</span>*EPS</samp>. Thus, on exit, <span class="parmname">a</span> contains the columns of <span class="parmname">u</span> scaled with the corresponding singular values.</p>
</li>
<li><p>if <samp class="codeph"><span class="parmname">info</span> &gt; 0</samp>, 
the procedure <span class="option">?gesvj</span> did not converge in the given number of
iterations (sweeps).</p>
</li>
</ul>
</dd>
<dt class="dlterm"><span class="parmname">sva</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">sgesvj</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dgesvj</span>.</p>
<p><span class="keyword">REAL</span> for <span class="option">cgesvj</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">zgesvj</span></p>
<p>Array size <span class="parmname">n</span>.</p>
<p>If <samp class="codeph"><span class="parmname">info</span> = 0</samp>, depending on the value <var>scale</var>
=<span><span class="parmname">work(1)</span> for real flavors or <span class="parmname">rwork(1)</span> for complex flavors</span>, where <var>scale</var> is the scaling factor:</p>
<ul id="GUID-9A0057BB-0734-4DB7-998E-19520511D17A"><li><p>if <samp class="codeph"><var>scale</var> = 1</samp>, <samp class="codeph"><span class="parmname">sva</span></samp><samp class="codeph">(1:n)</samp> contains the computed singular values of <span class="parmname">a</span>. </p>
<p>During the computation, <span class="parmname">sva</span> contains the Euclidean column  norms of the iterated matrices in
the array <span class="parmname">a</span>.</p>
</li>
<li><p>if <samp class="codeph"><var>scale</var><span class="eqsymbol">≠</span> 1</samp>, 
the  singular values of <span class="parmname">a</span>
 are <samp class="codeph"><var>scale</var>*<span class="parmname">sva</span>(1:n)</samp>, and this factored representation is due to the fact that some of
the singular values of <span class="parmname">a</span> might underflow or overflow.</p>
</li>
</ul>
<p>If <samp class="codeph"><span class="parmname">info</span> &gt; 0</samp>,  the procedure <span class="option">?gesvj</span> did not converge in the given number of
iterations (sweeps)
and <samp class="codeph"><var>scale</var>*<span class="parmname">sva</span>(1:n)</samp> may not be accurate.</p>
</dd>
<dt class="dlterm"><span class="parmname">v</span></dt>

<dd><p>On exit:</p>
<p>If <samp class="codeph"><span class="parmname">jobv</span> = <span class="keyword">'V'</span></samp>, contains the <span class="parmname">n</span>-by-<span class="parmname">n</span> matrix of the right singular vectors.</p>
<p>If <samp class="codeph"><span class="parmname">jobv</span> = <span class="keyword">'A'</span></samp>, then  <span class="parmname">v</span>
contains the product of the computed right singular vector matrix
and the initial matrix in the array <span class="parmname">v</span>.</p>
<p>If <samp class="codeph"><span class="parmname">jobv</span> = <span class="keyword">'N'</span></samp>, <span class="parmname">v</span> is not referenced.</p>
</dd>
<dt class="dlterm"><span class="parmname">work</span></dt>

<dd><p>On exit,</p>
<p><span class="parmname">work(1)</span> = <var>scale</var> is the scaling factor such that <samp class="codeph"><var>scale</var>*<span class="parmname">sva</span>(1:<span class="parmname">n</span>)</samp> are the computed singular values of <var>A</var>. See the description of <span class="parmname">sva</span><samp class="codeph">()</samp>.</p>
<p><span class="parmname">work(2)</span> is the number of the computed nonzero singular values.</p>
<p><span class="parmname">work(3)</span> is the number of the computed singular values that are larger
than the underflow threshold.</p>
<p><span class="parmname">work(4)</span> is the number of sweeps of Jacobi rotations needed for numerical
convergence.</p>
<p><span class="parmname">work(5)</span> =  <samp class="codeph">max_{i<span class="eqsymbol">≠</span>j} |COS(A(:,i),A(:,j))|</samp> in the last sweep. This is useful information in cases when
<span class="option">?gesvj</span> did not converge, as it can be used to estimate whether the output is still useful and for post festum analysis.</p>
<p><span class="parmname">work(6)</span> is the largest absolute value over all sines of the Jacobi rotation
angles in the last sweep. It can be useful in a post festum
analysis.</p>
</dd>
<dt class="dlterm"><span class="parmname">rwork</span></dt>

<dd><p>On exit,</p>
<p><span class="parmname">rwork(1)</span> = <var>scale</var> is the scaling factor such that <samp class="codeph"><var>scale</var>*<span class="parmname">sva</span>(1:<span class="parmname">n</span>)</samp> are the computed singular values of <var>A</var>. See description of <span class="parmname">sva()</span>.</p>
<p><span class="parmname">rwork(2)</span> is the number of the computed nonzero singular values.</p>
<p><span class="parmname">rwork(3)</span> is the number of the computed singular values that are larger than the underflow threshold.</p>
<p><span class="parmname">rwork(4)</span> is the number of sweeps of Jacobi rotations needed for numerical convergence.</p>
<p><span class="parmname">rwork(5) </span>=<samp class="codeph"> max_{i<span class="eqsymbol">≠</span>j} |COS(A(:,i),A(:,j))|</samp> in the last sweep. This is useful information in cases when <span class="option">?gesvj</span> did not converge, as it can be used to estimate whether the output is still useful and for post festum analysis.</p>
<p><span class="parmname">rwork(6) </span>is the largest absolute value over all sines of the Jacobi rotation angles in the last sweep. It can be useful for a post festum analysis.</p>
</dd>
<dt class="dlterm"><span class="parmname">info</span></dt>

<dd><p><span class="keyword">INTEGER</span>.</p>
<p>If <samp class="codeph"><span class="parmname">info</span> = 0</samp>, the execution is successful.</p>
<p>If <samp class="codeph"><span class="parmname">info</span> = <var>-i</var></samp>, the <var>i</var>-th parameter had an illegal value.</p>
<p>If <samp class="codeph"><span class="parmname">info</span> &gt; 0</samp>, the function did not converge in the maximal number (30) of sweeps. The output may still be useful. See the description of <span class="parmname">work</span> or <span class="parmname">rwork</span>.</p>
</dd>
</dl>
</div>
</div>

<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-BDA281B1-921F-4A41-B381-DCD341B0774A.html">Singular Value Decomposition: LAPACK Driver Routines</a></div>
</div>
<div><h2>See Also</h2>
<div class="linklist">
<div><a href="GUID-7D137664-6F3E-4832-BEDD-39EAF5AE9F52.html#GUID-7D137664-6F3E-4832-BEDD-39EAF5AE9F52"><span class="option">?lamch</span></a> </div></div></div>
</body>
</html>
