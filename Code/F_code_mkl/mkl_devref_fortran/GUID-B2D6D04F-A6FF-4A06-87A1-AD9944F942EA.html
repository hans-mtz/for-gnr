<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0016)http://localhost -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="DC.Type" content="FunctionRef"/>
<meta name="DC.Title" content="p?laqr2"/>
<meta name="abstract" content="Performs the orthogonal/unitary similarity transformation of a Hessenberg matrix to detect and deflate fully converged eigenvalues from a trailing principal submatrix (aggressive early deflation)."/>
<meta name="description" content="Performs the orthogonal/unitary similarity transformation of a Hessenberg matrix to detect and deflate fully converged eigenvalues from a trailing principal submatrix (aggressive early deflation)."/>
<meta name="DC.subject" content="pslaqr2, ScaLAPACK routines, auxiliary routines, pdlaqr2, Hessenberg matrix"/>
<meta name="keywords" content="pslaqr2, ScaLAPACK routines, auxiliary routines, pdlaqr2, Hessenberg matrix"/>
<meta name="DC.Relation" scheme="URI" content="GUID-BF7438B3-BB55-478A-88DB-33C01481F990.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-97273960-E4A4-4016-8667-BE6A36156792.html#GUID-97273960-E4A4-4016-8667-BE6A36156792"/>
<meta name="DC.Relation" scheme="URI" content="http://www.intel.com/software/products/softwaredocs_feedback"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-B2D6D04F-A6FF-4A06-87A1-AD9944F942EA"/>
<meta name="DC.Language" content="en-US"/>
<link rel="stylesheet" type="text/css" href="intel_css_styles.css"/>
<title>p?laqr2</title>

</head>
<body id="GUID-B2D6D04F-A6FF-4A06-87A1-AD9944F942EA">
 <!-- ==============(Start:NavScript)================= -->
 <script src="NavScript.js" language="JavaScript1.2" type="text/javascript"></script>
 <script language="JavaScript1.2" type="text/javascript">WriteNavLink(0);</script>
 <!-- ==============(End:NavScript)================= -->
<p id="header_text" style="margin-bottom : 20pt"><em>Intel&reg; oneAPI Math Kernel Library Developer Reference - Fortran</em></p>


<h1 class="topictitle1"><span class="option">p?laqr2</span></h1>
<!--Performs the orthogonal/unitary similarity transformation of a Hessenberg matrix to detect and deflate fully converged eigenvalues from a trailing principal submatrix (aggressive early deflation).--><div><p class="shortdesc">Performs the orthogonal/unitary similarity transformation of a Hessenberg matrix to detect and deflate fully converged eigenvalues from a trailing principal submatrix (aggressive early deflation).</p>
<div class="section" id="GUID-4880442A-B49F-42EF-AF55-6CD25F01AE7C"><h2 class="sectiontitle">Syntax</h2><dl class="dlsyntax"><p class="dlsyntaxpara"><span class="kwd">call pslaqr2</span><span class="delim">(</span><span class="var"> wantt</span><span class="sep">, </span><span class="var">wantz</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">ktop</span><span class="sep">, </span><span class="var">kbot</span><span class="sep">, </span><span class="var">nw</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">desca</span><span class="sep">, </span><span class="var">iloz</span><span class="sep">, </span><span class="var">ihiz</span><span class="sep">, </span><span class="var">z</span><span class="sep">, </span><span class="var">descz</span><span class="sep">, </span><span class="var">ns</span><span class="sep">, </span><span class="var">nd</span><span class="sep">, </span><span class="var">sr</span><span class="sep">, </span><span class="var">si</span><span class="sep">, </span><span class="var">t</span><span class="sep">, </span><span class="var">ldt</span><span class="sep">, </span><span class="var">v</span><span class="sep">, </span><span class="var">ldv</span><span class="sep">, </span><span class="var">wr</span><span class="sep">, </span><span class="var">wi</span><span class="sep">, </span><span class="var">work</span><span class="sep">, </span><span class="var">lwork </span><span class="delim">)</span></p><p class="dlsyntaxpara"><span class="kwd">call pdlaqr2</span><span class="delim">(</span><span class="var"> wantt</span><span class="sep">, </span><span class="var">wantz</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">ktop</span><span class="sep">, </span><span class="var">kbot</span><span class="sep">, </span><span class="var">nw</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">desca</span><span class="sep">, </span><span class="var">iloz</span><span class="sep">, </span><span class="var">ihiz</span><span class="sep">, </span><span class="var">z</span><span class="sep">, </span><span class="var">descz</span><span class="sep">, </span><span class="var">ns</span><span class="sep">, </span><span class="var">nd</span><span class="sep">, </span><span class="var">sr</span><span class="sep">, </span><span class="var">si</span><span class="sep">, </span><span class="var">t</span><span class="sep">, </span><span class="var">ldt</span><span class="sep">, </span><span class="var">v</span><span class="sep">, </span><span class="var">ldv</span><span class="sep">, </span><span class="var">wr</span><span class="sep">, </span><span class="var">wi</span><span class="sep">, </span><span class="var">work</span><span class="sep">, </span><span class="var">lwork </span><span class="delim">)</span></p></dl></div>
<div class="section" id="GUID-320F4DA4-7D78-4DD3-9840-6259500CE2E5"><h2 class="sectiontitle">Description</h2><p><span class="option">p?laqr2</span> accepts as input an upper Hessenberg matrix <var>A </var> and performs an orthogonal similarity transformation designed to detect and deflate fully converged eigenvalues from a trailing principal submatrix.  On output <var>A</var>is overwritten by a new Hessenberg matrix that is a perturbation of an orthogonal similarity transformation of <var>A</var>.  It is to be hoped that the final version of <var>A</var> has many zero subdiagonal entries. </p>
<p>This <span>routine </span>handles small deflation windows which is affordable by one processor. Normally, it is called by <a href="GUID-92F38ECF-79CA-4D58-8331-E1C38B7775C6.html"><span class="option">p?laqr1</span></a>. All the inputs are assumed to be valid without checking. </p>
<p>
<div class="tablenoborder"><table cellpadding="4" summary="" id="d433e46" frame="border" border="1" cellspacing="0" rules="all"><thead align="left"><tr><th class="cellrowborder" align="left" valign="top" width="100%" id="d1340863e293"><p id="d433e52">Optimization Notice 
              </p>
</th>
</tr>
</thead>
<tbody><tr><td class="bgcolor(#f5f5f5)" bgcolor="#f5f5f5" valign="top" width="100%" headers="d1340863e293 "><p>Intel's compilers may or may not optimize to the same degree for non-Intel microprocessors for optimizations that are not unique to Intel microprocessors. These optimizations include SSE2, SSE3, and SSSE3 instruction sets and other optimizations. Intel does not guarantee the availability, functionality, or effectiveness of any optimization on microprocessors not manufactured by Intel. Microprocessor-dependent optimizations in this product are intended for use with Intel microprocessors. Certain optimizations not specific to Intel microarchitecture are reserved for Intel microprocessors. Please refer to the applicable product User and Reference Guides for more information regarding the specific instruction sets covered by this notice. 
              </p>
<p> Notice revision #20110804 
              </p>
</td>
</tr>
</tbody>
</table>
</div>
 This notice covers the following instruction sets: SSE2, SSE4.2, AVX2, AVX-512. 
    </p>
</div>
<div class="section" id="GUID-5C8C8395-4FFC-42AC-86FC-34D5D10BDE5D"><h2 class="sectiontitle">Input Parameters</h2><dl id="GUID-D257DD3D-CEC0-4FB7-B4A8-D6A884460240"><dt class="dlterm"><span class="parmname">wantt</span></dt>

<dd><p>(global ) <span class="keyword">LOGICAL</span></p>
<p>If <span class="keyword">.TRUE.</span>, then the Hessenberg matrix <var>A </var> is fully updated so that the quasi-triangular Schur factor may be computed (in cooperation with the calling <span>subroutine</span>).</p>
<p>If <span class="keyword">.FALSE.</span>, then only enough of <var>A</var> is updated to preserve the eigenvalues.</p>
</dd>
<dt class="dlterm"><span class="parmname">wantz</span></dt>

<dd><p>(global ) <span class="keyword">LOGICAL</span></p>
<p>If <span class="keyword">.TRUE.</span>, then the orthogonal matrix <var>Z</var> is updated so that the orthogonal Schur factor may be computed (in cooperation with the calling <span>subroutine</span>).</p>
<p>If <span class="keyword">.FALSE.</span>, then <span class="parmname">z</span> is not referenced.</p>
</dd>
<dt class="dlterm"><span class="parmname">n</span></dt>

<dd><p>(global ) <span class="keyword">INTEGER</span></p>
<p>The order of the matrix <var>A </var> and (if <span class="parmname">wantz</span> is <span><span class="keyword">.TRUE.</span></span>) the order of the orthogonal matrix <var>Z</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">ktop</span>, <span class="parmname">kbot</span></dt>

<dd><p>(global ) <span class="keyword">INTEGER</span></p>
<p>It is assumed without a check that either <span class="parmname">kbot</span> = <span class="parmname">n</span> or <var>A</var>(<span class="parmname">kbot</span>+1,<span class="parmname">kbot</span>)=0.  <span class="parmname">kbot</span> and <span class="parmname">ktop</span> together determine an isolated block along the diagonal of the Hessenberg matrix. However, <var>A</var>(<span class="parmname">ktop</span>,<span class="parmname">ktop</span>-1)=0 is not essentially necessary if <span class="parmname">wantt</span> is <span><span class="keyword">.TRUE.</span></span> .</p>
</dd>
<dt class="dlterm"><span class="parmname">nw</span></dt>

<dd><p>(global ) <span class="keyword">INTEGER</span></p>
<p>Deflation window size.  1 <span class="eqsymbol">≤</span><span class="parmname">nw</span><span class="eqsymbol">≤</span> (<span class="parmname">kbot</span>-<span class="parmname">ktop</span>+1). Normally <span class="parmname">nw</span><span class="eqsymbol">≥</span> 3 if <span class="option">p?laqr2</span> is called by <span class="option">p?laqr1</span>.</p>
</dd>
<dt class="dlterm"><span class="parmname">a</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">pslaqr2</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">pdlaqr2</span></p>
<p>(local )             array of size <span>(<var>lld_a</var>,<span><var>LOC</var><sub><var>c</var></sub></span>(<span class="parmname">n</span>))</span></p>
<p>The initial <span class="parmname">n</span>-by-<span class="parmname">n</span> section of <span class="parmname">a</span> stores the Hessenberg matrix undergoing aggressive early deflation.</p>
</dd>
<dt class="dlterm"><span class="parmname">desca</span></dt>

<dd><p>(global and local) <span><span class="keyword">INTEGER</span></span> array of size <var>dlen_</var>.</p>
<p>The array descriptor for the distributed matrix <var>A</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">iloz</span>, <span class="parmname">ihiz</span></dt>

<dd><p>(global ) <span class="keyword">INTEGER</span></p>
<p>Specify the rows of <span class="parmname">z </span>to which transformations must be applied if <span class="parmname">wantz</span> is <span><span class="keyword">.TRUE.</span></span>. 1 <span class="eqsymbol">≤</span><span class="parmname">iloz</span><span class="eqsymbol">≤</span><span class="parmname">ihiz</span><span class="eqsymbol">≤</span><span class="parmname">n</span>.</p>
</dd>
<dt class="dlterm"><span class="parmname">z</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">pslaqr2</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">pdlaqr2</span></p>
<p>Array of size <span>(<var>lld_z</var>,<span><var>LOC</var><sub><var>c</var></sub></span>(<span class="parmname">n</span>))</span></p>
<p>If <span class="parmname">wantz</span> is <span><span class="keyword">.TRUE.</span></span>, then on output, the orthogonal similarity transformation mentioned above has been accumulated into <span class="parmname">z</span>(<span class="parmname">iloz</span>:<span class="parmname">ihiz</span>,</p>
<p><span class="parmname">kbot</span>:<span class="parmname">ktop</span>) from the right.</p>
<p>If <span class="parmname">wantz</span> is <span><span class="keyword">.FALSE.</span></span>, then <span class="parmname">z</span> is unreferenced.</p>
</dd>
<dt class="dlterm"><span class="parmname">descz</span></dt>

<dd><p>(global and local) <span><span class="keyword">INTEGER</span></span> array of size <var>dlen_</var>.</p>
<p>The array descriptor for the distributed matrix <var>Z</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">t</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">pslaqr2</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">pdlaqr2</span></p>
<p>(local workspace)             array of size <span><span class="parmname">ldt</span>*<span class="parmname">nw</span></span>.</p>
</dd>
<dt class="dlterm"><span class="parmname">ldt</span></dt>

<dd><p>(local ) <span class="keyword">INTEGER</span></p>
<p>The leading dimension of the array <span class="parmname">t</span>. <span class="parmname">ldt</span><span class="eqsymbol">≥</span><span class="parmname">nw</span>.</p>
</dd>
<dt class="dlterm"><span class="parmname">v</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">pslaqr2</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">pdlaqr2</span></p>
<p>(local workspace)             array of size <span><span class="parmname">ldv</span>*<span class="parmname">nw</span></span>.</p>
</dd>
<dt class="dlterm"><span class="parmname">ldv</span></dt>

<dd><p>(local ) <span class="keyword">INTEGER</span></p>
<p>The leading dimension of the array <span class="parmname">v</span>. <span class="parmname">ldv</span><span class="eqsymbol">≥</span><span class="parmname">nw</span>.</p>
</dd>
<dt class="dlterm"><span class="parmname">wr</span>, <span class="parmname">wi</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">pslaqr2</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">pdlaqr2</span></p>
<p>(local workspace)             array of size <span class="parmname">kbot</span>.</p>
</dd>
<dt class="dlterm"><span class="parmname">work</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">pslaqr2</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">pdlaqr2</span></p>
<p>(local workspace)             array of size <span class="parmname">lwork</span>.</p>
</dd>
<dt class="dlterm"><span class="parmname">lwork</span></dt>

<dd><p>(local ) <span class="keyword">INTEGER</span></p>
<p><span class="parmname">work</span>(<span class="parmname">lwork</span>) is a local array and <span class="parmname">lwork</span> is assumed big enough so that <span class="parmname">lwork</span><span class="eqsymbol">≥</span><span class="parmname">nw</span>*<span class="parmname">nw</span>.</p>
</dd>
</dl>
</div>
<div class="section" id="GUID-4697B60A-B117-4B2B-88A6-6752E230795F"><h2 class="sectiontitle">OUTPUT Parameters</h2><dl id="GUID-0DA6D0EF-E7A9-43E3-A854-F71A43DA4C5F"><dt class="dlterm"><span class="parmname">a</span></dt>

<dd><p>On output <span class="parmname">a</span> has been transformed by an orthogonal similarity transformation, perturbed, and returned to Hessenberg form that (it is to be hoped) has some zero subdiagonal entries.</p>
</dd>
<dt class="dlterm"><span class="parmname">z</span></dt>

<dd/>
<dt class="dlterm"><span class="parmname">ns</span></dt>

<dd><p>(global ) <span class="keyword">INTEGER</span></p>
<p>The number of unconverged (that is, approximate) eigenvalues returned in <span class="parmname">sr</span> and <span class="parmname">si</span> that may be used as shifts by the calling <span>subroutine</span>.</p>
</dd>
<dt class="dlterm"><span class="parmname">nd</span></dt>

<dd><p>(global ) <span class="keyword">INTEGER</span></p>
<p>The number of converged eigenvalues uncovered by this <span>subroutine</span>.</p>
</dd>
<dt class="dlterm"><span class="parmname">sr</span>, <span class="parmname">si</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">pslaqr2</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">pdlaqr2</span></p>
<p>(global )             array of size <span class="parmname">kbot</span></p>
<p>On output, the real and imaginary parts of approximate eigenvalues that may be used for shifts are stored in <span><span class="parmname">sr</span>(<span class="parmname">kbot</span>-<span class="parmname">nd</span>-<span class="parmname">ns</span>+1) through <span class="parmname">sr</span>(<span class="parmname">kbot</span>-<span class="parmname">nd</span>) and <span class="parmname">si</span>(<span class="parmname">kbot</span>-<span class="parmname">nd</span>-<span class="parmname">ns</span>+1) through <span class="parmname">si</span>(<span class="parmname">kbot</span>-<span class="parmname">nd</span>)</span>, respectively.</p>
<p>On processor #0, the real and imaginary parts of converged eigenvalues are stored in <span><span class="parmname">sr</span>(<span class="parmname">kbot</span>-<span class="parmname">nd</span>+1) through <span class="parmname">sr</span>(<span class="parmname">kbot</span>) and <span class="parmname">si</span>(<span class="parmname">kbot</span>-<span class="parmname">nd</span>+1) through <span class="parmname">si</span>(<span class="parmname">kbot</span>)</span>, respectively. On other processors, these entries are set to zero.</p>
</dd>
</dl>
</div>
</div>

<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-BF7438B3-BB55-478A-88DB-33C01481F990.html">ScaLAPACK Auxiliary Routines</a></div>
</div>
<div class="See Also"><h2>See Also</h2>
<div class="linklist">
<div><a href="GUID-97273960-E4A4-4016-8667-BE6A36156792.html#GUID-97273960-E4A4-4016-8667-BE6A36156792">Overview</a> for details of ScaLAPACK  array descriptor structures and related notations.</div></div></div>
</body>
</html>
