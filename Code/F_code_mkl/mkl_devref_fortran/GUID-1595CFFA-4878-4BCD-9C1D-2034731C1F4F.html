<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0016)http://localhost -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="DC.Type" content="FunctionRef"/>
<meta name="DC.Title" content="vRngGaussianMV"/>
<meta name="abstract" content="Generates random numbers from multivariate normal distribution."/>
<meta name="description" content="Generates random numbers from multivariate normal distribution."/>
<meta name="DC.subject" content="vector statistics functions, GaussianMV, VS routines, generator routines"/>
<meta name="keywords" content="vector statistics functions, GaussianMV, VS routines, generator routines"/>
<meta name="DC.Relation" scheme="URI" content="GUID-D68AFDA3-7B43-4AF2-AD02-EEFAB9868738.html"/>
<meta name="DC.Relation" scheme="URI" content="http://www.intel.com/software/products/softwaredocs_feedback"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-1595CFFA-4878-4BCD-9C1D-2034731C1F4F"/>
<meta name="DC.Language" content="en-US"/>
<link rel="stylesheet" type="text/css" href="intel_css_styles.css"/>
<title>vRngGaussianMV</title>

</head>
<body id="GUID-1595CFFA-4878-4BCD-9C1D-2034731C1F4F">
 <!-- ==============(Start:NavScript)================= -->
 <script src="NavScript.js" language="JavaScript1.2" type="text/javascript"></script>
 <script language="JavaScript1.2" type="text/javascript">WriteNavLink(0);</script>
 <!-- ==============(End:NavScript)================= -->
<p id="header_text" style="margin-bottom : 20pt"><em>Intel&reg; oneAPI Math Kernel Library Developer Reference - Fortran</em></p>


<h1 class="topictitle1"><span class="option">vRngGaussianMV</span></h1>
<!--Generates random numbers from multivariate normal distribution.--><div><p class="shortdesc">Generates random numbers from multivariate normal distribution.</p>
<div class="section" id="GUID-4E70C457-6577-4372-B57E-CE5F981352EA"><h2 class="sectiontitle">Syntax</h2><dl class="dlsyntax"><p class="dlsyntaxpara"><span class="var">status</span><span class="delim"> = </span><span class="kwd">vsrnggaussianmv</span><span class="sep">( </span><span class="var">method</span><span class="sep">, </span><span class="var">stream</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">r</span><span class="sep">, </span><span class="var">dimen</span><span class="sep">, </span><span class="var">mstorage</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">t</span><span class="sep"> )</span></p><p class="dlsyntaxpara"><span class="var">status</span><span class="delim"> = </span><span class="kwd">vdrnggaussianmv</span><span class="sep">( </span><span class="var">method</span><span class="sep">, </span><span class="var">stream</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">r</span><span class="sep">, </span><span class="var">dimen</span><span class="sep">, </span><span class="var">mstorage</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">t</span><span class="sep"> )</span></p></dl></div>
<div class="section" id="GUID-38427C97-B84A-424D-A0CF-7202BF49AA8B"><h2 class="sectiontitle">Include Files</h2><ul id="d163e194"><li><span class="filepath">mkl.fi</span>, <span class="filepath">mkl_vsl.f90</span></li>
</ul>
</div>
<div class="section" id="GUID-05B02E18-5071-46FE-AF04-F67EE301CCA1"><h2 class="sectiontitle">Input Parameters</h2><table cellpadding="4" cellspacing="0" summary="" border="0" class="ParamTbl"><tr><th valign="bottom" align="left" id="d206100e141" width="12.396694214876034%"><p>Name</p>
</th>
<th valign="bottom" align="left" id="d206100e144" width="31.40495867768595%"><p>Type</p>
</th>
<th valign="bottom" align="left" id="d206100e147" width="56.19834710743802%"><p>Description</p>
</th>
</tr>
<tr><td valign="top" headers="d206100e141"><p><span class="parmname">method</span></p>
</td>
<td valign="top" headers="d206100e144"><p><span class="keyword">INTEGER</span>, <span class="keyword">INTENT(IN)</span></p>
</td>
<td valign="top" headers="d206100e147"><p>Generation method. The specific values are as follows: <pre><span class="keyword">VSL_RNG_METHOD_GAUSSIANMV_BOXMULLER</span></pre><pre><span class="keyword">VSL_RNG_METHOD_GAUSSIANMV_BOXMULLER2</span></pre><pre><span class="keyword">VSL_RNG_METHOD_GAUSSIANMV_ICDF</span></pre></p>
<p>See brief description of the methods <span class="keyword">BOXMULLER</span>,  <span class="keyword">BOXMULLER2</span>, and <span class="keyword">ICDF</span> in <a href="GUID-497D6D91-5031-4DCC-AE46-82B7EEF65AFE.html#TBL10-1">Table <span>"Values of <samp class="codeph">&lt;<var>method</var>&gt;</samp> in <span class="parmname">method</span> parameter"</span></a></p>
</td>
</tr>
<tr><td valign="top" headers="d206100e141"><p><span class="parmname">stream</span></p>
</td>
<td valign="top" headers="d206100e144"><p><span class="keyword">TYPE (VSL_STREAM_STATE)</span>, <span class="keyword">INTENT(IN)</span></p>
</td>
<td valign="top" headers="d206100e147"><p>Descriptor of the stream state structure.</p>
</td>
</tr>
<tr><td valign="top" headers="d206100e141"><p><span class="parmname">n</span></p>
</td>
<td valign="top" headers="d206100e144"><p><span class="keyword">INTEGER</span>, <span class="keyword">INTENT(IN)</span></p>
</td>
<td valign="top" headers="d206100e147"><p>Number of <var>d</var>-dimensional vectors to be generated</p>
</td>
</tr>
<tr><td valign="top" headers="d206100e141"><p><span class="parmname">dimen</span></p>
</td>
<td valign="top" headers="d206100e144"><p><b class="parmname" style="color:#0033ff">Fortran  90: </b><span class="keyword">INTEGER</span>, <span class="keyword">INTENT(IN)</span></p>
</td>
<td valign="top" headers="d206100e147"><p>Dimension <samp class="codeph"><var>d</var> ( <var>d</var><span class="eqsymbol"> ≥</span> 1)</samp> of output random vectors</p>
</td>
</tr>
<tr><td valign="top" headers="d206100e141"><p><span class="parmname">mstorage</span></p>
</td>
<td valign="top" headers="d206100e144"><p><span class="keyword">INTEGER</span>, <span class="keyword">INTENT(IN)</span></p>
</td>
<td valign="top" headers="d206100e147"><p>Matrix storage scheme for upper triangular matrix <samp class="codeph"><var>T</var><sup class="power"><var>T</var></sup></samp>. The routine supports three matrix storage schemes:</p>
<ul class="bullet" id="GUID-752E42DE-78BB-4064-BE62-155EA27C486F"><li><p><span class="keyword">VSL_MATRIX_STORAGE_FULL</span><span class="eqsymbol">—</span> all <samp class="codeph"><var>d</var> x <var>d</var></samp> elements of the matrix <samp class="codeph"><var>T</var><sup class="power"><var>T</var></sup></samp> are passed, however, only the upper triangle part is actually used in the routine.</p>
</li>
<li><p><span class="keyword">VSL_MATRIX_STORAGE_PACKED</span><span class="eqsymbol">—</span> upper triangle elements of <samp class="codeph"><var>T</var><sup class="power"><var>T</var></sup></samp> are packed by rows into a one-dimensional array.</p>
</li>
<li><p><span class="keyword">VSL_MATRIX_STORAGE_DIAGONAL</span><span class="eqsymbol">—</span> only diagonal elements of <samp class="codeph"><var>T</var><sup class="power"><var>T</var></sup></samp> are passed.</p>
</li>
</ul>
</td>
</tr>
<tr><td valign="top" headers="d206100e141"><p><span class="parmname">a</span></p>
</td>
<td valign="top" headers="d206100e144"><p><span class="keyword">DOUBLE PRECISION</span> for <span class="keyword">vdrnggaussianmv</span></p>
<p><span class="keyword">REAL</span><span class="keyword">(KIND=4)</span>, <span class="keyword">INTENT(IN)</span> for <span class="keyword">vsrnggaussianmv</span></p>
<p><span class="keyword">REAL</span><span class="keyword">(KIND=8)</span>, <span class="keyword">INTENT(IN)</span> for <span class="keyword">vdrnggaussianmv</span></p>
</td>
<td valign="top" headers="d206100e147"><p>Mean vector <var>a</var> of dimension <var>d</var></p>
</td>
</tr>
<tr><td valign="top" headers="d206100e141"><p><span class="parmname">t</span></p>
</td>
<td valign="top" headers="d206100e144"><p><span class="keyword">DOUBLE PRECISION</span> for <span class="keyword">vdrnggaussianmv</span></p>
<p><span class="keyword">REAL</span><span class="keyword">(KIND=4)</span>, <span class="keyword">INTENT(IN)</span> for <span class="keyword">vsrnggaussianmv</span></p>
<p><span class="keyword">REAL</span><span class="keyword">(KIND=8)</span>, <span class="keyword">INTENT(IN)</span> for <span class="keyword">vdrnggaussianmv</span></p>
</td>
<td valign="top" headers="d206100e147"><p>Elements of the upper triangular matrix passed according to the matrix <samp class="codeph"><var>T</var><sup class="power"><var>T</var></sup></samp> storage scheme <var>mstorage</var>.</p>
</td>
</tr>
</table>
</div>
<div class="section" id="GUID-5E66B706-E50E-4469-9CD6-5F705F880044"><h2 class="sectiontitle">Output Parameters</h2><table cellpadding="4" cellspacing="0" summary="" border="0" class="ParamTbl"><tr><th valign="bottom" align="left" id="d206100e421" width="12.396694214876034%"><p>Name</p>
</th>
<th valign="bottom" align="left" id="d206100e424" width="31.40495867768595%"><p>Type</p>
</th>
<th valign="bottom" align="left" id="d206100e427" width="56.19834710743802%"><p>Description</p>
</th>
</tr>
<tr><td valign="top" headers="d206100e421"><p><span class="parmname">r</span></p>
</td>
<td valign="top" headers="d206100e424"><p><span class="keyword">DOUBLE PRECISION</span> for <span class="keyword">vdrnggaussianmv</span></p>
<p><span class="keyword">REAL</span><span class="keyword">(KIND=4)</span>, <span class="keyword">INTENT(OUT)</span> for <span class="keyword">vsrnggaussianmv</span></p>
<p><span class="keyword">REAL</span><span class="keyword">(KIND=8)</span>, <span class="keyword">INTENT(OUT)</span> for <span class="keyword">vdrnggaussianmv</span></p>
</td>
<td valign="top" headers="d206100e427"><p>Array of <var>n</var> random vectors of dimension <var>dimen</var></p>
</td>
</tr>
</table>
</div>
<div class="section" id="GUID-BF819228-863C-42C2-8934-C1567429F976"><h2 class="sectiontitle">Description</h2><p><span/>The <span class="option">vRngGaussianMV</span> function generates random numbers with <var>d</var>-variate normal (Gaussian) distribution with mean value <span class="option">a</span> and variance-covariance matrix <var>C</var>, where <samp class="codeph"><var>a</var><span class="eqsymbol">∈</span><var>R</var><sup><var>d</var></sup>; <var>C</var></samp> is a <samp class="codeph"><var>d</var><span class="eqsymbol">×</span><var>d</var></samp> symmetric positive-definite matrix.</p>
<p>The probability density function is given by:</p>
<p><br/><div class="imagecenter"><img src="GUID-59929C40-2AE7-4CE6-A765-41A3CD53279B-low.gif" alt="Equation" align="center" class=".eq"/></div><br/></p>
<p>where <samp class="codeph"><var>x</var><span class="eqsymbol">∈</span><var>R</var><sup><var>d</var></sup></samp> .</p>
<p>Matrix <var>C</var> can be represented as <samp class="codeph"><var>C</var> = <var>TT</var><sup class="power"><var>T</var></sup></samp>, where <var>T</var> is a lower triangular matrix - Cholesky factor of <var>C</var>.</p>
<p>Instead of variance-covariance matrix <var>C</var> the generation routines require Cholesky factor of <var>C</var> in input. To compute Cholesky factor of matrix <var>C</var>, the user may call Intel&reg; oneAPI Math Kernel Library LAPACK routines for matrix factorization:<a href="GUID-15A9E907-2600-430B-BF11-DFA0A375711B.html#GUID-15A9E907-2600-430B-BF11-DFA0A375711B"><span class="option">?potrf</span></a> or <a href="GUID-B472B068-3BEE-49E9-8870-9E7CD87237BF.html#GUID-B472B068-3BEE-49E9-8870-9E7CD87237BF"><span class="option">?pptrf</span></a> for  <span class="option">v?RngGaussianMV</span>/<span class="option">v?rnggaussianmv</span> routines (<span class="keyword">?</span> means either <span class="keyword">s</span> or <span class="keyword">d</span> for single and double precision respectively). See <a href="#FGAUSSIANMV_AN">Application Notes</a> for more details.</p>
<p>
<div class="tablenoborder"><table cellpadding="4" summary="" id="d433e46" frame="border" border="1" cellspacing="0" rules="all"><thead align="left"><tr><th class="cellrowborder" align="left" valign="top" width="100%" id="d206100e612"><p id="d433e52">Optimization Notice 
              </p>
</th>
</tr>
</thead>
<tbody><tr><td class="bgcolor(#f5f5f5)" bgcolor="#f5f5f5" valign="top" width="100%" headers="d206100e612 "><p>Intel's compilers may or may not optimize to the same degree for non-Intel microprocessors for optimizations that are not unique to Intel microprocessors. These optimizations include SSE2, SSE3, and SSSE3 instruction sets and other optimizations. Intel does not guarantee the availability, functionality, or effectiveness of any optimization on microprocessors not manufactured by Intel. Microprocessor-dependent optimizations in this product are intended for use with Intel microprocessors. Certain optimizations not specific to Intel microarchitecture are reserved for Intel microprocessors. Please refer to the applicable product User and Reference Guides for more information regarding the specific instruction sets covered by this notice. 
              </p>
<p> Notice revision #20110804 
              </p>
</td>
</tr>
</tbody>
</table>
</div>
 This notice covers the following instruction sets: SSE2, SSE4.2, AVX2, AVX-512. 
    </p>
</div>
<div class="section" id="FGAUSSIANMV_AN"><h2 class="sectiontitle">Application Notes</h2><p>Since matrices are stored in Fortran by columns, while in C they are stored by rows, the usage of Intel&reg; oneAPI Math Kernel Library factorization routines (assuming Fortran matrices storage) in combination with multivariate normal RNG (assuming C matrix storage) is slightly different in C and Fortran. The following tables help in using these routines in C and Fortran. For further information please refer to the appropriate VS example file.</p>

<div class="tablenoborder"><table cellpadding="4" summary="" id="TBL10-10" class="AllLineLong" frame="hsides" border="1" rules="all"><caption><span class="tablecap">Using Cholesky Factorization Routines in Fortran</span></caption><thead align="left"><tr><th class="cellrowborder" valign="top" width="29.292929292929294%" id="d206100e642"><p>Matrix Storage Scheme</p>
</th>
<th class="cellrowborder" valign="top" width="21.21212121212121%" id="d206100e645"><p>Variance-Covariance Matrix Argument</p>
</th>
<th class="cellrowborder" valign="top" width="20.2020202020202%" id="d206100e648"><p>Factorization Routine</p>
</th>
<th class="cellrowborder" valign="top" width="14.14141414141414%" id="d206100e651"><p>UPLO Parameter in Factorization Routine</p>
</th>
<th class="row-nocellborder" valign="top" width="15.151515151515152%" id="d206100e654"><p>Result of Factorization as Input Argument for RNG</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="29.292929292929294%" headers="d206100e642 "><p><span class="keyword">VSL_MATRIX_STORAGE_FULL</span></p>
</td>
<td class="cellrowborder" valign="top" width="21.21212121212121%" headers="d206100e645 "><p><var>C</var> in Fortran two-dimensional array</p>
</td>
<td class="cellrowborder" valign="top" width="20.2020202020202%" headers="d206100e648 "><p><span class="keyword">spotrf</span> for <span class="keyword">vsrnggaussianmv</span></p>
<p><span class="keyword">dpotrf</span> for <span class="keyword">vdrnggaussianmv</span></p>
</td>
<td class="cellrowborder" valign="top" width="14.14141414141414%" headers="d206100e651 "><p>‘U’</p>
</td>
<td class="row-nocellborder" valign="top" width="15.151515151515152%" headers="d206100e654 "><p>Upper triangle of <samp class="codeph"><var>T</var><sup class="power"><var>T</var></sup></samp>. Lower triangle is not used.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="29.292929292929294%" headers="d206100e642 "><p><span class="keyword">VSL_MATRIX_STORAGE_PACKED</span></p>
</td>
<td class="cellrowborder" valign="top" width="21.21212121212121%" headers="d206100e645 "><p>Lower triangle of <var>C</var> packed by columns into one-dimensional array</p>
</td>
<td class="cellrowborder" valign="top" width="20.2020202020202%" headers="d206100e648 "><p><span class="keyword">spptrf</span> for <span class="keyword">vsrnggaussianmv</span></p>
<p><span class="keyword">dpptrf</span> for <span class="keyword">vdrnggaussianmv</span></p>
</td>
<td class="cellrowborder" valign="top" width="14.14141414141414%" headers="d206100e651 "><p>‘L’</p>
</td>
<td class="row-nocellborder" valign="top" width="15.151515151515152%" headers="d206100e654 "><p>Upper triangle of <samp class="codeph"><var>T</var><sup class="power"><var>T</var></sup></samp> packed by rows  into a one-dimensional array.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="RETURNVALUES_AEF3C87B88F64156A91F61A1121FF456"><h2 class="sectiontitle">Return Values</h2><dl id="GUID-DA7B9436-C985-4F2C-BA53-CEC35F16375F"><dt class="dlterm"><span class="keyword">VSL_ERROR_OK</span>, <span class="keyword">VSL_STATUS_OK</span></dt>

<dd class="ddretval"><p>Indicates no error, execution is successful.</p>
</dd>
<dt class="dlterm"><span class="keyword">VSL_ERROR_NULL_PTR</span></dt>

<dd class="ddretval"><p><span class="parmname">stream</span> is a <span class="keyword">NULL</span> pointer.</p>
</dd>
<dt class="dlterm"><span class="keyword">VSL_RNG_ERROR_BAD_STREAM</span></dt>

<dd class="ddretval"><p><var>stream</var> is not a valid random stream.</p>
</dd>
<dt class="dlterm"><span class="keyword">VSL_RNG_ERROR_BAD_UPDATE</span></dt>

<dd class="ddretval"><p>Callback function for an abstract BRNG returns an invalid number of updated entries in a buffer, that is, <samp class="codeph">&lt; 0</samp> or <samp class="codeph">&gt; <span class="keyword">nmax</span></samp>.</p>
</dd>
<dt class="dlterm"><span class="keyword">VSL_RNG_ERROR_NO_NUMBERS</span></dt>

<dd class="ddretval"><p>Callback function for an abstract BRNG returns 0 as the number of updated entries in a buffer.</p>
</dd>
<dt class="dlterm"><span class="keyword">VSL_RNG_ERROR_QRNG_PERIOD_ELAPSED</span></dt>

<dd class="ddretval"><p>Period of the generator has been exceeded.</p>
</dd>
<dt class="dlterm"><span class="keyword">VSL_RNG_ERROR_NONDETERM_NRETRIES_EXCEEDED</span></dt>

<dd class="ddretval"><p>Number of retries to generate a random number by using non-deterministic random number generator exceeds threshold.</p>
</dd>
<dt class="dlterm"><span class="keyword">VSL_RNG_ERROR_ARS5_NOT_SUPPORTED </span></dt>

<dd class="ddretval"><p>ARS-5 random number generator is not supported on the CPU running the application.</p>
</dd>
</dl>
</div>
</div>

<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-D68AFDA3-7B43-4AF2-AD02-EEFAB9868738.html">Continuous Distributions</a></div>
</div>
<div/>
</body>
</html>
