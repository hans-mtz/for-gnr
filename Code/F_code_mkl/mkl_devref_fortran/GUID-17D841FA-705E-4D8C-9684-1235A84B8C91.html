<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0016)http://localhost -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="DC.Type" content="FunctionRef"/>
<meta name="DC.Title" content="p?lapiv"/>
<meta name="abstract" content="Applies a permutation matrix to a general distributed matrix, resulting in row or column pivoting."/>
<meta name="description" content="Applies a permutation matrix to a general distributed matrix, resulting in row or column pivoting."/>
<meta name="DC.subject" content="p?lapiv, ScaLAPACK routines, auxiliary routines, pivoting matrix rows or columns"/>
<meta name="keywords" content="p?lapiv, ScaLAPACK routines, auxiliary routines, pivoting matrix rows or columns"/>
<meta name="DC.Relation" scheme="URI" content="GUID-BF7438B3-BB55-478A-88DB-33C01481F990.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-97273960-E4A4-4016-8667-BE6A36156792.html#GUID-97273960-E4A4-4016-8667-BE6A36156792"/>
<meta name="DC.Relation" scheme="URI" content="http://www.intel.com/software/products/softwaredocs_feedback"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-17D841FA-705E-4D8C-9684-1235A84B8C91"/>
<meta name="DC.Language" content="en-US"/>
<link rel="stylesheet" type="text/css" href="intel_css_styles.css"/>
<title>p?lapiv</title>

</head>
<body id="GUID-17D841FA-705E-4D8C-9684-1235A84B8C91">
 <!-- ==============(Start:NavScript)================= -->
 <script src="NavScript.js" language="JavaScript1.2" type="text/javascript"></script>
 <script language="JavaScript1.2" type="text/javascript">WriteNavLink(0);</script>
 <!-- ==============(End:NavScript)================= -->
<p id="header_text" style="margin-bottom : 20pt"><em>Intel&reg; oneAPI Math Kernel Library Developer Reference - Fortran</em></p>


<h1 class="topictitle1"><span class="option">p?lapiv</span></h1>
<!--Applies a permutation matrix to a general distributed matrix, resulting in row or column pivoting.--><div><p class="shortdesc">Applies a permutation matrix to a general distributed matrix, resulting in row or column pivoting.</p>
<div class="section" id="GUID-7E4CE308-2ECB-4E29-A3FB-4A462B83FF4C"><h2 class="sectiontitle">Syntax</h2><dl class="dlsyntax"><p class="dlsyntaxpara"><span class="kwd">call pslapiv</span><span class="delim">(</span><span class="var">direc</span><span class="sep">, </span><span class="var">rowcol</span><span class="sep">, </span><span class="var">pivroc</span><span class="sep">, </span><span class="var">m</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">ia</span><span class="sep">, </span><span class="var">ja</span><span class="sep">, </span><span class="var">desca</span><span class="sep">, </span><span class="var">ipiv</span><span class="sep">, </span><span class="var">ip</span><span class="sep">, </span><span class="var">jp</span><span class="sep">, </span><span class="var">descip</span><span class="sep">, </span><span class="var">iwork</span><span class="delim">)</span></p><p class="dlsyntaxpara"><span class="kwd">call pdlapiv</span><span class="delim">(</span><span class="var">direc</span><span class="sep">, </span><span class="var">rowcol</span><span class="sep">, </span><span class="var">pivroc</span><span class="sep">, </span><span class="var">m</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">ia</span><span class="sep">, </span><span class="var">ja</span><span class="sep">, </span><span class="var">desca</span><span class="sep">, </span><span class="var">ipiv</span><span class="sep">, </span><span class="var">ip</span><span class="sep">, </span><span class="var">jp</span><span class="sep">, </span><span class="var">descip</span><span class="sep">, </span><span class="var">iwork</span><span class="delim">)</span></p><p class="dlsyntaxpara"><span class="kwd">call pclapiv</span><span class="delim">(</span><span class="var">direc</span><span class="sep">, </span><span class="var">rowcol</span><span class="sep">, </span><span class="var">pivroc</span><span class="sep">, </span><span class="var">m</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">ia</span><span class="sep">, </span><span class="var">ja</span><span class="sep">, </span><span class="var">desca</span><span class="sep">, </span><span class="var">ipiv</span><span class="sep">, </span><span class="var">ip</span><span class="sep">, </span><span class="var">jp</span><span class="sep">, </span><span class="var">descip</span><span class="sep">, </span><span class="var">iwork</span><span class="delim">)</span></p><p class="dlsyntaxpara"><span class="kwd">call pzlapiv</span><span class="delim">(</span><span class="var">direc</span><span class="sep">, </span><span class="var">rowcol</span><span class="sep">, </span><span class="var">pivroc</span><span class="sep">, </span><span class="var">m</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">ia</span><span class="sep">, </span><span class="var">ja</span><span class="sep">, </span><span class="var">desca</span><span class="sep">, </span><span class="var">ipiv</span><span class="sep">, </span><span class="var">ip</span><span class="sep">, </span><span class="var">jp</span><span class="sep">, </span><span class="var">descip</span><span class="sep">, </span><span class="var">iwork</span><span class="delim">)</span></p></dl></div>
<div class="section" id="GUID-89E67621-1F3E-4545-BE9A-CF886A9186E1"><h2 class="sectiontitle">Description</h2><p><span/>The <span class="option">p?lapiv</span><span>routine </span>applies either <var>P</var> (permutation matrix indicated by <var>ipiv</var>) or inv(<var>P</var>) to a general <var>m</var>-by-<var>n</var> distributed matrix sub<samp class="codeph">(<var>A</var>) = <var>A</var>(<var>ia</var>:<var>ia</var>+<var>m</var>-1</samp>, <samp class="codeph"><var>ja</var>:<var>ja</var>+<var>n</var>-1)</samp>, resulting in row or column pivoting. The pivot vector may be distributed across a process row or a column. The pivot vector should be aligned with the distributed matrix <var>A</var>. This <span>routine </span>will transpose the pivot vector, if necessary.</p>
<p>For example, if the row pivots should be applied to the columns of sub(<var>A</var>), pass <samp class="codeph"><var>rowcol</var>=<span class="keyword">'C'</span> and <samp class="codeph"><var>pivroc</var>=<span class="keyword">'C'</span></samp></samp>.</p>
</div>
<div class="section" id="GUID-A15DC469-C9CC-4F33-A01D-EBED21A04049"><h2 class="sectiontitle">Input Parameters</h2><dl id="GUID-8861AEBE-D835-40B1-85E2-EE19CD25258C"><dt class="dlterm"><span class="parmname">direc</span></dt>

<dd><p>(global) <span><span class="keyword">CHARACTER*1</span>.</span></p>
<p>Specifies in which order the permutation is applied:</p>
<p>= <span class="keyword">'F'</span> (Forward): Applies pivots forward from top of matrix.       Computes <samp class="codeph"><var>P</var>*sub(<var>A</var>)</samp>. </p>
<p>= <span class="keyword">'B'</span> (Backward): Applies pivots backward from bottom of matrix.         Computes <samp class="codeph">inv(<var>P</var>)*sub(<var>A</var>)</samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">rowcol</span></dt>

<dd><p>(global) <span><span class="keyword">CHARACTER*1</span>. </span></p>
<p>Specifies if the rows 
or columns are to be permuted:</p>
<p>= <span class="keyword">'R'</span>: Rows will be permuted, </p>
<p>= <span class="keyword">'C'</span>: Columns will be permuted.</p>
</dd>
<dt class="dlterm"><span class="parmname">pivroc</span></dt>

<dd><p>(global) <span><span class="keyword">CHARACTER*1</span>. </span></p>
<p>Specifies whether <var>ipiv</var> is distributed over a process row or column:</p>
<p>= <span class="keyword">'R'</span>: <span class="parmname">ipiv</span> is distributed over a process row, </p>
<p>= <span class="keyword">'C'</span>: <span class="parmname">ipiv</span> is distributed over a process column.</p>
</dd>
<dt class="dlterm"><span class="parmname">m</span></dt>

<dd><p>(global) <span><span class="keyword">INTEGER</span>. </span></p>
<p>The number of rows in the distributed matrix sub(<var>A</var>). When <samp class="codeph"><var>m</var> = 0</samp>, <span class="option">p?lapiv</span> is set to zero. <samp class="codeph"><var>m </var><span class="eqsymbol">≥</span> 0</samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">n</span></dt>

<dd><p>(global) <span><span class="keyword">INTEGER</span>. </span></p>
<p>The number of columns in the distributed matrix sub(<var>A</var>). When <samp class="codeph"><var>n</var> = 0</samp>, <span class="option">p?lapiv</span> is set to zero. <var>n </var><span class="eqsymbol">≥</span> 0.</p>
</dd>
<dt class="dlterm"><span class="parmname">a</span></dt>

<dd><p>(local). </p>
<p><span class="keyword">REAL</span> for <span class="option">pslapiv</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">pdlapiv</span></p>
<p><span class="keyword">COMPLEX</span> for <span class="option">pclapiv</span></p>
<p><span class="keyword">COMPLEX*16</span> for <span class="option">pzlapiv</span>. </p>
<p>Pointer into the local memory  to an array of size <samp class="codeph"><span>(<var>lld_a</var>, <var>LOCc</var>(<var>ja</var>+<var>n</var>-1))</span></samp> containing the local pieces of the distributed matrix sub(<var>A</var>).</p>
</dd>
<dt class="dlterm"><span class="parmname">ia</span>, <span class="parmname">ja</span></dt>

<dd><p>(global) <span><span class="keyword">INTEGER</span>. </span></p>
<p>The row and column indices in the global matrix <var>A</var> indicating the first row and the first column of the matrix sub(<var>A</var>), respectively.</p>
</dd>
<dt class="dlterm"><span class="parmname">desca</span></dt>

<dd><p>(global and local) <span><span class="keyword">INTEGER</span></span> array of size <var>dlen_</var>. The array descriptor for the distributed matrix A.</p>
</dd>
<dt class="dlterm"><span class="parmname">ipiv</span></dt>

<dd><p>(local) <span><span class="keyword">INTEGER</span>. </span></p>
<p>Array of size <var>lipiv</var> ;</p>
<p>  when <samp class="codeph"><var>rowcol</var>=<span class="keyword">'R'</span></samp> or <span class="keyword">'r'</span>:</p>
<p><samp class="codeph"><var>lipiv</var><span class="eqsymbol">≥</span><var>LOCr</var>(<var>ia</var>+<var>m</var>-1) + <var>mb_a</var></samp>        if <samp class="codeph"><var>pivroc</var>=<span class="keyword">'C'</span></samp> or <span class="keyword">'c'</span>,</p>
<p><samp class="codeph"><var>lipiv</var><span class="eqsymbol">≥</span><var>LOCc</var>(<var>m</var> + <var>mod</var>(<var>jp</var>-1, <var>nb_p</var>))</samp> if <samp class="codeph"><var>pivroc</var>=<span class="keyword">'R'</span></samp> or <span class="keyword">'r'</span>, and,</p>
<p>when <samp class="codeph"><var>rowcol</var>=<span class="keyword">'C'</span></samp> or <span class="keyword">'c'</span>:</p>
<p><samp class="codeph"><var>lipiv</var><span class="eqsymbol">≥</span><var>LOCr</var>(<var>n</var> + <span class="keyword">mod</span>(<var>ip</var>-1, <var>mb_p</var>))</samp> if <samp class="codeph"><var>pivroc</var>=<span class="keyword">'C'</span></samp> or <span class="keyword">'c'</span>,</p>
<p><samp class="codeph"><var>lipiv</var><span class="eqsymbol">≥</span><var>LOCc</var>(<var>ja</var>+<var>n</var>-1) + <var>nb_a</var></samp>         if <samp class="codeph"><var>pivroc</var>=<span class="keyword">'R'</span></samp> or <span class="keyword">'r'</span>.</p>
<p>This array contains the pivoting information. <samp class="codeph"><var>ipiv(i)</var></samp> is the global row (column), local row (column) <var>i</var> was swapped with. When <samp class="codeph"><var>rowcol</var>=<span class="keyword">'R'</span></samp> or <span class="keyword">'r'</span> and <samp class="codeph"><var>pivroc</var>=<span class="keyword">'C'</span></samp> or <span class="keyword">'c'</span>, or <samp class="codeph"><var>rowcol</var>=<span class="keyword">'C'</span></samp> or <span class="keyword">'c'</span> and <samp class="codeph"><var>pivroc</var>=<span class="keyword">'R'</span></samp> or <span class="keyword">'r'</span>, the last piece of this array of size <var>mb_a</var> (resp. <var>nb_a</var>) is used as workspace. In those cases, this array is tied to the distributed matrix <var>A</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">ip</span>, <span class="parmname">jp</span></dt>

<dd><p>(global) <span><span class="keyword">INTEGER</span>. </span>The row and column indices in the global matrix <var>P</var> indicating the first row and the first column of the matrix sub(<var>P</var>), respectively.</p>
</dd>
<dt class="dlterm"><span class="parmname">descip</span></dt>

<dd><p>(global and local) <span><span class="keyword">INTEGER</span></span> array of size <var>dlen_</var>.  The array descriptor for the distributed vector <var>ipiv</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">iwork</span></dt>

<dd><p>(local). <span><span class="keyword">INTEGER</span>.</span></p>
<p> Array of size <var>ldw</var>, where <var>ldw</var> is equal to the workspace necessary for transposition, and the storage of the transposed <var>ipiv</var>:</p>
<p>Let <var>lcm</var> be the least common multiple of <var>nprow</var> and <var>npcol</var>. </p>
<pre>if( <var>rowcol</var>.eq.'r' .and.  <var>pivroc</var>. eq.'r') then
      if( <var>nprow</var>.eq. <var>npcol</var>) then
<var>ldw</var> = LOCr( <var>n_p</var> + <span class="keyword">mod</span>(<var>jp</var>-1, <var>nb_p</var>) ) + <var>nb_p</var>
     else
<var>ldw</var> = LOCr( <var>n_p</var> + <span class="keyword">mod</span>(<var>jp</var>-1, <var>nb_p</var>) )+
<var>nb_p</var> * ceil( ceil(LOCc(<var>n_p</var>)/<var>nb_p)</var> / (<var>lcm/npcol</var>) )
   end if
 else if( <var>rowcol</var>.eq.'c' .and.  <var>pivroc</var>.eq.'c') then
       if( <var>nprow</var>.eq. <var>npcol</var> ) then
<var>ldw</var> = LOCc( <var>m_p</var> + mod(<var>ip</var>-1, <var>mb_p</var>) ) + <var>mb_p</var>
       else
<var>ldw</var> = LOCc( <var>m_p</var> + <span class="keyword">mod</span>(<var>ip</var>-1, <var>mb_p</var>) ) +
<var>mb_p</var> *ceil(ceil(LOCr(<var>m_p</var>)<var>/mb_p</var>) <var>/</var> (<var>lcm/nprow</var>) )
       end if
 else
<var>iwork</var> is not referenced.
 end if 
</pre></dd>
</dl>
</div>
<div class="section" id="GUID-2488AB80-4047-4574-87F5-4E27515BAD5E"><h2 class="sectiontitle">Output Parameters</h2><dl id="GUID-B548EC5F-7445-46BA-8726-3C73E86CA0BA"><dt class="dlterm"><span class="parmname">a</span></dt>

<dd><p>(local). </p>
<p>On exit, the local pieces of the permuted distributed submatrix.</p>
</dd>
</dl>
</div>
</div>

<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-BF7438B3-BB55-478A-88DB-33C01481F990.html">ScaLAPACK Auxiliary Routines</a></div>
</div>
<div class="See Also"><h2>See Also</h2>
<div class="linklist">
<div><a href="GUID-97273960-E4A4-4016-8667-BE6A36156792.html#GUID-97273960-E4A4-4016-8667-BE6A36156792">Overview</a> for details of ScaLAPACK  array descriptor structures and related notations.</div></div></div>
</body>
</html>
