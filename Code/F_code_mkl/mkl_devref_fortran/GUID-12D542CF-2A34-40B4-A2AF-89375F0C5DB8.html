<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0016)http://localhost -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="DC.Type" content="FunctionRef"/>
<meta name="DC.Title" content="?tgsen"/>
<meta name="abstract" content="Reorders the generalized Schur decomposition of a pair of matrices (A,B) so that a selected cluster of eigenvalues appears in the leading diagonal blocks of (A,B)."/>
<meta name="description" content="Reorders the generalized Schur decomposition of a pair of matrices (A,B) so that a selected cluster of eigenvalues appears in the leading diagonal blocks of (A,B)."/>
<meta name="DC.subject" content="?tgsen, Schur decomposition"/>
<meta name="keywords" content="?tgsen, Schur decomposition"/>
<meta name="DC.Relation" scheme="URI" content="GUID-7BD8C3BA-2122-4727-891E-B086CB265D38.html"/>
<meta name="DC.Relation" scheme="URI" content="http://www.intel.com/software/products/softwaredocs_feedback"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-12D542CF-2A34-40B4-A2AF-89375F0C5DB8"/>
<meta name="DC.Language" content="en-US"/>
<link rel="stylesheet" type="text/css" href="intel_css_styles.css"/>
<title>?tgsen</title>

</head>
<body id="GUID-12D542CF-2A34-40B4-A2AF-89375F0C5DB8">
 <!-- ==============(Start:NavScript)================= -->
 <script src="NavScript.js" language="JavaScript1.2" type="text/javascript"></script>
 <script language="JavaScript1.2" type="text/javascript">WriteNavLink(0);</script>
 <!-- ==============(End:NavScript)================= -->
<p id="header_text" style="margin-bottom : 20pt"><em>Intel&reg; oneAPI Math Kernel Library Developer Reference - Fortran</em></p>


<h1 class="topictitle1"><span class="option">?tgsen</span></h1>
<!--Reorders the generalized Schur decomposition of a pair of matrices (A,B) so that a selected cluster of eigenvalues appears in the leading diagonal blocks of (A,B).--><div><p class="shortdesc">Reorders the generalized Schur decomposition of a pair of matrices (A,B) so that a selected cluster of eigenvalues appears in the leading diagonal blocks of (A,B).</p>
<div class="section" id="GUID-A3C420C4-8578-4738-9823-5217BA448627"><h2 class="sectiontitle">Syntax</h2><dl class="dlsyntax"><p class="dlsyntaxpara"><span class="kwd">call stgsen</span><span class="delim">(</span><span class="var">ijob</span><span class="sep">, </span><span class="var">wantq</span><span class="sep">, </span><span class="var">wantz</span><span class="sep">, </span><span class="var">select</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">lda</span><span class="sep">, </span><span class="var">b</span><span class="sep">, </span><span class="var">ldb</span><span class="sep">, </span><span class="var">alphar</span><span class="sep">, </span><span class="var">alphai</span><span class="sep">, </span><span class="var">beta</span><span class="sep">, </span><span class="var">q</span><span class="sep">, </span><span class="var">ldq</span><span class="sep">, </span><span class="var">z</span><span class="sep">, </span><span class="var">ldz</span><span class="sep">, </span><span class="var">m</span><span class="sep">, </span><span class="var">pl</span><span class="sep">, </span><span class="var">pr</span><span class="sep">, </span><span class="var">dif</span><span class="sep">, </span><span class="var">work</span><span class="sep">, </span><span class="var">lwork</span><span class="sep">, </span><span class="var">iwork</span><span class="sep">, </span><span class="var">liwork</span><span class="sep">, </span><span class="var">info</span><span class="delim">)</span></p><p class="dlsyntaxpara"><span class="kwd">call dtgsen</span><span class="delim">(</span><span class="var">ijob</span><span class="sep">, </span><span class="var">wantq</span><span class="sep">, </span><span class="var">wantz</span><span class="sep">, </span><span class="var">select</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">lda</span><span class="sep">, </span><span class="var">b</span><span class="sep">, </span><span class="var">ldb</span><span class="sep">, </span><span class="var">alphar</span><span class="sep">, </span><span class="var">alphai</span><span class="sep">, </span><span class="var">beta</span><span class="sep">, </span><span class="var">q</span><span class="sep">, </span><span class="var">ldq</span><span class="sep">, </span><span class="var">z</span><span class="sep">, </span><span class="var">ldz</span><span class="sep">, </span><span class="var">m</span><span class="sep">, </span><span class="var">pl</span><span class="sep">, </span><span class="var">pr</span><span class="sep">, </span><span class="var">dif</span><span class="sep">, </span><span class="var">work</span><span class="sep">, </span><span class="var">lwork</span><span class="sep">, </span><span class="var">iwork</span><span class="sep">, </span><span class="var">liwork</span><span class="sep">, </span><span class="var">info</span><span class="delim">)</span></p><p class="dlsyntaxpara"><span class="kwd">call ctgsen</span><span class="delim">(</span><span class="var">ijob</span><span class="sep">, </span><span class="var">wantq</span><span class="sep">, </span><span class="var">wantz</span><span class="sep">, </span><span class="var">select</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">lda</span><span class="sep">, </span><span class="var">b</span><span class="sep">, </span><span class="var">ldb</span><span class="sep">, </span><span class="var">alpha</span><span class="sep">, </span><span class="var">beta</span><span class="sep">, </span><span class="var">q</span><span class="sep">, </span><span class="var">ldq</span><span class="sep">, </span><span class="var">z</span><span class="sep">, </span><span class="var">ldz</span><span class="sep">, </span><span class="var">m</span><span class="sep">, </span><span class="var">pl</span><span class="sep">, </span><span class="var">pr</span><span class="sep">, </span><span class="var">dif</span><span class="sep">, </span><span class="var">work</span><span class="sep">, </span><span class="var">lwork</span><span class="sep">, </span><span class="var">iwork</span><span class="sep">, </span><span class="var">liwork</span><span class="sep">, </span><span class="var">info</span><span class="delim">)</span></p><p class="dlsyntaxpara"><span class="kwd">call ztgsen</span><span class="delim">(</span><span class="var">ijob</span><span class="sep">, </span><span class="var">wantq</span><span class="sep">, </span><span class="var">wantz</span><span class="sep">, </span><span class="var">select</span><span class="sep">, </span><span class="var">n</span><span class="sep">, </span><span class="var">a</span><span class="sep">, </span><span class="var">lda</span><span class="sep">, </span><span class="var">b</span><span class="sep">, </span><span class="var">ldb</span><span class="sep">, </span><span class="var">alpha</span><span class="sep">, </span><span class="var">beta</span><span class="sep">, </span><span class="var">q</span><span class="sep">, </span><span class="var">ldq</span><span class="sep">, </span><span class="var">z</span><span class="sep">, </span><span class="var">ldz</span><span class="sep">, </span><span class="var">m</span><span class="sep">, </span><span class="var">pl</span><span class="sep">, </span><span class="var">pr</span><span class="sep">, </span><span class="var">dif</span><span class="sep">, </span><span class="var">work</span><span class="sep">, </span><span class="var">lwork</span><span class="sep">, </span><span class="var">iwork</span><span class="sep">, </span><span class="var">liwork</span><span class="sep">, </span><span class="var">info</span><span class="delim">)</span></p></dl><dl class="dlsyntax"><p class="dlsyntaxpara"><span class="kwd">call tgsen</span><span class="delim">(</span><span class="var">a</span><span class="sep">, </span><span class="var">b</span><span class="sep">, </span><span class="var">select</span><span class="delim"> [</span><span class="sep">,</span><span class="var">alphar</span><span class="delim">] </span><span class="delim">[</span><span class="sep">,</span><span class="var">alphai</span><span class="delim">] </span><span class="delim">[</span><span class="sep">,</span><span class="var">beta</span><span class="delim">] </span><span class="delim">[</span><span class="sep">,</span><span class="var">ijob</span><span class="delim">] </span><span class="delim">[</span><span class="sep">,</span><span class="var">q</span><span class="delim">] </span><span class="delim">[</span><span class="sep">,</span><span class="var">z</span><span class="delim">] </span><span class="delim">[</span><span class="sep">,</span><span class="var">pl</span><span class="delim">] </span><span class="delim">[</span><span class="sep">,</span><span class="var">pr</span><span class="delim">] </span><span class="delim">[</span><span class="sep">,</span><span class="var">dif</span><span class="delim">] </span><span class="delim">[</span><span class="sep">,</span><span class="var">m</span><span class="delim">] </span><span class="delim">[</span><span class="sep">,</span><span class="var">info</span><span class="delim">]</span><span class="delim">)</span></p><p class="dlsyntaxpara"><span class="kwd">call tgsen</span><span class="delim">(</span><span class="var">a</span><span class="sep">, </span><span class="var">b</span><span class="sep">, </span><span class="var">select</span><span class="delim"> [</span><span class="sep">,</span><span class="var">alpha</span><span class="delim">] </span><span class="delim">[</span><span class="sep">,</span><span class="var">beta</span><span class="delim">] </span><span class="delim">[</span><span class="sep">,</span><span class="var">ijob</span><span class="delim">] </span><span class="delim">[</span><span class="sep">,</span><span class="var">q</span><span class="delim">] </span><span class="delim">[</span><span class="sep">,</span><span class="var">z</span><span class="delim">] </span><span class="delim">[</span><span class="sep">,</span><span class="var">pl</span><span class="delim">] </span><span class="delim">[</span><span class="sep">,</span><span class="var">pr</span><span class="delim">] </span><span class="delim">[</span><span class="sep">, </span><span class="var">dif</span><span class="delim">] </span><span class="delim">[</span><span class="sep">,</span><span class="var">m</span><span class="delim">] </span><span class="delim">[</span><span class="sep">,</span><span class="var">info</span><span class="delim">]</span><span class="delim">)</span></p></dl></div>
<div class="section" id="GUID-935A3F5A-527C-45B5-BE33-3DBD3D151E3D"><h2 class="sectiontitle">Include Files</h2><ul id="d163e55"><li><span class="filepath">mkl.fi</span>, <span class="filepath">lapack.f90</span></li>
</ul>
</div>
<div class="section" id="GUID-026AF93E-1A7C-421E-A52E-7A9330A9CDF3"><h2 class="sectiontitle">Description</h2><p><span/></p>
<p>The routine reorders the generalized real-Schur/Schur decomposition of a real/complex matrix pair (<var>A</var>, <var>B</var>) (in terms of an orthogonal/unitary equivalence transformation <samp class="codeph"><var>Q</var><sup class="power"><var>T</var></sup>*(<var>A</var>,<var>B</var>)*<var>Z</var></samp> for real flavors or <samp class="codeph"><var>Q</var><sup class="power"><var>H</var></sup>*(<var>A</var>,<var>B</var>)*<var>Z</var></samp> for complex flavors), so that a selected cluster of eigenvalues appears in the leading diagonal blocks of the pair (<var>A</var>, <var>B</var>). The leading columns of <var>Q</var> and <var>Z</var> form orthonormal/unitary bases of the corresponding left and right eigenspaces (deflating subspaces). </p>
<p>(<var>A</var>, <var>B</var>) must be in generalized real-Schur/Schur canonical form (as returned by <a href="GUID-C1618975-73E0-494C-B45F-3338FA06CA22.html#GUID-C1618975-73E0-494C-B45F-3338FA06CA22">gges</a>), that is, <var>A</var> and <var>B</var> are both upper triangular.</p>
<p><span class="option">?tgsen</span> also computes the generalized eigenvalues </p>
<p><samp class="codeph"><span class="eqsymbol">ω</span><sub><var>j</var></sub> = (<var>alphar</var>(j) + <var>alphai</var>(j)*i)/<var>beta</var>(j)</samp> (for real flavors)</p>
<p><samp class="codeph"><span class="eqsymbol">ω</span><sub><var>j</var></sub> = <var>alpha</var>(j)/<var>beta</var>(j)</samp> (for complex flavors) </p>
<p>of the reordered matrix pair (<var>A</var>, <var>B</var>).</p>
<p>Optionally, the routine computes the estimates of reciprocal condition numbers for eigenvalues and eigenspaces. These are <samp class="codeph">Difu[(<var>A</var><sub class="subnb">11</sub>, <var>B</var><sub class="subnb">11</sub>), (<var>A</var><sub>22</sub>, <var>B</var><sub>22</sub>)]</samp> and <samp class="codeph">Difl[(<var>A</var><sub class="subnb">11</sub>, <var>B</var><sub class="subnb">11</sub>), (<var>A</var><sub>22</sub>, <var>B</var><sub>22</sub>)]</samp>, that is, the separation(s) between the matrix pairs (<var>A</var><sub class="subnb">11</sub>, <var>B</var><sub class="subnb">11</sub>) and (<var>A</var><sub>22</sub>, <var>B</var><sub>22</sub>) that correspond to the selected cluster and the eigenvalues outside the cluster, respectively, and norms of "projections" onto left and right eigenspaces with respect to the selected cluster in the (1,1)-block.</p>
</div>
<div class="section" id="GUID-46FFF29A-1971-4FB2-9A67-A161E555A08D"><h2 class="sectiontitle">Input Parameters</h2><dl id="GUID-8510C228-7F5B-489E-A415-F09E9FEEB685"><dt class="dlterm"><span class="parmname">ijob</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>Specifies whether condition numbers are required for the cluster of eigenvalues (<var>pl</var> and <var>pr</var>) or the deflating subspaces <samp class="codeph">Difu</samp> and <samp class="codeph">Difl</samp>.</p>
<p>If <samp class="codeph"><var>ijob</var> =0</samp>, only reorder with respect to <var>select</var>;</p>
<p>If <samp class="codeph"><var>ijob</var> =1</samp>, reciprocal of norms of "projections" onto left and right eigenspaces with respect to the selected cluster (<var>pl</var> and <var>pr</var>);</p>
<p>If <samp class="codeph"><var>ijob</var> =2</samp>, compute upper bounds on <samp class="codeph">Difu</samp> and <samp class="codeph">Difl</samp>, using F-norm-based estimate (<var>dif</var> (1:2));</p>
<p>If <samp class="codeph"><var>ijob</var> =3</samp>, compute estimate of <samp class="codeph">Difu</samp> and <samp class="codeph">Difl</samp>, using 1-norm-based estimate (<var>dif</var> (1:2)). This option is about 5 times as expensive as <samp class="codeph"><var>ijob</var> =2</samp>;</p>
<p>If <samp class="codeph"><var>ijob</var> =4</samp>,&gt;compute <var>pl</var>, <var>pr</var> and <var>dif</var> (i.e., options 0, 1 and 2 above). This is an economic version to get it all;</p>
<p>If <samp class="codeph"><var>ijob</var> =5</samp>, compute <var>pl</var>, <var>pr</var> and <var>dif</var> (i.e., options 0, 1 and 3 above).</p>
</dd>
<dt class="dlterm"><span class="parmname">wantq</span>, <span class="parmname">wantz</span></dt>

<dd><p><span><span class="keyword">LOGICAL</span>. </span></p>
<p>If <samp class="codeph"><var>wantq</var> = <span class="keyword">.TRUE.</span></samp>, update the left transformation matrix <var>Q</var>;</p>
<p>If <samp class="codeph"><var>wantq</var> = <span class="keyword">.FALSE.</span></samp>, do not update <var>Q</var>;</p>
<p>If <samp class="codeph"><var>wantz</var> = <span class="keyword">.TRUE.</span></samp>, update the right transformation matrix <var>Z</var>;</p>
<p>If <samp class="codeph"><var>wantz</var> = <span class="keyword">.FALSE.</span></samp>, do not update <var>Z</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">select</span></dt>

<dd><p><span><span class="keyword">LOGICAL</span>. </span></p>
<p>Array, size at least max (1, <var>n</var>). Specifies the eigenvalues in the selected cluster. </p>
<p>To select an eigenvalue <var class="varname">ω</var><sub><var>j</var></sub>, <var>select</var><span>(<var>j</var>)</span> must be <span class="keyword">.TRUE.</span><em>For real flavors</em>: to select a complex conjugate pair of eigenvalues <var class="varname">ω</var><sub><var>j</var></sub> and <var class="varname">ω</var><sub><var>j</var> + 1</sub> (corresponding 2 by 2 diagonal block), <var>select</var><span>(<var>j</var>)</span> and/or <var>select</var><span>(<var>j</var> + 1)</span> must be set to <span class="keyword">.TRUE.</span>; the complex conjugate <var class="varname">ω</var><sub><var>j</var></sub> and <var class="varname">ω</var><sub><var>j</var> + 1</sub> must be either both included in the cluster or both excluded.</p>
</dd>
<dt class="dlterm"><span class="parmname">n</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>The order of the matrices <var>A</var> and <var>B</var> (<var>n</var><span class="eqsymbol">≥</span> 0).</p>
</dd>
<dt class="dlterm"><span class="parmname">a</span>, <span class="parmname">b</span>, <span class="parmname">q</span>, <span class="parmname">z</span><span>, <span class="parmname">work</span></span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">stgsen</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dtgsen</span></p>
<p><span class="keyword">COMPLEX</span> for <span class="option">ctgsen</span></p>
<p><span class="keyword">DOUBLE COMPLEX</span> for <span class="option">ztgsen</span>. </p>
<p>Arrays: </p>
<p><var>a</var><span>(<var>lda</var>,*)</span>
 contains the matrix <var>A</var>.</p>
<p><em>For real flavors</em>: <var>A</var> is upper quasi-triangular, with (<var>A</var>, <var>B</var>) in generalized real Schur canonical form.</p>
<p><em>For complex flavors</em>: <var>A</var> is upper triangular, in generalized Schur canonical form. </p>
<p>The second dimension of <var>a</var> must be at least max(1, <var>n</var>).</p>
<p><var>b</var><span>(<var>ldb</var>,*)</span>
 contains the matrix <var>B</var>. </p>
<p><em>For real flavors</em>: <var>B</var> is upper triangular, with (<var>A</var>, <var>B</var>) in generalized real Schur canonical form.</p>
<p><em>For complex flavors</em>: <var>B</var> is upper triangular, in generalized Schur canonical form. <span>The second dimension of <var>b</var> must be at least max(1, <var>n</var>).</span></p>
<p><var>q</var><span>(<var>ldq</var>,*)</span></p>
<p>If <samp class="codeph"><var>wantq</var> = <span class="keyword">.TRUE.</span></samp>, then <var>q</var> is an <var>n</var>-by-<var>n</var> matrix;</p>
<p>If <samp class="codeph"><var>wantq</var> = <span class="keyword">.FALSE.</span></samp>, then <var>q</var> is not referenced. </p>
<p>The second dimension of <var>q</var> must be at least max(1, <var>n</var>).</p>
<p><var>z</var><span>(<var>ldz</var>,*)</span></p>
<p>If <samp class="codeph"><var>wantz</var> = <span class="keyword">.TRUE.</span></samp>, then <var>z</var> is an <var>n</var>-by-<var>n</var> matrix;</p>
<p>If <samp class="codeph"><var>wantz</var> = <span class="keyword">.FALSE.</span></samp>, then <var>z</var> is not referenced. </p>
<p>The second dimension of <var>z</var> must be at least max(1, <var>n</var>).</p>
<p><var>work</var> is a workspace array, its dimension <samp class="codeph">max(1, <span class="parmname">lwork</span>)</samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">lda</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>The leading dimension of <var>a</var>; at least max(1, <var>n</var>).</p>
</dd>
<dt class="dlterm"><span class="parmname">ldb</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>The leading dimension of <var>b</var>; at least max(1, <var>n</var>).</p>
</dd>
<dt class="dlterm"><span class="parmname">ldq</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>The leading dimension of <var>q</var>; <var>ldq</var><span class="eqsymbol">≥</span> 1. </p>
<p>If <samp class="codeph"><var>wantq</var> = <span class="keyword">.TRUE.</span></samp>, then <var>ldq</var><span class="eqsymbol">≥</span> max(1, <var>n</var>).</p>
</dd>
<dt class="dlterm"><span class="parmname">ldz</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>The leading dimension of <var>z</var>; <var>ldz</var><span class="eqsymbol">≥</span> 1. </p>
<p>If <samp class="codeph"><var>wantz</var> = <span class="keyword">.TRUE.</span></samp>, then <var>ldz</var><span class="eqsymbol">≥</span> max(1, <var>n</var>).</p>
</dd>
<dt class="dlterm"><span class="parmname">lwork</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>The dimension of the array <var>work</var>.</p>
<p><em>For real flavors</em>: </p>
<p>If <samp class="codeph"><var>ijob</var> = </samp>1, 2, or 4, <samp class="codeph"><var>lwork</var><span class="eqsymbol">≥</span> max(4<var>n</var>+16, 2<var>m</var>(<var>n</var>-<var>m</var>))</samp>. </p>
<p>If <samp class="codeph"><var>ijob</var> = </samp>3 or 5, <samp class="codeph"><var>lwork</var><span class="eqsymbol">≥</span> max(4<var>n</var>+16, 4<var>m</var>(<var>n</var>-<var>m</var>))</samp>.</p>
<p><em>For complex flavors</em>: </p>
<p>If <samp class="codeph"><var>ijob</var> = </samp>1, 2, or 4, <samp class="codeph"><var>lwork</var><span class="eqsymbol">≥</span> max(1, 2<var>m</var>(<var>n</var>-<var>m</var>))</samp>. </p>
<p>If <samp class="codeph"><var>ijob</var> = </samp>3 or 5, <samp class="codeph"><var>lwork</var><span class="eqsymbol">≥</span> max(1, 4<var>m</var>(<var>n</var>-<var>m</var>))</samp>.</p>
<p>If <samp class="codeph"><var>lwork</var> = -1</samp>, then a workspace query is assumed; the routine only calculates the optimal size of the <var>work</var> array, returns this value as the first entry of the <var>work</var> array, and no error message related to <var>lwork</var> is issued by <a class="allformats" href="GUID-F3536B0B-2FA0-40B4-AF9B-51A182827F73.html#GUID-F3536B0B-2FA0-40B4-AF9B-51A182827F73">xerbla</a>. <span>See <em>Application Notes</em> for details.</span></p>
</dd>
<dt class="dlterm"><span class="parmname">iwork</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>Workspace array, its dimension <samp class="codeph">max(1, <span class="parmname">liwork</span>)</samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">liwork</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span>The dimension of the array <var>iwork</var>.</p>
<p><em>For real flavors</em>: </p>
<p>If <samp class="codeph"><var>ijob</var> = </samp>1, 2, or 4, <samp class="codeph"><var>liwork</var><span class="eqsymbol">≥</span><var>n</var>+6</samp>. </p>
<p>If <samp class="codeph"><var>ijob</var> = </samp>3 or 5, <samp class="codeph"><var>liwork</var><span class="eqsymbol">≥</span> max(<var>n</var>+6, 2<var>m</var>(<var>n</var>-<var>m</var>))</samp>.</p>
<p><em>For complex flavors</em>: </p>
<p>If <samp class="codeph"><var>ijob</var> = </samp>1, 2, or 4, <samp class="codeph"><var>liwork</var><span class="eqsymbol">≥</span><var>n</var>+2</samp>. </p>
<p>If <samp class="codeph"><var>ijob</var> = </samp>3 or 5, <samp class="codeph"><var>liwork</var><span class="eqsymbol">≥</span> max(<var>n</var>+2, 2<var>m</var>(<var>n</var>-<var>m</var>))</samp>.</p>
<p>If <samp class="codeph"><var>liwork</var> = -1</samp>, then a workspace query is assumed; the routine only calculates the optimal size of the <var>i</var><var>work</var> array, returns this value as the first entry of the <var>i</var><var>work</var> array, and no error message related to <var>liwork</var> is issued by <a class="allformats" href="GUID-F3536B0B-2FA0-40B4-AF9B-51A182827F73.html#GUID-F3536B0B-2FA0-40B4-AF9B-51A182827F73">xerbla</a>. <span>See <em>Application Notes</em> for details.</span></p>
</dd>
</dl>
</div>
<div class="section" id="GUID-B8DDEAE3-AAF2-4D2F-AFCA-2CCAB715523F"><h2 class="sectiontitle">Output Parameters</h2><dl id="GUID-FC8FC81B-D181-4342-A50B-8A665BE55EA6"><dt class="dlterm"><span class="parmname">a</span>, <span class="parmname">b</span></dt>

<dd><p>Overwritten by the reordered matrices <var>A</var> and <var>B</var>, respectively.</p>
</dd>
<dt class="dlterm"><span class="parmname">alphar</span>, <span class="parmname">alphai</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">stgsen</span>;</p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dtgsen</span>. </p>
<p>Arrays, size at least max(1, <var>n</var>). Contain values that form generalized eigenvalues in real flavors. </p>
<p>See <var>beta</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">alpha</span></dt>

<dd><p><span class="keyword">COMPLEX</span> for <span class="option">ctgsen</span>;</p>
<p><span class="keyword">DOUBLE COMPLEX</span> for <span class="option">ztgsen</span>. </p>
<p>Array, size at least max(1, <var>n</var>). Contain values that form generalized eigenvalues in complex flavors. </p>
<p>See <var>beta</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">beta</span></dt>

<dd><p><span class="keyword">REAL</span> for <span class="option">stgsen</span></p>
<p><span class="keyword">DOUBLE PRECISION</span> for <span class="option">dtgsen</span></p>
<p><span class="keyword">COMPLEX</span> for <span class="option">ctgsen</span></p>
<p><span class="keyword">DOUBLE COMPLEX</span> for <span class="option">ztgsen</span>. </p>
<p>Array, size at least max(1, <var>n</var>).</p>
<p><em>For real flavors</em>:</p>
<p>On exit, <samp class="codeph">(<var>alphar</var><span>(<var>j</var>)</span> + <var>alphai</var><span>(<var>j</var>)</span>*i)/<var>beta</var><span>(<var>j</var>)</span></samp>, <span><var>j</var>=1,..., <var>n</var></span>, will be the generalized eigenvalues. </p>
<p><samp class="codeph"><var>alphar</var><span>(<var>j</var>)</span> + <var>alphai</var><span>(<var>j</var>)</span>*i </samp>and <samp class="codeph"><var>beta</var><span>(<var>j</var>)</span></samp>, <span><var>j</var>=1,..., <var>n</var></span> are the diagonals of the complex Schur form (<var>S</var>,<var>T</var>) that would result if the 2-by-2 diagonal blocks of the real generalized Schur form of (<var>A</var>,<var>B</var>) were further reduced to triangular form using complex unitary transformations. </p>
<p>If <samp class="codeph"><var>alphai</var><span>(<var>j</var>)</span></samp> is zero, then the <var>j</var>-th eigenvalue is real; if positive, then the <var>j</var>-th and (<var>j</var> + 1)-st eigenvalues are a complex conjugate pair, with <samp class="codeph"><var>alphai</var><span>(<var>j</var> + 1)</span></samp> negative.</p>
<p><em>For complex flavors:</em></p>
<p>The diagonal elements of <var>A</var> and <var>B</var>, respectively, when the pair (<var>A</var>,<var>B</var>) has been reduced to generalized Schur form. <samp class="codeph"><var>alpha</var><span>(<var>i</var>)</span>/<var>beta</var><span>(<var>i</var>)</span></samp>,<span><var>i</var>=1,..., <var>n</var></span> are the generalized eigenvalues. </p>
</dd>
<dt class="dlterm"><span class="parmname">q</span></dt>

<dd><p> If <var>wantq</var> = <span class="keyword">.TRUE.</span>, then, on exit, <var>Q</var> has been postmultiplied by the left orthogonal transformation matrix which reorder (<var>A</var>, <var>B</var>). The leading <var>m</var> columns of <var>Q</var> form orthonormal bases for the specified pair of left eigenspaces (deflating subspaces).</p>
</dd>
<dt class="dlterm"><span class="parmname">z</span></dt>

<dd><p> If <var>wantz</var> = <span class="keyword">.TRUE.</span>, then, on exit, <var>Z</var> has been postmultiplied by the left orthogonal transformation matrix which reorder (<var>A</var>, <var>B</var>). The leading <var>m</var> columns of <var>Z</var> form orthonormal bases for the specified pair of left eigenspaces (deflating subspaces).</p>
</dd>
<dt class="dlterm"><span class="parmname">m</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span></p>
<p>The dimension of the specified pair of left and right eigen-spaces (deflating subspaces); <samp class="codeph">0 <span class="eqsymbol">≤</span><var>m</var><span class="eqsymbol">≤</span><var>n</var></samp>.</p>
</dd>
<dt class="dlterm"><span class="parmname">pl</span>, <span class="parmname">pr</span></dt>

<dd><p><span class="keyword">REAL</span> for single precision 
flavors;</p>
<p><span class="keyword">DOUBLE PRECISION</span> for double precision flavors. </p>
<p>If <samp class="codeph"><var>ijob</var> = 1, 4</samp>, or <samp class="codeph">5</samp>, <var>pl</var> and <var>pr</var> are lower bounds on the reciprocal of the norm of "projections" onto left and right eigenspaces with respect to the selected cluster. </p>
<p><samp class="codeph">0 &lt; <var>pl</var></samp>, <samp class="codeph"><var>pr</var><span class="eqsymbol">≤</span> 1</samp>. If <samp class="codeph"><var>m</var> = 0</samp> or <samp class="codeph"><var>m</var> = <var>n</var></samp>, <samp class="codeph"><var>pl</var> = <samp class="codeph"><var>pr</var> = 1</samp></samp>. </p>
<p>If <samp class="codeph"><var>ijob</var> = 0</samp>, <samp class="codeph">2</samp> or <samp class="codeph">3</samp>, <var>pl</var> and <var>pr</var> are not referenced</p>
</dd>
<dt class="dlterm"><span class="parmname">dif</span></dt>

<dd><p><span class="keyword">REAL</span> for single precision flavors;<span class="keyword">DOUBLE PRECISION</span> for double precision flavors. </p>
<p>Array, size <var/>(2). </p>
<p>If <samp class="codeph"><var>ijob</var><span class="eqsymbol">≥</span> 2</samp>, <var>dif</var>(1:2) store the estimates of <samp class="codeph">Difu</samp> and <samp class="codeph">Difl</samp>. </p>
<p>If <samp class="codeph"><var>ijob</var> = 2</samp> or 4, <var>dif</var>(1:2) are F-norm-based upper bounds on <samp class="codeph">Difu</samp> and <samp class="codeph">Difl</samp>. </p>
<p>If <samp class="codeph"><var>ijob</var> = 3</samp> or 5, <var>dif</var>(1:2) are 1-norm-based estimates of <samp class="codeph">Difu</samp> and <samp class="codeph">Difl</samp>. </p>
<p>If <samp class="codeph"><var>m</var> = 0</samp> or <var>m</var> = <var>n</var>, <samp class="codeph"><var>dif</var>(1:2) = F-norm([<var>A</var>, <var>B</var>])</samp>. </p>
<p>If <samp class="codeph"><var>ijob</var> = 0</samp> or 1, <var>dif</var> is not referenced.</p>
</dd>
<dt class="dlterm"><span class="parmname">work</span><samp class="codeph">(1)</samp></dt>

<dd><p>If <var>ijob</var> is not 0 and <samp class="codeph"><var>info</var> = 0</samp>, on exit, <samp class="codeph"><var>work</var>(1)</samp> contains the minimum value of <var>lwork</var> required for optimum performance. Use this <var>lwork</var> for subsequent runs.</p>
</dd>
<dt class="dlterm"><span class="parmname">iwork</span><samp class="codeph">(1)</samp></dt>

<dd><p>If <var>ijob</var> is not 0 and <samp class="codeph"><var>info</var> = 0</samp>, on exit, <samp class="codeph"><var>iwork</var>(1)</samp> contains the minimum value of <var>liwork</var> required for optimum performance. Use this <var>liwork</var> for subsequent runs.</p>
</dd>
<dt class="dlterm"><span class="parmname">info</span></dt>

<dd><p><span><span class="keyword">INTEGER</span>. </span></p>
<p>If <samp class="codeph"><var>info</var> = 0</samp>, the execution is successful. </p>
<p>If <samp class="codeph"><var>info</var> = <var>-i</var></samp>, the <var>i</var>-th parameter had an illegal value. </p>
<p>If <samp class="codeph"><var>info</var> = 1</samp>, Reordering of (<var>A</var>, <var>B</var>) failed because the transformed matrix pair (<var>A</var>, <var>B</var>) would be too far from generalized Schur form; the problem is very ill-conditioned. (<var>A</var>, <var>B</var>) may have been partially reordered. </p>
<p>If <span class="parmname">ijob</span> &gt; 0,  0 is returned in <var>dif</var>, <var>pl</var> and <var>pr</var>.</p>
</dd>
</dl>
</div>
<div class="section" id="GUID-241214B0-A211-4853-B214-E29F18E707C4"><h2 class="sectiontitle">LAPACK 95 Interface Notes</h2><p>Routines in Fortran 95 interface have fewer arguments in the calling sequence than their FORTRAN 77 counterparts. For general conventions applied to skip redundant or restorable arguments, see <a class="allformats" href="GUID-01F81694-7662-44A2-AE4B-7629ECD5883F.html#GUID-01F81694-7662-44A2-AE4B-7629ECD5883F">LAPACK 95 Interface Conventions</a>.</p>
<p>Specific details for the routine <span class="option">tgsen</span> interface are the following:</p>
<dl id="GUID-0A03BBE1-1F19-43B8-82DD-A14E3CEABB1C"><dt class="dlterm"><span class="parmname">a</span></dt>

<dd><p>Holds the matrix <var>A</var> of size (<var>n,n</var>).</p>
</dd>
<dt class="dlterm"><span class="parmname">b</span></dt>

<dd><p>Holds the matrix <var>B</var> of size (<var>n,n</var>).</p>
</dd>
<dt class="dlterm"><span class="parmname">select</span></dt>

<dd><p>Holds the vector of length <var>n</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">alphar</span></dt>

<dd><p>Holds the vector of length <var>n</var>. Used in real flavors only.</p>
</dd>
<dt class="dlterm"><span class="parmname">alphai</span></dt>

<dd><p>Holds the vector of length <var>n</var>. Used in real flavors only.</p>
</dd>
<dt class="dlterm"><span class="parmname">alpha</span></dt>

<dd><p>Holds the vector of length <var>n</var>. Used in complex flavors only.</p>
</dd>
<dt class="dlterm"><span class="parmname">beta</span></dt>

<dd><p>Holds the vector of length <var>n</var>.</p>
</dd>
<dt class="dlterm"><span class="parmname">q</span></dt>

<dd><p>Holds the matrix <var>Q</var> of size (<var>n,n</var>).</p>
</dd>
<dt class="dlterm"><span class="parmname">z</span></dt>

<dd><p>Holds the matrix <var>Z</var> of size (<var>n,n</var>).</p>
</dd>
<dt class="dlterm"><span class="parmname">dif</span></dt>

<dd><p>Holds the vector of length (2).</p>
</dd>
<dt class="dlterm"><span class="parmname">ijob</span></dt>

<dd><p>Must be 0, 1, 2, 3, 4, or 5. The default value is 0.</p>
</dd>
<dt class="dlterm"><span class="parmname">wantq</span></dt>

<dd><p>Restored based on the presence of the argument <var>q</var> as follows: </p>
<p><var>wantq</var> = <span class="keyword">.TRUE</span>, if <var>q</var> is present, </p>
<p><var>wantq</var> = <span class="keyword">.FALSE</span>, if <var>q</var> is omitted.</p>
</dd>
<dt class="dlterm"><span class="parmname">wantz</span></dt>

<dd><p>Restored based on the presence of the argument <var>z</var> as follows: </p>
<p><var>wantz</var> = <span class="keyword">.TRUE</span>, if <var>z</var> is present, </p>
<p><var>wantz</var> = <span class="keyword">.FALSE</span>, if z is omitted.</p>
</dd>
</dl>
</div>
<div class="section" id="GUID-2AEDE104-ED30-4450-B7D1-B91E0A9ADA2B"><h2 class="sectiontitle">Application Notes</h2><p>If it is not clear how much workspace to supply, use a generous value of <var>lwork</var> (or <var>liwork</var>) for the first run or set  <samp class="codeph"><var>lwork</var> = -1</samp> (<samp class="codeph"><var>liwork</var> = -1</samp>). </p>
<p>If <var>lwork</var> (or <var>liwork</var>) has any of admissible sizes, which is no less than the minimal value described, the routine completes the task, though probably not so fast as with a recommended workspace, and provides the recommended workspace in the first element of the corresponding array (<var>work</var>, <var>iwork</var>) on exit. Use this value (<samp class="codeph"><var>work</var>(1)</samp>, <samp class="codeph"><var>iwork</var>(1)</samp>) for subsequent runs.</p>
<p>If <samp class="codeph"><var>lwork</var> = -1</samp> (<samp class="codeph"><var>liwork</var> = -1</samp>), the routine returns immediately and provides the recommended workspace in the first element of the corresponding array (<var>work</var>, <var>iwork</var>). This operation is called a workspace query.</p>
<p>Note that if <var>lwork</var> (<var>liwork</var>) is less than the minimal required value and is not equal to -1, the routine returns immediately with an error exit and does not provide any information on the recommended workspace.</p>
</div>
</div>

<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-7BD8C3BA-2122-4727-891E-B086CB265D38.html">Generalized Nonsymmetric Eigenvalue Problems: LAPACK Computational Routines</a></div>
</div>
<div/>
</body>
</html>
