<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0016)http://localhost -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="DC.Type" content="FunctionRef"/>
<meta name="DC.Title" content="vslSSEditMissingValues"/>
<meta name="abstract" content="Modifies pointers to arrays associated with the method of supporting missing values in a dataset."/>
<meta name="description" content="Modifies pointers to arrays associated with the method of supporting missing values in a dataset."/>
<meta name="DC.subject" content="summary statistics, vslssseditmissingvalues, vsldsseditmissingvalues, vslsSSEditMissingValues, vsldSSEditMissingValues, VS routines, EditMissingValues"/>
<meta name="keywords" content="summary statistics, vslssseditmissingvalues, vsldsseditmissingvalues, vslsSSEditMissingValues, vsldSSEditMissingValues, VS routines, EditMissingValues"/>
<meta name="DC.Relation" scheme="URI" content="GUID-9D27013C-5463-4596-BB93-7E9993ADE2D6.html"/>
<meta name="DC.Relation" scheme="URI" content="http://www.intel.com/software/products/softwaredocs_feedback"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-AD6B4B8F-FD29-4E48-9BD3-90F94CBE8CEE"/>
<meta name="DC.Language" content="en-US"/>
<link rel="stylesheet" type="text/css" href="intel_css_styles.css"/>
<title>vslSSEditMissingValues</title>

</head>
<body id="GUID-AD6B4B8F-FD29-4E48-9BD3-90F94CBE8CEE">
 <!-- ==============(Start:NavScript)================= -->
 <script src="NavScript.js" language="JavaScript1.2" type="text/javascript"></script>
 <script language="JavaScript1.2" type="text/javascript">WriteNavLink(0);</script>
 <!-- ==============(End:NavScript)================= -->
<p id="header_text" style="margin-bottom : 20pt"><em>Intel&reg; oneAPI Math Kernel Library Developer Reference - Fortran</em></p>


<h1 class="topictitle1"><span class="option">vslSSEditMissingValues</span></h1>
<!-- Modifies   pointers
to arrays associated with the method of supporting missing values in a dataset.--><div><p class="shortdesc"> Modifies   pointers
to arrays associated with the method of supporting missing values in a dataset.</p>
<div class="section" id="GUID-E0FED6DB-56B7-44FB-9E72-6AC6497B088D"><h2 class="sectiontitle">Syntax</h2><dl class="dlsyntax"><p class="dlsyntaxpara"><span class="var">status</span><span class="delim"> = </span><span class="kwd">vslssseditmissingvalues</span><span class="sep">(</span><span class="var">task</span><span class="sep">, </span><span class="var">nparams</span><span class="sep">, </span><span class="var">params</span><span class="sep">, </span><span class="var">init_estimates_n</span><span class="sep">, </span><span class="var">init_estimates</span><span class="sep">, </span><span class="var">prior_n</span><span class="sep">, </span><span class="var">prior</span><span class="sep">, </span><span class="var">simul_missing_vals_n</span><span class="sep">, </span><span class="var">simul_missing_vals</span><span class="sep">, </span><span class="var">estimates_n</span><span class="sep">, </span><span class="var">estimates</span><span class="sep">)</span></p><p class="dlsyntaxpara"><span class="var">status</span><span class="delim"> = </span><span class="kwd">vsldsseditmissingvalues</span><span class="sep">(</span><span class="var">task</span><span class="sep">, </span><span class="var">nparams</span><span class="sep">, </span><span class="var">params</span><span class="sep">, </span><span class="var">init_estimates_n</span><span class="sep">, </span><span class="var">init_estimates</span><span class="sep">, </span><span class="var">prior_n</span><span class="sep">, </span><span class="var">prior</span><span class="sep">, </span><span class="var">simul_missing_vals_n</span><span class="sep">, </span><span class="var">simul_missing_vals</span><span class="sep">, </span><span class="var">estimates_n</span><span class="sep">, </span><span class="var">estimates</span><span class="sep">)</span></p></dl></div>
<div class="section" id="GUID-18B54324-2A53-4BA5-B351-B45C31E09C32"><h2 class="sectiontitle">Include Files</h2><ul id="d163e203"><li><span class="filepath">mkl_vsl.f90</span></li>
</ul>
</div>
<div class="section" id="GUID-61FB7AE5-CA75-4C34-ADE8-023FFEB75B4F"><h2 class="sectiontitle">Input Parameters</h2><table cellpadding="4" cellspacing="0" summary="" border="0" class="ParamTbl"><tr><th valign="bottom" align="left" id="d1289784e182" width="25%"><p>Name</p>
</th>
<th valign="bottom" align="left" id="d1289784e185" width="40%"><p>Type</p>
</th>
<th valign="bottom" align="left" id="d1289784e188" width="35%"><p>Description</p>
</th>
</tr>
<tr><td valign="top" headers="d1289784e182"><p><span class="parmname">task</span></p>
</td>
<td valign="top" headers="d1289784e185"><p><b class="parmname" style="color:#0033ff">Fortran: </b><span class="keyword">TYPE(VSL_SS_TASK)</span></p>
</td>
<td valign="top" headers="d1289784e188"><p>  Descriptor of the task</p>
</td>
</tr>
<tr><td valign="top" headers="d1289784e182"><p><span class="parmname">nparams</span></p>
</td>
<td valign="top" headers="d1289784e185"><p><b class="parmname" style="color:#0033ff">Fortran: </b><span class="keyword">INTEGER</span></p>
</td>
<td valign="top" headers="d1289784e188"><p>Pointer to the number of method parameters</p>
</td>
</tr>
<tr><td valign="top" headers="d1289784e182"><p><span class="parmname">params</span></p>
</td>
<td valign="top" headers="d1289784e185"><p><b class="parmname" style="color:#0033ff">Fortran: </b><span class="keyword">REAL(KIND=4) DIMENSION(*)</span> for <span class="option">vslssseditmissingvalues</span></p>
<p><span class="keyword">REAL(KIND=8) DIMENSION(*)</span> for <span class="option">vsldsseditmissingvalues</span></p>
</td>
<td valign="top" headers="d1289784e188"><p>Pointer to the array of method parameters</p>
</td>
</tr>
<tr><td valign="top" headers="d1289784e182"><p><span class="parmname">init_estimates_n</span></p>
</td>
<td valign="top" headers="d1289784e185"><p><b class="parmname" style="color:#0033ff">Fortran: </b><span class="keyword">INTEGER</span></p>
</td>
<td valign="top" headers="d1289784e188"><p>Pointer to the number of  initial estimates for mean and a variance-covariance matrix</p>
</td>
</tr>
<tr/>
<tr><td valign="top" headers="d1289784e182"><p><span class="parmname">init_estimates</span></p>
</td>
<td valign="top" headers="d1289784e185"><p><b class="parmname" style="color:#0033ff">Fortran: </b><span class="keyword">REAL(KIND=4) DIMENSION(*)</span> for <span class="option">vslssseditmissingvalues</span></p>
<p><span class="keyword">REAL(KIND=8) DIMENSION(*)</span> for <span class="option">vsldsseditmissingvalues</span></p>
</td>
<td valign="top" headers="d1289784e188"><p>Pointer to the array  that holds initial estimates for mean and a variance-covariance matrix</p>
</td>
</tr>
<tr><td valign="top" headers="d1289784e182"><p><span class="parmname">prior_n</span></p>
</td>
<td valign="top" headers="d1289784e185"><p><b class="parmname" style="color:#0033ff">Fortran: </b><span class="keyword">INTEGER</span></p>
</td>
<td valign="top" headers="d1289784e188"><p>Pointer to the number of prior parameters</p>
</td>
</tr>
<tr><td valign="top" headers="d1289784e182"><p><span class="parmname">prior</span></p>
</td>
<td valign="top" headers="d1289784e185"><p><b class="parmname" style="color:#0033ff">Fortran: </b><span class="keyword">REAL(KIND=4) DIMENSION(*)</span> for <span class="option">vslssseditmissingvalues</span></p>
<p><span class="keyword">REAL(KIND=8) DIMENSION(*)</span> for <span class="option">vsldsseditmissingvalues</span></p>
</td>
<td valign="top" headers="d1289784e188"><p>Pointer to the array of prior parameters</p>
</td>
</tr>
<tr><td valign="top" headers="d1289784e182"><p><span class="parmname">simul_missing_vals_n</span></p>
</td>
<td valign="top" headers="d1289784e185"><p><b class="parmname" style="color:#0033ff">Fortran: </b><span class="keyword">INTEGER</span></p>
</td>
<td valign="top" headers="d1289784e188"><p>Pointer to the  size of the array that holds output of the Multiple Imputation method</p>
</td>
</tr>
<tr><td valign="top" headers="d1289784e182"><p><span class="parmname">simul_missing_vals</span></p>
</td>
<td valign="top" headers="d1289784e185"><p><b class="parmname" style="color:#0033ff">Fortran: </b><span class="keyword">REAL(KIND=4) DIMENSION(*)</span> for <span class="option">vslssseditmissingvalues</span></p>
<p><span class="keyword">REAL(KIND=8) DIMENSION(*)</span> for <span class="option">vsldsseditmissingvalues</span></p>
</td>
<td valign="top" headers="d1289784e188"><p>Pointer to the array of size <samp class="codeph"><var>k</var>*<var>m</var></samp>, where <var>k</var>  is the total number of missing values, and <var>m</var>  is number of copies of missing values. The array holds <var>m</var>  sets of simulated missing values for the matrix of observations.</p>
</td>
</tr>
<tr><td valign="top" headers="d1289784e182"><p><span class="parmname">estimates_n</span></p>
</td>
<td valign="top" headers="d1289784e185"><p><b class="parmname" style="color:#0033ff">Fortran: </b><span class="keyword">INTEGER</span></p>
</td>
<td valign="top" headers="d1289784e188"><p>Pointer to the   number of estimates to be returned by the routine</p>
</td>
</tr>
<tr><td valign="top" headers="d1289784e182"><p><span class="parmname">estimates</span></p>
</td>
<td valign="top" headers="d1289784e185"><p><b class="parmname" style="color:#0033ff">Fortran: </b><span class="keyword">REAL(KIND=4) DIMENSION(*)</span> for <span class="option">vslssseditmissingvalues</span></p>
<p><span class="keyword">REAL(KIND=8) DIMENSION(*)</span> for <span class="option">vsldsseditmissingvalues</span></p>
</td>
<td valign="top" headers="d1289784e188"><p>Pointer to the array  that holds estimates of the mean and a variance-covariance matrix.</p>
</td>
</tr>
</table>
</div>
<div class="section" id="GUID-10F1ECF3-10CA-4E85-8CC8-C05D9E5F7197"><h2 class="sectiontitle">Output Parameters</h2><table cellpadding="4" cellspacing="0" summary="" border="0" class="ParamTbl"><tr><th valign="bottom" align="left" id="d1289784e389" width="20%"><p>Name</p>
</th>
<th valign="bottom" align="left" id="d1289784e392" width="40%"><p>Type</p>
</th>
<th valign="bottom" align="left" id="d1289784e395" width="40%"><p>Description</p>
</th>
</tr>
<tr><td valign="top" headers="d1289784e389"><p><span class="parmname">status</span></p>
</td>
<td valign="top" headers="d1289784e392"><p><b class="parmname" style="color:#0033ff">Fortran: </b><span class="keyword">INTEGER</span></p>
</td>
<td valign="top" headers="d1289784e395"><p>Current status of the task</p>
</td>
</tr>
</table>
</div>
<div class="section" id="GUID-B3345FBF-5D7D-4B83-BF09-ACD65D957E2E"><h2 class="sectiontitle">Description</h2><p><span/>The <span class="option">vslSSEditMissingValues</span> routine  uses values passed as parameters of the routine to replace pointers to the number  and the array of the method parameters, pointers to the number and the array of  initial mean/variance-covariance estimates, the pointer to the number and the array of prior parameters, pointers to the number and the array of simulated missing values, and pointers to the number and the array of the intermediate mean/covariance estimates. If you pass a value of <span class="keyword">NULL</span> for a specific input parameter, the value of that parameter in the task descriptor is unchanged.</p>
<p>Before you call the Summary Statistics routines to process missing values, preprocess the dataset and denote missing observations with one of the following predefined constants:</p>
<ul id="GUID-8DE89589-84D1-400B-A2B4-47ECCEB71AE1"><li><p><span class="keyword">VSL_SS_SNAN</span>,  if the dataset is stored in single precision floating-point arithmetic</p>
</li>
<li><p><span class="keyword">VSL_SS_DNAN</span>,  if the dataset is stored in double precision floating-point arithmetic</p>
</li>
</ul>
<p>Intel&reg; oneAPI Math Kernel Library provides the<span class="keyword">VSL_SS_METHOD_MI</span>  method to support missing values in the dataset based on the Multiple Imputation (MI) approach described in [<a href="GUID-732F9EE1-BCEC-4D9B-9B93-AF5499B21140.html#SCHAFER97">Schafer97</a>]. The following components support Multiple Imputation:<ul id="GUID-43962DEA-FE84-4B64-9733-8B449C869A4A"><li><p> Expectation Maximization (EM) algorithm to compute the start point for the Data Augmentation (DA) procedure</p>
</li>
<li><p>DA function</p>
</li>
</ul>
</p>
<div class="Note"><h3 class="NoteTipHead">Note</h3> <p> The DA component of the MI procedure is simulation-based and uses the <span class="keyword">VSL_BRNG_MCG59</span>  basic random number generator with predefined <var>seed</var> = 2<sup class="power">50</sup>  and the Gaussian distribution generator (<span class="keyword">ICDF</span>method) available in Intel&reg; oneAPI Math Kernel Library [<a href="GUID-63196F25-5013-4038-8BCD-2613C4EF3DE4.html#GUID-63196F25-5013-4038-8BCD-2613C4EF3DE4"><span class="option">Gaussian</span></a>].</p>
</div>
<p>Pack the parameters of the MI algorithm into the <span class="parmname">params</span> array. <a href="#TBL10-28">Table <span>"Structure of the Array of MI Parameters"</span></a> describes the <span class="parmname">params</span> structure.</p>

<div class="tablenoborder"><table cellpadding="4" summary="" id="TBL10-28" class="AllLineLong" frame="hsides" border="1" rules="all"><caption><span class="tablecap">
Structure of the Array of MI Parameters

</span></caption><thead align="left"><tr><th class="cellrowborder" valign="top" width="20%" id="d1289784e507"><p>Array Position</p>
</th>
<th class="cellrowborder" valign="top" width="30%" id="d1289784e510"><p>Algorithm Parameter</p>
</th>
<th class="row-nocellborder" valign="top" width="50%" id="d1289784e513"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="20%" headers="d1289784e507 "><p><span class="keyword">0</span></p>
</td>
<td class="cellrowborder" valign="top" width="30%" headers="d1289784e510 "><p><span class="keyword">em_iter_num</span></p>
</td>
<td class="row-nocellborder" valign="top" width="50%" headers="d1289784e513 "><p>   Maximal number of iterations for the EM algorithm. By default, this value is 50.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20%" headers="d1289784e507 "><p><span class="keyword">1</span></p>
</td>
<td class="cellrowborder" valign="top" width="30%" headers="d1289784e510 "><p><span class="keyword">da_iter_num</span></p>
</td>
<td class="row-nocellborder" valign="top" width="50%" headers="d1289784e513 "><p>  Maximal number of iterations for the DA algorithm. By default, this value is 30.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20%" headers="d1289784e507 "><p><span class="keyword">2</span></p>
</td>
<td class="cellrowborder" valign="top" width="30%" headers="d1289784e510 "><p><span class="eqsymbol">ε</span></p>
</td>
<td class="row-nocellborder" valign="top" width="50%" headers="d1289784e513 "><p>   Stopping criterion for the EM algorithm. The algorithm terminates  if the maximal module of the element-wise difference between the previous and current parameter values is less than <span class="eqsymbol">ε</span>. By default, this  value is 0.001.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20%" headers="d1289784e507 "><p><span class="keyword">3</span></p>
</td>
<td class="cellrowborder" valign="top" width="30%" headers="d1289784e510 "><p><span class="keyword">m</span></p>
</td>
<td class="row-nocellborder" valign="top" width="50%" headers="d1289784e513 "><p> Number of sets to impute</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20%" headers="d1289784e507 "><p><span class="keyword">4</span></p>
</td>
<td class="cellrowborder" valign="top" width="30%" headers="d1289784e510 "><p><span class="keyword">missing_vals_num</span></p>
</td>
<td class="row-nocellborder" valign="top" width="50%" headers="d1289784e513 "><p>  Total number of missing values in the datasets</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>You can also pass initial estimates into the EM algorithm by packing both the vector of means and the variance-covariance matrix as a one-dimensional array  <span class="parmname">init_estimates</span>. The size of the array should be at least <var>p</var> + <var>p</var>(<var>p</var> + 1)/2. For <var>i</var>=0, .., <var>p</var>-1, the <span class="parmname">init_estimates</span>[<var>i</var>] array contains the initial estimate of means.
 The remaining positions of the array are occupied by the upper triangular part of the variance-covariance matrix.</p>
<p>If you provide no initial estimates for the EM algorithm, the editor uses the default values, that is,  the vector of zero means and the unitary matrix as a variance-covariance matrix. You can also pass <span class="parmname">prior</span> parameters for <span class="eqsymbol">μ</span> and <span class="eqsymbol">Σ</span> into the library: <span class="eqsymbol">μ</span><sub>0</sub>, <span class="eqsymbol">τ</span>, <var>m</var>, and  <span class="eqsymbol">Λ</span><sup class="power">-1</sup>. Pack these parameters as a one-dimensional array <span class="parmname">prior</span> with a size of at least</p>
<p>(<var>p</var><sup class="power">2</sup> + 3<var>p</var> + 4)/2.</p>
<p> The storage format is as follows:</p>
<ul id="GUID-AFAC9562-55EF-4921-AA4D-0569CC032D29"><li><p><samp class="codeph"><span class="parmname">prior</span>[0], ..., <span class="parmname">prior</span>[<var>p</var>-1]</samp> contain the elements of the vector <span class="eqsymbol">μ</span><sub>0</sub>.</p>
</li>
<li><p><span class="parmname">prior</span>[<var>p</var>] contains the parameter <span class="eqsymbol">τ</span>.</p>
</li>
<li><p><samp class="codeph"><span class="parmname">prior</span>[<var>p</var>+1]</samp>
contains the parameter <var>m</var>.</p>
</li>
<li><p> The remaining positions are occupied by the upper-triangular part of the inverted matrix <span class="eqsymbol">Λ</span><sup class="power">-1</sup>.</p>
</li>
</ul>
<p>If you provide no <span class="parmname">prior</span> parameters, the editor uses their default values:</p>
<ul id="GUID-44979F15-6872-4C2F-A2F9-C345F131A095"><li><p> The array of <var>p</var> zeros is used as <span class="eqsymbol">μ</span><sub>0</sub>.</p>
</li>
<li><p><span class="eqsymbol">τ</span> is set to 0.</p>
</li>
<li><p><var>m</var> is set to <var>p</var>.</p>
</li>
<li><p>The zero matrix is used as an initial approximate of <span class="eqsymbol">Λ</span><sup class="power">-1</sup>.</p>
</li>
</ul>
<p>The <span class="option">EditMissingValues</span>
editor  returns <var>m</var> sets of imputed values and/or a sequence of parameter estimates drawn during the DA procedure.</p>
<p>The editor returns the imputed values as the <span class="parmname">simul_missing_vals</span>  array. The size of the array  should be sufficient to hold <var>m</var> sets each of the <span class="keyword">missing_vals_num</span> size, that is, at least  <samp class="codeph"><var>m</var>*<span class="keyword">missing_vals_num</span></samp>
 in total. The editor packs the imputed values one by one in the order of their appearance in the matrix of observations.</p>
<p>For example, consider a task of dimension 4. The total number of observations <var>n</var> is 10. The second observation vector misses variables 1 and 2, and the seventh observation vector lacks variable 1. The number of sets to impute is <var>m</var>=2. Then, <span class="parmname">simul_missing_vals</span><span class="keyword">[0]</span> and <span class="parmname">simul_missing_vals</span><span class="keyword">[1]</span> contains the first and the second points for the second observation vector, and <span class="parmname">simul_missing_vals</span><span class="keyword">[2]</span> holds the first point for the seventh observation. Positions 3, 4, and 5 are formed similarly.</p>
<p> To estimate convergence of the DA algorithm and choose a proper value of the number of DA iterations, request the sequence of parameter estimates that are produced during the DA procedure. The editor returns the sequence of parameters as a single array. The size of the array is</p>
<p><samp class="codeph"><var>m</var>*<span class="keyword">da_iter_num</span>*(<var>p</var>+(<var>p</var><sup class="power">2</sup>+<var>p</var>)/2)</samp></p>
<p>where</p>
<ul id="GUID-52CA6F46-92DF-48CD-AF19-DF705218CD5E"><li><p><var>m</var>  is the number of sets of values to
impute.</p>
</li>
<li><p><span class="keyword">da_iter_num</span>  is the number of DA iterations.</p>
</li>
<li><p>The value <samp class="codeph"><var>p</var>+(<var>p</var><sup class="power">2</sup>+<var>p</var>)/2</samp> 
 determines the size of the memory to hold one set of the parameter estimates.</p>
</li>
</ul>
<p>In each set of the parameters, the vector of means
occupies the first <var>p</var>  positions and the remaining <samp class="codeph">(<var>p</var><sup class="power">2</sup>+<var>p</var>)/2</samp>
positions are intended for  the upper triangular part of the variance-covariance matrix.</p>
<p> Upon successful generation of <var>m</var> sets of imputed values, you can place them in cells of the data matrix with missing values and use the Summary Statistics routines to analyze and get estimates for each of the <var>m</var> complete datasets.</p>
<div class="Note"><h3 class="NoteTipHead">Note</h3> <p>Intel&reg; oneAPI Math Kernel Library implementation of the MI algorithm rewrites cells of the dataset that contain the<span class="keyword">VSL_SS_SNAN/VSL_SS_DNAN</span>
values. If you want to use the Summary Statistics routines to process the data with missing values again, mask the positions of the empty cells.</p>
</div>
<p>See additional details of the algorithm usage model in the <em>Intel&reg; oneAPI Math Kernel Library Summary Statistics Application Notes</em> document [<a href="GUID-732F9EE1-BCEC-4D9B-9B93-AF5499B21140.html#SSLNOTES">SS Notes</a>].</p>
</div>
</div>

<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-9D27013C-5463-4596-BB93-7E9993ADE2D6.html">Summary Statistics Task Editors</a></div>
</div>
<div/>
</body>
</html>
